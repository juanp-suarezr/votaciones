import{x as B,r as f,T as D,q as j,w as S,c as u,o as n,b as a,u as s,Z as I,d as g,e as t,j as c,B as R,n as $,p as _,t as w,f as q,v as O,l as P,F}from"./app-CWshEMed.js";import{_ as T}from"./AuthenticatedLayout-B6GcFljm.js";import{_ as i}from"./InputError-HdUYTtvz.js";import{_ as d}from"./InputLabel-DEb5fLuS.js";import{_ as z}from"./PrimaryButton-CpH9pmug.js";import{_ as h}from"./TextInput-CMW3M2rS.js";import{_ as M}from"./SecondaryButton-BYLoF4Ch.js";import{s as G}from"./index-CddXaXkZ.js";import{_ as H}from"./SecondaryLink-B5KTCfC1.js";import{s as Z}from"./index-vUnmG6vv.js";import{s as J}from"./index-mJy1uLb5.js";import{s as K}from"./index-ECTClkTG.js";import{r as Q}from"./PhotoIcon-BXmbyTR4.js";import"./SecondaryButtonReturn-BnGKXSjC.js";import"./XCircleIcon-KhsxJ6Pw.js";import"./index-D4KDXSUf.js";import"./index-CmkRRXvX.js";import"./index-RlB7PF73.js";import"./index-B1jBGcD8.js";import"./index-HhE-rjip.js";import"./index-GgHwf150.js";import"./index-BbFU78Lh.js";const W={class:"flex flex-col bg-white border shadow-sm rounded-xl w-full"},X={class:"bg-gray-100 border-b rounded-t-xl py-3 px-4 md:py-4 md:px-5 grid grid-cols-2 gap-4"},Y={class:"text-right"},ee={class:"p-4 md:p-5"},oe={class:"mb-2"},te={class:"mb-2"},se={class:"col-span-2 mb-2"},ae={key:0},le={class:"col-span-2 flex md:grid grid-cols-2 flex-wrap gap-4"},re={class:"w-auto"},ie={class:"w-auto"},ne={class:"card flex inline-flex justify-content-center border border-gray-400 rounded-md shadow-md py-1 px-2 mt-2 !text-gray-500"},de={class:"w-auto mt-4"},ue={key:0,class:"card flex justify-content-center"},me={key:1,class:"text-xs text-gray-600"},ce=["href"],pe={class:"w-auto"},fe={class:"w-full h-full mt-2"},ge={class:"flex flex-wrap items-center w-auto gap-4"},ve={key:0,class:"px-2 py-4 w-full border border-gray-400 rounded-md shadow-md mt-4"},be={class:"mt-4"},ye={class:"mb-2"},xe={class:"col-span-2"},_e={class:"border-2 border-gray-300 rounded-md p-2"},we={class:"flex justify-center"},he=["src","alt"],Ve={key:0,class:"flex justify-center mt-2"},ke={class:"mt-4 flex flex-col items-end"},Ze={__name:"Add",props:{roles:{type:Object,default:()=>({})},tipos:{type:Object,default:()=>({})},eventos:{type:Object,default:()=>({})},parametros:{type:Array,default:()=>[]},subtipos:{type:Array,default:()=>[]}},setup(v){const V=B("$swal"),m=f(null),x=v;console.log(x);const e=D({detalle:"",descripcion:"",numero_tarjeton:"",tipo:"Proyecto",eventos:[],subtipo:0,estado:1,imagen:""});f([]);const b=f(null),p=f(!1),y=f(!1),A=[{url:route("proyectos.index"),text:"Listado de proyectos"},{url:"",text:"Nuevo proyecto"}],N=()=>{var r;return e.subtipo==0?"por default":typeof e.subtipo=="object"?e.subtipo.detalle:(r=x.subtipos.find(o=>o.id===parseInt(e.subtipo)))==null?void 0:r.detalle},U=j(()=>b.value?x.subtipos.filter(r=>r.codParametro===b.value):[]);S(p,r=>{r||(e.subtipo=0)});const k=j(()=>{const o=e.descripcion.trim().length;return o>=500?y.value=!0:y.value=!1,o});S(k,()=>{e.descripcion=e.descripcion.trim()});const C=r=>{if(e.imagen=r,console.log(e.imagen),!e.imagen)return;const o=new FileReader;o.onload=()=>{m.value=o.result},o.readAsDataURL(e.imagen)},E=()=>{e.imagen=null,m.value=null},L=()=>{console.log(e),e.subtipo=e.subtipo.id,e.post(route("proyectos.store"),{onSuccess:function(){V({title:"Registro Guardado",text:"El proyecto se ha almacenado exitosamente",icon:"success",didClose:()=>{e.reset(),m.value=null,window.location.href=route("proyectos.index")}})},onError:function(r){console.log(r),V({title:"Error",text:"Ha ocurrido un error al intentar guardar el proyecto",icon:"error"})}})};return(r,o)=>(n(),u(F,null,[a(s(I),{title:"Agregar proyecto"}),a(T,{breadCrumbLinks:A},{header:g(()=>o[9]||(o[9]=[c(" Nuevo proyecto ")])),default:g(()=>[t("div",W,[t("div",X,[o[11]||(o[11]=t("h3",{class:"mt-1 text-gray-500"},"Nuevo proyecto",-1)),t("div",Y,[a(H,{href:r.route("proyectos.index")},{default:g(()=>o[10]||(o[10]=[c(" Regresar ")])),_:1},8,["href"])])]),t("div",ee,[t("form",{onSubmit:R(L,["prevent"]),class:"grid sm:grid-cols-2 gap-4"},[t("div",oe,[a(d,{for:"nombre",value:"Nombre del proyecto"}),a(h,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:s(e).detalle,"onUpdate:modelValue":o[0]||(o[0]=l=>s(e).detalle=l),required:"",autofocus:"",autocomplete:"nombre"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(e).errors.detalle},null,8,["message"])]),t("div",te,[a(d,{for:"numero_tarjeton",value:"Numero tarjeton"}),a(h,{id:"numero_tarjeton",type:"number",class:"mt-1 block w-full",modelValue:s(e).numero_tarjeton,"onUpdate:modelValue":o[1]||(o[1]=l=>s(e).numero_tarjeton=l),autocomplete:"numero_tarjeton"},null,8,["modelValue"]),a(i,{class:"mt-2",message:s(e).errors.numero_tarjeton},null,8,["message"])]),t("div",se,[o[12]||(o[12]=t("p",{class:"text-gray-600 text-sm"}," Información adicional sobre el evento (max 500 caracteres) ",-1)),a(s(K),{modelValue:s(e).descripcion,"onUpdate:modelValue":o[2]||(o[2]=l=>s(e).descripcion=l),variant:"filled",autoResize:"",rows:"5",class:"mt-1 block w-full",required:"",autocomplete:"descripcion"},null,8,["modelValue"]),t("p",{class:$(["text-gray-500 text-sm mt-2",{"text-red-500":y.value}])},[c(w(k.value)+" caracteres ",1),y.value?(n(),u("span",ae,"Limite de caracteres superado")):_("",!0)],2),a(i,{class:"mt-2",message:s(e).errors.descripcion},null,8,["message"])]),t("div",le,[t("div",re,[t("div",ie,[a(d,{for:"tipos",value:"Tipos de usuarios"}),t("div",ne,w(s(e).tipo),1),a(i,{class:"mt-2",message:s(e).errors.tipos},null,8,["message"])]),t("div",de,[a(d,{for:"evento",value:"Asignar evento"}),v.eventos.length?(n(),u("div",ue,[a(s(G),{id:"eventos",modelValue:s(e).eventos,"onUpdate:modelValue":o[3]||(o[3]=l=>s(e).eventos=l),display:"chip",options:v.eventos,"option-label":"nombre","option-value":"id",placeholder:"Seleccione los eventos",maxSelectedLabels:6,class:"w-full md:w-20rem"},null,8,["modelValue","options"])])):(n(),u("p",me,[o[13]||(o[13]=c(" No hay eventos registrados, registrar uno nuevo ")),t("a",{href:r.route("eventos.create")},"Aquí",8,ce)])),a(i,{class:"mt-2",message:s(e).errors.eventos},null,8,["message"])])]),t("div",pe,[t("div",fe,[t("div",ge,[a(d,{for:"tipo_user",value:"Subtipos - "+N()},null,8,["value"]),a(M,{onClick:o[4]||(o[4]=l=>p.value=!p.value),class:"items-center"},{default:g(()=>[c(w(p.value?"Cancelar":"Agregar subtipo"),1)]),_:1})]),p.value?(n(),u("div",ve,[t("div",null,[a(d,{for:"parametro",value:"Parámetro"}),a(s(Z),{id:"parametro",modelValue:b.value,"onUpdate:modelValue":o[5]||(o[5]=l=>b.value=l),options:v.parametros,"option-label":"detalle","option-value":"cod",placeholder:"Seleccione un parámetro",class:"w-full"},null,8,["modelValue","options"]),a(i,{class:"mt-2",message:s(e).errors.parametro},null,8,["message"])]),t("div",be,[a(d,{for:"parametroDetalle",value:"Subtipo"}),a(s(J),{id:"parametroDetalle",modelValue:s(e).subtipo,"onUpdate:modelValue":o[6]||(o[6]=l=>s(e).subtipo=l),options:U.value,filter:"",optionLabel:"detalle",placeholder:"Seleccione un subtipo",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),a(i,{class:"mt-2",message:s(e).errors.subtipo},null,8,["message"])])])):_("",!0)])])]),t("div",ye,[a(d,{for:"estado",value:"Estado"}),q(t("select",{id:"estado","onUpdate:modelValue":o[7]||(o[7]=l=>s(e).estado=l),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-auto p-2. px-4"},o[14]||(o[14]=[t("option",{value:"1"},"Activo",-1),t("option",{value:"0"},"Bloqueado",-1)]),512),[[O,s(e).estado]]),a(i,{class:"mt-2",message:s(e).errors.estado},null,8,["message"])]),t("div",xe,[o[15]||(o[15]=t("p",{class:"text-gray-600 text-sm"}," Imagen de proyecto (resolución recomendada: 1080x1080px) ",-1)),t("div",_e,[a(h,{id:"imagen",type:"file",class:"mt-1 !border-0",accept:"image/*",onInput:o[8]||(o[8]=l=>C(l.target.files[0])),maxFileSize:2e6}),a(i,{class:"mt-2",message:s(e).errors.imagen},null,8,["message"]),t("div",we,[m.value?(n(),u("img",{key:0,src:m.value,alt:s(e).detalle,class:"w-2/6 h-auto"},null,8,he)):(n(),P(s(Q),{key:1,class:"w-1/6 text-gray-300"}))]),m.value?(n(),u("div",Ve,[t("button",{onClick:E,type:"button",class:"bg-red-500 text-white px-4 py-2 rounded"}," Eliminar Imagen ")])):_("",!0)])]),t("div",null,[t("div",ke,[a(z,{class:$({"opacity-25":s(e).processing}),disabled:s(e).processing},{default:g(()=>o[16]||(o[16]=[c(" Registrar proyecto ")])),_:1},8,["class","disabled"])])])],32)])])]),_:1})],64))}};export{Ze as default};
