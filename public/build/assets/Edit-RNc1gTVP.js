import{M as B,r as x,T as P,e as j,f as S,c as m,o as d,a,u as s,Z as q,w as v,b as t,d as c,p as O,n as $,m as w,t as _,h as R,v as z,j as F,F as M}from"./app-BAs6ko1Y.js";import{_ as T}from"./AuthenticatedLayout-vb930jOQ.js";import{_ as n}from"./InputError-Bntv-2Ck.js";import{_ as u}from"./InputLabel-irgemBy3.js";import{_ as Z}from"./PrimaryButton-9gKznJaL.js";import{_ as h}from"./TextInput-EsUTjm9m.js";import{_ as G}from"./SecondaryButton-C5AVfZku.js";import{s as H}from"./index-CmnVXgkS.js";import{s as J}from"./index-msb865gG.js";import{_ as K}from"./SecondaryLink-B7op6GF7.js";import{s as Q}from"./index-DYo90ULS.js";import{s as W}from"./index-CBh19lLb.js";import{r as X}from"./PhotoIcon-Ca1FNQud.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C-Pj7aeK.js";import"./index-nsn_fTpj.js";import"./index-Fz0y9rwo.js";import"./index-BzG2SpiB.js";import"./index-B9ovaRL6.js";import"./index-DDD0wu9M.js";import"./index-_ARLVJUh.js";const Y={class:"flex flex-col bg-white border shadow-sm rounded-xl w-full"},ee={class:"bg-gray-100 border-b rounded-t-xl py-3 px-4 md:py-4 md:px-5 grid grid-cols-2 gap-4"},oe={class:"text-right"},te={class:"p-4 md:p-5"},se={class:"mb-2"},ae={class:"mb-2"},re={class:"col-span-2 mb-2"},le={key:0},ie={class:"col-span-2 flex md:grid grid-cols-2 flex-wrap gap-4"},ne={class:"w-auto"},de={class:"w-auto"},ue={class:"card flex inline-flex justify-content-center border border-gray-400 rounded-md shadow-md py-1 px-2 mt-2 !text-gray-500"},me={class:"w-auto mt-4"},ce={key:0,class:"card flex justify-content-center"},pe={key:1,class:"text-xs text-gray-600"},fe=["href"],ge={class:"w-auto"},ve={class:"w-full h-full mt-2"},be={class:"flex flex-wrap items-center w-auto gap-4"},ye={key:0,class:"px-2 py-4 w-full border border-gray-400 rounded-md shadow-md mt-4"},xe={class:"mt-4"},_e={class:"mb-2"},we={class:"col-span-2"},he={class:"border-2 border-gray-300 rounded-md p-2"},Ve={class:"flex justify-center"},ke=["src","alt"],je={class:"mt-4"},Se={key:0,class:"flex justify-center mt-2"},$e={class:"mt-4 flex flex-col items-end"},Ke={__name:"Edit",props:{proyecto:{type:Object,default:()=>({})},tipos:{type:Object,default:()=>({})},eventos:{type:Object,default:()=>({})},parametros:{type:Array,default:()=>[]},subtipos:{type:Array,default:()=>[]}},setup(p){const V=B("$swal"),f=x(null),b=x(!1),r=p;console.log(r.proyecto);const E=r.proyecto.eventos!=="NA"?r.proyecto.eventos.split("|").map(l=>parseInt(l)):[],o=P({detalle:r.proyecto.detalle||"",descripcion:r.proyecto.descripcion||"",numero_tarjeton:r.proyecto.numero_tarjeton||"",tipo:r.proyecto.tipo||"",eventos:E||[],subtipo:r.proyecto.subtipo||"",tipo:r.proyecto.tipo,estado:r.proyecto.estado||"",imagen:r.proyecto.imagen}),y=x(null),g=x(!1),U=[{url:"/proyectos",text:"Listado de proyectos"},{url:"",text:"Editar proyecto"}],A=()=>{var l;return o.subtipo==0?"por default":typeof o.subtipo=="object"?o.subtipo.detalle:(l=r.subtipos.find(e=>e.id===parseInt(o.subtipo)))==null?void 0:l.detalle},I=j(()=>y.value?r.subtipos.filter(l=>l.codParametro===y.value):[]);S(g,l=>{l||(o.subtipo=0)});const k=j(()=>{const e=o.descripcion.trim().length;return e>=500?b.value=!0:b.value=!1,e});S(k,()=>{o.descripcion=o.descripcion.trim()});const N=l=>`/storage/uploads/proyectos/${l}`,C=l=>{if(o.imagen=l,console.log(o.imagen),!o.imagen)return;const e=new FileReader;e.onload=()=>{f.value=e.result},e.readAsDataURL(o.imagen)},D=()=>{o.imagen=null,f.value=null},L=()=>{console.log(o),o.post(route("proyectoUpdate",{id:r.proyecto.id}),{forceFormData:!0,onError:()=>V({title:"Error en el registro",text:"Por favor verifique los datos ingresados",icon:"error"}),onSuccess:()=>V({title:"Registro Actualizado",text:"El proyecto se ha actualizado exitosamente",icon:"success"}).then(l=>{window.location.reload()})})};return(l,e)=>(d(),m(M,null,[a(s(q),{title:"Editar proyecto"}),a(T,{breadCrumbLinks:U},{header:v(()=>[c(" Editar Proyecto "+_(p.proyecto.id),1)]),default:v(()=>[t("div",Y,[t("div",ee,[e[10]||(e[10]=t("h3",{class:"mt-1 text-gray-500"},"Nuevo proyecto",-1)),t("div",oe,[a(K,{href:l.route("proyectos.index")},{default:v(()=>e[9]||(e[9]=[c(" Regresar ")])),_:1},8,["href"])])]),t("div",te,[t("form",{onSubmit:O(L,["prevent"]),class:"grid sm:grid-cols-2 gap-4"},[t("div",se,[a(u,{for:"nombre",value:"Nombre del proyecto"}),a(h,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:s(o).detalle,"onUpdate:modelValue":e[0]||(e[0]=i=>s(o).detalle=i),required:"",autofocus:"",autocomplete:"nombre"},null,8,["modelValue"]),a(n,{class:"mt-2",message:s(o).errors.detalle},null,8,["message"])]),t("div",ae,[a(u,{for:"numero_tarjeton",value:"Numero tarjeton"}),a(h,{id:"numero_tarjeton",type:"number",class:"mt-1 block w-full",modelValue:s(o).numero_tarjeton,"onUpdate:modelValue":e[1]||(e[1]=i=>s(o).numero_tarjeton=i),autocomplete:"numero_tarjeton"},null,8,["modelValue"]),a(n,{class:"mt-2",message:s(o).errors.numero_tarjeton},null,8,["message"])]),t("div",re,[e[11]||(e[11]=t("p",{class:"text-gray-600 text-sm"}," Información adicional sobre el evento (max 500 caracteres) ",-1)),a(s(J),{modelValue:s(o).descripcion,"onUpdate:modelValue":e[2]||(e[2]=i=>s(o).descripcion=i),variant:"filled",autoResize:"",rows:"5",class:"mt-1 block w-full",required:"",autocomplete:"descripcion"},null,8,["modelValue"]),t("p",{class:$(["text-gray-500 text-sm mt-2",{"text-red-500":b.value}])},[c(_(k.value)+" caracteres ",1),b.value?(d(),m("span",le,"Limite de caracteres superado")):w("",!0)],2),a(n,{class:"mt-2",message:s(o).errors.descripcion},null,8,["message"])]),t("div",ie,[t("div",ne,[t("div",de,[a(u,{for:"tipos",value:"Tipos de usuarios"}),t("div",ue,_(s(o).tipo),1),a(n,{class:"mt-2",message:s(o).errors.tipos},null,8,["message"])]),t("div",me,[a(u,{for:"evento",value:"Asignar evento"}),p.eventos.length?(d(),m("div",ce,[a(s(H),{id:"eventos",modelValue:s(o).eventos,"onUpdate:modelValue":e[3]||(e[3]=i=>s(o).eventos=i),display:"chip",options:p.eventos,"option-label":"nombre","option-value":"id",placeholder:"Seleccione los eventos",maxSelectedLabels:6,class:"w-full md:w-20rem"},null,8,["modelValue","options"])])):(d(),m("p",pe,[e[12]||(e[12]=c(" No hay eventos registrados, registrar uno nuevo ")),t("a",{href:l.route("eventos.create")},"Aquí",8,fe)])),a(n,{class:"mt-2",message:s(o).errors.eventos},null,8,["message"])])]),t("div",ge,[t("div",ve,[t("div",be,[a(u,{for:"tipo_user",value:"Subtipos - "+A()},null,8,["value"]),a(G,{onClick:e[4]||(e[4]=i=>g.value=!g.value),class:"items-center"},{default:v(()=>[c(_(g.value?"Cancelar":"Agregar subtipo"),1)]),_:1})]),g.value?(d(),m("div",ye,[t("div",null,[a(u,{for:"parametro",value:"Parámetro"}),a(s(W),{id:"parametro",modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=i=>y.value=i),options:p.parametros,"option-label":"detalle","option-value":"cod",placeholder:"Seleccione un parámetro",class:"w-full"},null,8,["modelValue","options"]),a(n,{class:"mt-2",message:s(o).errors.parametro},null,8,["message"])]),t("div",xe,[a(u,{for:"parametroDetalle",value:"Subtipo"}),a(s(Q),{id:"parametroDetalle",modelValue:s(o).subtipo,"onUpdate:modelValue":e[6]||(e[6]=i=>s(o).subtipo=i),options:I.value,filter:"",optionLabel:"detalle",placeholder:"Seleccione un subtipo",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),a(n,{class:"mt-2",message:s(o).errors.subtipo},null,8,["message"])])])):w("",!0)])])]),t("div",_e,[a(u,{for:"estado",value:"Estado"}),R(t("select",{id:"estado","onUpdate:modelValue":e[7]||(e[7]=i=>s(o).estado=i),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-auto p-2. px-4"},e[13]||(e[13]=[t("option",{value:"1"},"Activo",-1),t("option",{value:"0"},"Bloqueado",-1)]),512),[[z,s(o).estado]]),a(n,{class:"mt-2",message:s(o).errors.estado},null,8,["message"])]),t("div",we,[e[15]||(e[15]=t("p",{class:"text-gray-600 text-sm"}," Imagen de proyecto (resolución recomendada: 1080x1080px) ",-1)),t("div",he,[t("div",Ve,[f.value||r.proyecto.imagen?(d(),m("img",{key:0,src:f.value||N(r.proyecto.imagen),alt:s(o).detalle,class:"w-2/6 h-auto"},null,8,ke)):(d(),F(s(X),{key:1,class:"w-1/6 text-gray-300"}))]),t("div",je,[e[14]||(e[14]=t("label",{for:"imagen",class:"bg-blue-500 text-white px-4 py-2 rounded cursor-pointer"}," Cambiar Imagen ",-1)),a(h,{id:"imagen",type:"file",class:"hidden",accept:"image/*",onInput:e[8]||(e[8]=i=>C(i.target.files[0]))}),a(n,{class:"mt-2",message:s(o).errors.imagen},null,8,["message"])]),f.value||r.proyecto.imagen?(d(),m("div",Se,[t("button",{onClick:D,type:"button",class:"bg-red-500 text-white px-4 py-2 rounded"}," Eliminar Imagen ")])):w("",!0)])]),t("div",null,[t("div",$e,[a(Z,{class:$({"opacity-25":s(o).processing}),disabled:s(o).processing},{default:v(()=>e[16]||(e[16]=[c(" Editar proyecto ")])),_:1},8,["class","disabled"])])])],32)])])]),_:1})],64))}};export{Ke as default};
