import{x as it,T as at,r as x,c as K,a as r,b as a,d as c,u as m,Z as rt,e as d,f as e,m as p,j as l,t as n,g as dt,v as ut,i as E,F as Q,h as ct}from"./app-EgMKzbbt.js";import{_ as vt}from"./AuthenticatedLayout-CzRrSiJ6.js";import{_ as $}from"./SecondaryButton-r28DdZJq.js";import{_ as F}from"./PrimaryButton-Bhn3mQjM.js";import{c as mt}from"./comunas-CgAZlVl9.js";import{N as ft}from"./vue-easy-lightbox.esm.min-9_ue_vbt.js";import{_ as S}from"./Modal-Imogx7Sm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const bt={class:"p-4"},gt={class:"bg-white shadow-md rounded-lg p-6 mb-6"},xt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pt={key:0},wt={class:"bg-white shadow-md rounded-lg p-6 flex flex-wrap gap-8 items-start"},ht={class:"flex-shrink-0 flex flex-col items-center"},yt=["src"],kt={key:1,class:"text-gray-400 italic"},Ct={class:"flex-shrink-0 flex flex-col items-center"},$t=["src"],Dt={key:1,class:"text-gray-400 italic"},Nt={class:"flex-shrink-0 flex flex-col items-center"},Rt=["src"],jt={key:1,class:"text-gray-400 italic"},zt={class:"flex-shrink-0 flex flex-col items-center"},Et=["src"],Ft={key:1,class:"text-gray-400 italic"},St={class:"bg-white shadow-md rounded-lg p-6 mt-6 flex flex-col md:flex-row gap-8 items-start"},qt={class:"w-auto"},At={class:""},Pt={key:0,class:""},It={class:"flex flex-col gap-2 w-full md:w-1/3"},Vt={class:"flex flex-col md:flex-row gap-4 mt-8 justify-center items-center h-full"},Bt={class:"flex justify-between items-center bg-azul text-white px-4 py-4"},Lt={class:"px-6 py-4"},Tt=["src"],Mt={class:"text-gray-800 font-medium"},Ut={class:"text-gray-800 font-medium"},Ht={class:"text-gray-800 font-medium"},Ot={class:"text-gray-800 font-medium"},Gt={class:"text-gray-800 font-medium"},Xt={class:"flex justify-end items-center gap-2 mt-6"},Yt=["disabled"],Zt=["disabled"],Jt={class:"flex justify-center items-center h-full w-full"},Kt={class:"text-center tex-base w-full"},Qt={class:"flex justify-center gap-4 my-4 h-full"},Wt={class:"flex justify-center items-center h-full w-full"},_t={class:"text-center tex-base w-full"},te={class:"flex justify-center gap-4 my-4 h-full"},q=5,de={__name:"ShowHistorial",props:{votante:{type:Object,required:!0},duplicados:{type:Object}},setup(o){const f=it("$swal"),w=o;console.log(w);const v=at({id:w.votante.id,motivo:""}),A=x(""),D=x(!1),N=x(!1),R=x(!1),j=x(!1),b=x(1),P=K(()=>Math.ceil(w.duplicados.length/q)),W=K(()=>{const i=(b.value-1)*q;return w.duplicados.slice(i,i+q)}),h=i=>{A.value=i,D.value=!0},_=()=>{D.value=!1},tt=i=>{const t=new Date(i),g=t.getFullYear(),k=String(t.getMonth()+1).padStart(2,"0"),C=String(t.getDate()).padStart(2,"0");return`${g}-${k}-${C}`},et=[{url:route("historial_registros"),text:"Histórico de registros"},{url:"",text:"Detalle registro"}],z=i=>`/storage/uploads/fotos/${i}`,y=i=>`/storage/uploads/documentos/${i}`,I=i=>`/storage/uploads/firmas/${i}`,ot=i=>{var t;return console.log(i),(t=mt.find(g=>g.value==i))==null?void 0:t.label},st=()=>{v.post(route("aprobarRegistro"),{onSuccess:function(){f({title:"Registro Aprobado",text:"El registro ha sido aprobado exitosamente",icon:"success"}).then(()=>{window.location.href=route("historial_registros")})},onError:function(){f({title:"Error al aprobar registro",text:"Error al intentar aprobar este registro, por favor vuelve a intentar",icon:"error"})}})},lt=()=>{v.post(route("rechazarRegistro"),{onSuccess:function(){f({title:"Registro Rechazado",text:"El registro ha sido rechazado exitosamente",icon:"success"}).then(()=>{window.location.href=route("historial_registros")})},onError:function(){f({title:"Error al rechazar registro",text:"Error al intentar rechazar este registro, por favor vuelve a intentar",icon:"error"})}})},nt=()=>{v.post(route("desbloquearRegistro"),{onSuccess:function(){f({title:"Registro Desbloqueado",text:"El registro ha sido desbloqueado exitosamente",icon:"success"}).then(()=>{window.location.href=route("historial_registros")})},onError:function(){f({title:"Error al desbloquear registro",text:"Error al intentar desbloquear este registro, por favor vuelve a intentar",icon:"error"})}})};return(i,t)=>(a(),r(Q,null,[c(m(rt),{title:"Revisión del votante"}),c(vt,{breadCrumbLinks:et},{header:d(()=>t[13]||(t[13]=[e("div",{class:"flex justify-between items-center"},[e("h1",{class:"text-2xl font-bold"},"Detalle del Registro")],-1)])),default:d(()=>{var g,k,C,V,B,L,T,M,U,H,O,G,X,Y,Z,J;return[e("div",bt,[e("div",gt,[t[25]||(t[25]=e("h2",{class:"text-lg font-bold mb-4 text-blue-900"},"Datos del votante",-1)),e("div",xt,[e("div",null,[t[14]||(t[14]=e("b",null,"Nombre:",-1)),l(" "+n(((g=o.votante.votante)==null?void 0:g.nombre)||"Sin información"),1)]),e("div",null,[t[15]||(t[15]=e("b",null,"Tipo de documento:",-1)),l(" "+n(((k=o.votante.votante)==null?void 0:k.tipo_documento)||"N/A"),1)]),e("div",null,[t[16]||(t[16]=e("b",null,"Número de documento:",-1)),l(" "+n(((C=o.votante.votante)==null?void 0:C.identificacion)||"N/A"),1)]),e("div",null,[t[17]||(t[17]=e("b",null,"Fecha expedición documento:",-1)),l(" "+n(((V=o.votante.votante)==null?void 0:V.fecha_expedicion)||"N/A"),1)]),e("div",null,[t[18]||(t[18]=e("b",null,"Fecha de nacimiento:",-1)),l(" "+n(((B=o.votante.votante)==null?void 0:B.nacimiento)||"N/A"),1)]),e("div",null,[t[19]||(t[19]=e("b",null,"Genero:",-1)),l(" "+n(((L=o.votante.votante)==null?void 0:L.genero)||"N/A"),1)]),e("div",null,[t[20]||(t[20]=e("b",null,"Comuna:",-1)),l(" "+n(ot(o.votante.subtipo)||"N/A"),1)]),e("div",null,[t[21]||(t[21]=e("b",null,"Barrio:",-1)),l(" "+n(((T=o.votante.votante)==null?void 0:T.barrio)||"N/A"),1)]),e("div",null,[t[22]||(t[22]=e("b",null,"Dirección:",-1)),l(" "+n(((M=o.votante.votante)==null?void 0:M.direccion)||"N/A"),1)]),o.votante.intentos>0?(a(),r("div",pt,[t[23]||(t[23]=e("b",null,"motivo rechazo:",-1)),l(" "+n(o.votante.motivo||"N/A"),1)])):p("",!0),e("div",null,[t[24]||(t[24]=e("b",null,"Estado:",-1)),l(" "+n(o.votante.estado||"N/A"),1)])])]),e("div",wt,[e("div",ht,[t[26]||(t[26]=e("h2",null,"Fotografía",-1)),(U=o.votante.votante)!=null&&U.user.biometrico?(a(),r("img",{key:0,src:z((H=o.votante.votante)==null?void 0:H.user.biometrico.photo),alt:"Foto del votante",onClick:t[0]||(t[0]=s=>{var u;return h(z((u=o.votante.votante)==null?void 0:u.user.biometrico.photo))}),class:"w-64 h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,yt)):(a(),r("span",kt,"Sin foto"))]),e("div",Ct,[t[27]||(t[27]=e("h2",null,"frontal",-1)),(O=o.votante.votante)!=null&&O.user.biometrico?(a(),r("img",{key:0,src:y((G=o.votante.votante)==null?void 0:G.user.biometrico.cedula_front),alt:"Foto del votante",onClick:t[1]||(t[1]=s=>{var u;return h(y((u=o.votante.votante)==null?void 0:u.user.biometrico.cedula_front))}),class:"w-full h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,$t)):(a(),r("span",Dt,"Sin foto"))]),e("div",Nt,[t[28]||(t[28]=e("h2",null,"Posterior",-1)),(X=o.votante.votante)!=null&&X.user.biometrico?(a(),r("img",{key:0,src:y((Y=o.votante.votante)==null?void 0:Y.user.biometrico.cedula_back),alt:"Foto del votante",onClick:t[2]||(t[2]=s=>{var u;return h(y((u=o.votante.votante)==null?void 0:u.user.biometrico.cedula_back))}),class:"w-full h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,Rt)):(a(),r("span",jt,"Sin foto"))]),e("div",zt,[t[29]||(t[29]=e("h2",null,"Firma",-1)),(Z=o.votante.votante)!=null&&Z.user.biometrico?(a(),r("img",{key:0,src:I((J=o.votante.votante)==null?void 0:J.user.biometrico.firma),alt:"Foto del votante",onClick:t[3]||(t[3]=s=>{var u;return h(I((u=o.votante.votante)==null?void 0:u.user.biometrico.firma))}),class:"w-full h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,Et)):(a(),r("span",Ft,"Sin foto"))])]),e("div",St,[e("div",qt,[e("div",At,[t[30]||(t[30]=e("b",null,"Validación:",-1)),l(" "+n(o.votante.validaciones),1)]),o.duplicados.length>0?(a(),r("div",Pt,[e("button",{onClick:t[4]||(t[4]=s=>N.value=!0),class:"bg-secondary text-white hover:scale-105 hover:bg-primary p-2 cursor-pointer rounded-md mt-2"}," Ver duplicados ")])):p("",!0)]),e("div",It,[t[32]||(t[32]=e("b",null,"Motivo de rechazo:",-1)),dt(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>m(v).motivo=s),class:"border rounded p-2"},t[31]||(t[31]=[e("option",{value:"",disabled:""},"Seleccione un motivo",-1),e("option",{value:"aprobado"},"No hay motivos (aprobado)",-1),e("option",{value:"Documentos incorrectos"}," Documentos incorrectos ",-1),e("option",{value:"Identidad no validada"},"Identidad no validada",-1),e("option",{value:"Parte frontal del documento poco visible"}," Parte frontal del documento poco visible ",-1),e("option",{value:"Parte Trasera del documento poco visible"}," Parte Trasera del documento poco visible ",-1),e("option",{value:"Firma poco visible"},"Firma poco visible",-1),e("option",{value:"Firma diferente a la presentada en el documento de identificación"}," Firma diferente a la presentada en el documento de identificación ",-1),e("option",{value:"Registro duplicado"},"Registro duplicado",-1),e("option",{value:"Información errónea, en comparación con la documentación"}," Información errónea, en comparación con la documentación ",-1),e("option",{value:"Dirección diferente a la comuna"}," Dirección diferente a la comuna ",-1)]),512),[[ut,m(v).motivo]])])]),e("div",Vt,[o.votante.estado==="Rechazado"?(a(),E(F,{key:0,onClick:st,class:"flex h-full items-center",disabled:m(v).processing},{default:d(()=>t[33]||(t[33]=[l(" Aprobar ")])),_:1},8,["disabled"])):p("",!0),o.votante.estado==="Activo"?(a(),E($,{key:1,onClick:t[6]||(t[6]=s=>R.value=!0),class:"!bg-red-500 text-white",disabled:m(v).processing},{default:d(()=>t[34]||(t[34]=[l(" Rechazar ")])),_:1},8,["disabled"])):p("",!0),o.votante.estado==="Bloqueado"?(a(),E($,{key:2,onClick:t[7]||(t[7]=s=>j.value=!0),class:"!bg-yellow-500 text-white",disabled:m(v).processing},{default:d(()=>t[35]||(t[35]=[l(" Desbloquear ")])),_:1},8,["disabled"])):p("",!0)]),c(m(ft),{visible:D.value,imgs:[A.value],onHide:_},null,8,["visible","imgs"])]),c(S,{show:N.value,closeable:!0},{default:d(()=>[e("div",Bt,[t[36]||(t[36]=e("h2",{class:"text-2xl font-semibold text-center"}," Registros duplicados o similares ",-1)),e("button",{onClick:t[8]||(t[8]=s=>N.value=!1),class:"text-white text-xl hover:text-gray-300"}," X ")]),e("div",Lt,[(a(!0),r(Q,null,ct(W.value,s=>(a(),r("div",{key:s.id,class:"flex gap-4 items-center mb-4 border-b pb-2"},[e("img",{src:z(s.photo),alt:"Foto",class:"w-36 h-full object-cover rounded"},null,8,Tt),e("div",null,[e("p",Mt," ID: "+n(s.user.votantes.hash_votantes[0].id),1),e("p",Ut," Nombre: "+n(s.user.votantes.nombre),1),e("p",Ht," Identificación: "+n(s.user.votantes.identificacion),1),e("p",Ot," Creación: "+n(tt(s.user.votantes.hash_votantes[0].created_at)),1),e("p",Gt,"Estado: "+n(s.estado),1)])]))),128)),e("div",Xt,[e("button",{class:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",disabled:b.value===1,onClick:t[9]||(t[9]=s=>b.value--)}," Anterior ",8,Yt),e("span",null,"Página "+n(b.value)+" de "+n(P.value),1),e("button",{class:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",disabled:b.value===P.value,onClick:t[10]||(t[10]=s=>b.value++)}," Siguiente ",8,Zt)])])]),_:1},8,["show"]),c(S,{show:R.value,closeable:!0},{default:d(()=>[e("div",Jt,[e("div",Kt,[t[39]||(t[39]=e("div",{class:"bg-azul text-white p-2 shadow-lg w-full mb-4"},[e("h2",{class:"text-2xl font-semibold"},"Confirmar Rechazo")],-1)),t[40]||(t[40]=e("p",{class:"mb-4"}," ¿Estás seguro de que deseas rechazar este registro? ",-1)),e("div",Qt,[c(F,{onClick:lt,class:"!bg-red-500 text-white"},{default:d(()=>t[37]||(t[37]=[l(" Confirmar ")])),_:1}),c($,{onClick:t[11]||(t[11]=s=>R.value=!1),class:"!bg-gray-300 text-black"},{default:d(()=>t[38]||(t[38]=[l(" Cancelar ")])),_:1})])])])]),_:1},8,["show"]),c(S,{show:j.value,closeable:!0},{default:d(()=>[e("div",Wt,[e("div",_t,[t[43]||(t[43]=e("div",{class:"bg-azul text-white p-2 shadow-lg w-full mb-4"},[e("h2",{class:"text-2xl font-semibold"},"Confirmar desbloqueo")],-1)),t[44]||(t[44]=e("p",{class:"mb-4"}," ¿Estás seguro de que deseas desbloquear al usuario? una vez desbloqueado, podrá volver a corregir los datos. ",-1)),e("div",te,[c(F,{onClick:nt,class:"!bg-red-500 text-white"},{default:d(()=>t[41]||(t[41]=[l(" Confirmar ")])),_:1}),c($,{onClick:t[12]||(t[12]=s=>j.value=!1),class:"!bg-gray-300 text-black"},{default:d(()=>t[42]||(t[42]=[l(" Cancelar ")])),_:1})])])])]),_:1},8,["show"])]}),_:1})],64))}};export{de as default};
