import{x as B,r as x,T as P,i as $,b as u,e as T,d as l,f as s,u as t,Z as L,p as w,g as _,a as m,F as z,h as E,t as N,v as I,n as h,m as U,q as S,j as v}from"./app-P10AiYR1.js";import{s as J,P as O}from"./index-DTtgjE2U.js";import{_ as n}from"./InputError-DH8UiTTt.js";import{_ as r}from"./InputLabel-CgOc4jFq.js";import{_ as X}from"./PrimaryButton-vjKNi_kx.js";import{_ as p}from"./TextInput-CRa-mbcz.js";import{s as q}from"./index-DijKbpJJ.js";import{c as Y}from"./comunas-CgAZlVl9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-ZA9Sr_Iy.js";import"./index-DNRrpZ1Q.js";import"./index-vdVncDoE.js";import"./index-Be1fzYNM.js";import"./index-Bd-qofzd.js";import"./index-B1oOaEi8.js";import"./index-Dk-e_R7w.js";const H={class:"w-full sm:max-w-6xl h-full mx-auto bg-white shadow-lg rounded-lg px-4 sm:px-6 py-12 z-10"},W={class:"mb-2"},Z={class:"mb-2"},G={class:"mb-2"},K={class:"mb-2"},Q={class:"mb-2"},ee={class:"mb-2"},oe=["value"],te={class:"mb-2"},ae={class:"mb-2"},se={class:"mb-2"},le={class:"flex gap-4 mb-2"},ie={key:0},ne={key:0,class:"mt-2"},re=["src"],ce={key:1},de={key:0,class:"mt-2"},ue=["src"],me={class:"my-4 col-span-2 mb-2"},pe={class:"mb-4 col-span-2 mb-2"},fe={class:"mt-4 flex flex-col items-end"},qe={__name:"RegistroJurados",props:{eventos:{type:Array,default:()=>[]},puntos_votacion:{type:Array,default:()=>[]}},setup(y){const k=B("$swal"),c=x(null),f=x("imagen"),d=x(null);let g=!1;const o=P({nombre:"",identificacion:"",contacto:"",comuna:"",punto_votacion:"",id_evento:"",tipo:"jurado",firma:null,email:"",password:"",codigo_verificacion:"",checked:!1,declaracion:!1}),A=i=>{const e=i.target.files[0];if(o.firma=e,e){const a=new FileReader;a.onload=j=>{c.value=j.target.result},a.readAsDataURL(e)}else c.value=null},V=i=>{g=!0;const e=d.value.getContext("2d"),a=F(i);e.beginPath(),e.moveTo(a.x,a.y)},C=i=>{if(!g)return;const e=d.value.getContext("2d"),a=F(i);e.lineTo(a.x,a.y),e.strokeStyle="#222",e.lineWidth=2,e.stroke()},b=()=>{g=!1},D=()=>{d.value.getContext("2d").clearRect(0,0,d.value.width,d.value.height),c.value=null,o.firma=null},R=()=>{d.value.toBlob(i=>{o.firma=new File([i],"firma.webp",{type:"image/webp"});const e=new FileReader;e.onload=a=>{c.value=a.target.result},e.readAsDataURL(o.firma)},"image/webp")},F=i=>{const e=d.value.getBoundingClientRect();return i.touches&&i.touches.length>0?{x:i.touches[0].clientX-e.left,y:i.touches[0].clientY-e.top}:{x:i.offsetX,y:i.offsetY}},M=()=>{console.log(o),o.comuna=o.comuna.value,o.punto_votacion=o.punto_votacion.id,o.post(route("jurados.store"),{forceFormData:!0,onSuccess:()=>{o.reset(),c.value=null,D(),k.fire({title:"Registro exitoso",text:"El jurado ha sido registrado correctamente.",icon:"success",confirmButtonText:"Aceptar"}).then(i=>{window.location.href=route("welcome")})},onError:i=>{console.error(i),k.fire({title:"Error",text:"Hubo un problema al registrar el jurado. Por favor, revisa los campos e intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}})};return(i,e)=>(u(),$(O,null,{default:T(()=>[l(t(L),{title:"Registro de jurados"}),s("div",H,[e[18]||(e[18]=s("h1",{class:"text-2xl font-bold text-center text-gray-800"}," Registro Jurados ",-1)),s("form",{onSubmit:w(M,["prevent"]),enctype:"multipart/form-data",class:"sm:grid sm:grid-cols-2 gap-4 mt-6"},[s("div",W,[l(r,{for:"nombre",value:"Nombre(*)"}),l(p,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:t(o).nombre,"onUpdate:modelValue":e[0]||(e[0]=a=>t(o).nombre=a),required:"",autofocus:"",autocomplete:"off"},null,8,["modelValue"]),l(n,{class:"mt-2",message:t(o).errors.nombre},null,8,["message"])]),s("div",Z,[l(r,{for:"identificacion",value:"Identificación"}),l(p,{id:"identificacion",type:"number",class:"mt-1 block w-full",modelValue:t(o).identificacion,"onUpdate:modelValue":e[1]||(e[1]=a=>t(o).identificacion=a),required:"",autofocus:"",autocomplete:"off"},null,8,["modelValue"]),l(n,{class:"mt-2",message:t(o).errors.identificacion},null,8,["message"])]),s("div",G,[l(r,{for:"contacto",value:"Numero de contacto"}),l(p,{id:"contacto",type:"number",class:"mt-1 block w-full",modelValue:t(o).contacto,"onUpdate:modelValue":e[2]||(e[2]=a=>t(o).contacto=a),required:"",autofocus:"",autocomplete:"off"},null,8,["modelValue"]),l(n,{class:"mt-2",message:t(o).errors.contacto},null,8,["message"])]),s("div",K,[l(r,{for:"comuna",value:"Comuna correspondiente"}),l(t(q),{id:"comuna",modelValue:t(o).comuna,"onUpdate:modelValue":e[3]||(e[3]=a=>t(o).comuna=a),options:t(Y),filter:"",optionLabel:"label",placeholder:"Seleccione comuna",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),l(n,{class:"mt-2",message:t(o).errors.comuna},null,8,["message"])]),s("div",Q,[l(r,{for:"punto_votacion",value:"Punto de votación"}),l(t(q),{id:"punto_votacion",modelValue:t(o).punto_votacion,"onUpdate:modelValue":e[4]||(e[4]=a=>t(o).punto_votacion=a),options:y.puntos_votacion,filter:"",optionLabel:"detalle",placeholder:"Seleccione un punto de votación",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),l(n,{class:"mt-2",message:t(o).errors.punto_votacion},null,8,["message"])]),s("div",ee,[l(r,{for:"id_evento",value:"Asignar Evento"}),_(s("select",{id:"id_evento","onUpdate:modelValue":e[5]||(e[5]=a=>t(o).id_evento=a),class:"block mt-1 w-full rounded-md form-select focus:border-sky-600"},[e[13]||(e[13]=s("option",{value:"",disabled:"",selected:""},"Seleccione un evento",-1)),(u(!0),m(z,null,E(y.eventos,a=>(u(),m("option",{key:a.id,value:a.id},N(a.nombre),9,oe))),128))],512),[[I,t(o).id_evento]]),l(n,{class:"mt-2",message:t(o).errors.id_evento},null,8,["message"])]),s("div",te,[l(r,{for:"codigo_verificacion",value:"Código de verificación"}),l(p,{id:"codigo_verificacion",type:"text",class:"mt-1 block w-full",modelValue:t(o).codigo_verificacion,"onUpdate:modelValue":e[6]||(e[6]=a=>t(o).codigo_verificacion=a),required:"",autocomplete:"off"},null,8,["modelValue"]),l(n,{class:"mt-2",message:t(o).errors.codigo_verificacion},null,8,["message"])]),s("div",ae,[l(r,{for:"email",value:"Correo Electrónico"}),l(p,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:t(o).email,"onUpdate:modelValue":e[7]||(e[7]=a=>t(o).email=a),required:""},null,8,["modelValue"]),l(n,{class:"mt-2",message:t(o).errors.email},null,8,["message"])]),e[17]||(e[17]=s("div",{class:"mb-2"},[s("div",{class:"bg-azul rounded-md p-2 w-full h-full"},[s("p",{class:"text-white text-base"}," Asegúrese de que la contraseña sea facil de recordar para usted, ya que la necesitará para acceder a su cuenta en el momento de la votación. ")])],-1)),s("div",se,[l(r,{for:"password",value:"Contraseña (mínimo: 8 caracteres)"}),l(t(J),{id:"password",modelValue:t(o).password,"onUpdate:modelValue":e[8]||(e[8]=a=>t(o).password=a),required:"",toggleMask:""},null,8,["modelValue"]),l(n,{class:"mt-2",message:t(o).errors.password},null,8,["message"])]),s("div",null,[l(r,{for:"firma",value:"Firma"}),s("div",le,[s("button",{type:"button",class:h(["px-2 py-1 rounded",f.value==="imagen"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[9]||(e[9]=a=>f.value="imagen")}," Cargar imagen ",2),s("button",{type:"button",class:h(["px-2 py-1 rounded",f.value==="canvas"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[10]||(e[10]=a=>f.value="canvas")}," Dibujar firma ",2)]),f.value==="imagen"?(u(),m("div",ie,[l(p,{id:"firma",type:"file",class:"mt-1 block w-full",accept:"image/*",onChange:A}),l(n,{class:"mt-2",message:t(o).errors.firma},null,8,["message"]),c.value?(u(),m("div",ne,[s("img",{src:c.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,re)])):U("",!0)])):(u(),m("div",ce,[s("canvas",{ref_key:"canvas",ref:d,height:"150",class:"border border-gray-400 rounded-md bg-white cursor-crosshair sm:w-[300px] w-[250px]",onMousedown:V,onMousemove:C,onMouseup:b,onMouseleave:b,onTouchstart:w(V,["prevent"]),onTouchmove:w(C,["prevent"]),onTouchend:b},null,544),s("div",{class:"flex gap-2 mt-1"},[s("button",{type:"button",onClick:D,class:"text-xl text-blue-600 underline"}," Limpiar "),s("button",{type:"button",onClick:R,class:"text-xl text-green-600 underline"}," Usar firma ")]),l(n,{class:"mt-2",message:t(o).errors.firma},null,8,["message"]),c.value?(u(),m("div",de,[s("img",{src:c.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,ue)])):U("",!0)]))]),s("div",me,[_(s("input",{type:"checkbox",id:"consentimiento1",name:"consentimiento1",required:"","onUpdate:modelValue":e[11]||(e[11]=a=>t(o).checked=a)},null,512),[[S,t(o).checked]]),e[14]||(e[14]=s("label",{for:"consentimiento1",class:"ps-4 pe-12 sm:text-base text-sm text-gray-500"},[v("Conozco y Acepto la Política de Privacidad de Datos "),s("a",{href:"https://www.pereira.gov.co/publicaciones/38/politicas-de-privacidad-y-condiciones-de-uso/",target:"_blank",class:"underline !text-azul cursor-pointer"},"politica")],-1)),l(n,{class:"mt-1",message:t(o).errors.checked},null,8,["message"])]),s("div",pe,[_(s("input",{type:"checkbox",id:"consentimiento2",name:"consentimiento2",required:"","onUpdate:modelValue":e[12]||(e[12]=a=>t(o).declaracion=a)},null,512),[[S,t(o).declaracion]]),e[15]||(e[15]=s("label",{for:"consentimiento2",class:"ps-4 pe-12 sm:text-base text-sm text-gray-500"},[v("Manifiesto que acepto la "),s("a",{href:"https://www.pereira.gov.co/loader.php?lServicio=Tools2&lTipo=descargas&lFuncion=visorpdf&file=https%3A%2F%2Fwww.pereira.gov.co%2Floader.php%3FlServicio%3DTools2%26lTipo%3Ddescargas%26lFuncion%3DexposeDocument%26idFile%3D211273%26tmp%3De1c59e50ed23a13cda9087f627ac4f4d%26urlDeleteFunction%3Dhttps%253A%252F%252Fwww.pereira.gov.co%252Floader.php%253FlServicio%253DTools2%2526lTipo%253Ddescargas%2526lFuncion%253DdeleteTemporalFile%2526tmp%253De1c59e50ed23a13cda9087f627ac4f4d&pdf=1&tmp=e1c59e50ed23a13cda9087f627ac4f4d&fileItem=211273",target:"_blank",class:"underline !text-azul cursor-pointer"},"Declaración"),v(" juramentada")],-1)),l(n,{class:"mt-1",message:t(o).errors.declaracion},null,8,["message"])]),s("div",fe,[l(X,{class:h({"opacity-25":t(o).processing}),disabled:t(o).processing},{default:T(()=>e[16]||(e[16]=[v(" Registrarse ")])),_:1},8,["class","disabled"])])],32)])]),_:1}))}};export{qe as default};
