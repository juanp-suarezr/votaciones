import{x as w,r as E,T as _,c as d,o as m,b as f,u as s,Z as k,d as p,e as o,j as e,m as z,F as I,z as B}from"./app-CT680WbL.js";import{_ as F}from"./AuthenticatedLayout-D0EhdYoe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BreadCrumb-BCO3_6qP.js";import"./SecondaryButtonReturn-C3teBeRc.js";import"./index-JKhcEbL9.js";import"./index-DQrz5kO6.js";import"./index-Cuyrp-m7.js";import"./PrimaryButton-CC4x-6gw.js";import"./XCircleIcon-Dv5PCz4G.js";const N={class:"flex items-center gap-4 mb-8"},V={class:"flex flex-col w-full max-w-md"},$=["disabled"],P={key:0},T={key:1},A={class:"mt-6"},Z={__name:"CargarInformacion",setup(j){const c=w("$swal"),b=[{url:route("votantesFisicos.index"),text:"Cargue de votantes fÃ­sicos"},{url:"",text:"Cargar InformaciÃ³n de Votantes"}],u=E(null),n=_({file:null}),x=t=>{u.value=t.target.files[0],n.file=u.value},v=()=>{if(!n.file){c({title:"Error",text:"Por favor seleccione un archivo primero",icon:"error"});return}const t=new FormData;t.append("file",n.file),n.processing=!0,B.post(route("votantesFisicos.cargarInformacion"),t,{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{const r=l.data.numRegistrosActualizados??0,a=l.data.numNoEncontrados??0,h=l.data.numErrores??0,g=l.data.comunasProcesadas??{};let i="";if(Object.keys(g).length>0){i='<hr class="my-3"><p class="font-semibold">ğŸ˜ï¸ Comunas procesadas:</p><ul class="list-disc list-inside ml-2">';for(const[y,C]of Object.entries(g))i+=`<li><strong>ID ${y}:</strong> ${C}</li>`;i+="</ul>"}c({title:"Proceso Completado",html:`
          <div class="text-left">
            <p>âœ… <strong>Actualizados:</strong> ${r}</p>
            <p>âš ï¸ <strong>No encontrados:</strong> ${a}</p>
            <p>ğŸš¨ <strong>Errores:</strong> ${h}</p>
            ${i}
            <hr class="my-3">
            <p class="text-green-600 font-semibold">ğŸ“§ El informe detallado ha sido enviado al correo configurado.</p>
          </div>
        `,icon:"success",showConfirmButton:!0,confirmButtonText:"Aceptar",timer:0,allowOutsideClick:!1,allowEscapeKey:!1}),n.reset(),u.value=null}).catch(l=>{var r,a;console.error(l),c.fire("Error",((a=(r=l.response)==null?void 0:r.data)==null?void 0:a.message)||"Hubo un problema al procesar el archivo.","error",{showConfirmButton:!0,confirmButtonText:"Aceptar",timer:0,allowOutsideClick:!1,allowEscapeKey:!1})}).finally(()=>{n.processing=!1})};return(t,l)=>(m(),d(I,null,[f(s(k),{title:"Cargar InformaciÃ³n de Votantes"}),f(F,{breadCrumbLinks:b},{header:p(()=>l[0]||(l[0]=[e(" Cargar InformaciÃ³n de Votantes ")])),default:p(()=>[l[3]||(l[3]=o("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},[o("h3",{class:"text-sm font-semibold text-blue-800 mb-2"},"Instrucciones:"),o("ul",{class:"text-sm text-blue-700 list-disc list-inside"},[o("li",null,"El archivo Excel debe contener las siguientes columnas en este orden:"),o("ul",{class:"ml-5 list-disc list-inside"},[o("li",null,[o("strong",null,"1. nombre"),e(" - Nombre completo del votante")]),o("li",null,[o("strong",null,"2. tipo documento"),e(" - Tipo de documento (CC, TI, etc.)")]),o("li",null,[o("strong",null,"3. numero identificacion"),e(" - (obligatorio) NÃºmero de identificaciÃ³n del votante")]),o("li",null,[o("strong",null,"4. email"),e(" - (opcional) Correo electrÃ³nico")]),o("li",null,[o("strong",null,"5. fecha nacimiento"),e(" - Fecha de nacimiento (formato: dd/mm/yyyy)")]),o("li",null,[o("strong",null,"6. Genero"),e(" - GÃ©nero del votante")]),o("li",null,[o("strong",null,"7. Grupo poblacional"),e(" - Etnia o grupo poblacional")]),o("li",null,[o("strong",null,"8. condicion"),e(" - CondiciÃ³n del votante")]),o("li",null,[o("strong",null,"9. numero telefono"),e(" - (opcional) NÃºmero de celular")]),o("li",null,[o("strong",null,"10. direccion"),e(" - DirecciÃ³n de residencia")]),o("li",null,[o("strong",null,"11. barrio"),e(" - Barrio")]),o("li",null,[o("strong",null,"12. comuna"),e(" - ID de la comuna")])]),o("li",null,[e("Los datos del Excel comienzan a partir de la "),o("strong",null,"fila 3"),e(" (fila 1 y 2 son encabezados).")]),o("li",null,[e("Solo se actualizarÃ¡n voters con relaciÃ³n al evento "),o("strong",null,"Presupuesto Participativo"),e(".")]),o("li",null,[e("Los registros se actualizarÃ¡n segÃºn el "),o("strong",null,"nÃºmero de identificaciÃ³n"),e(" (columna 3).")]),o("li",null,"Solo se actualizarÃ¡n los campos que vengan con datos en el Excel."),o("li",null,[o("strong",null,"El informe detallado se enviarÃ¡ al correo configurado.")])])],-1)),o("div",N,[o("div",V,[l[1]||(l[1]=o("label",{for:"carga-informacion",class:"text-xs font-semibold mb-1"},"Cargar informaciÃ³n de votantes (Excel)",-1)),o("input",{id:"carga-informacion",type:"file",class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none",onChange:x,accept:".csv,.xlsx,.xls"},null,32),o("button",{class:"mt-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!s(n).file||s(n).processing,onClick:v},[s(n).processing?(m(),d("span",P,"Procesando...")):(m(),d("span",T,"Actualizar InformaciÃ³n"))],8,$)])]),o("div",A,[f(s(z),{href:t.route("votantesFisicos.index"),class:"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700"},{default:p(()=>l[2]||(l[2]=[o("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),e(" Volver a Votantes FÃ­sicos ")])),_:1},8,["href"])])]),_:1})],64))}};export{Z as default};
