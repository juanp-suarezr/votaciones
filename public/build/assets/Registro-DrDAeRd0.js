import{x as A,T as P,Q as u,r as p,w as Q,a as l,b as r,d as i,u as s,Z,e as w,f as a,m as j,g as b,F as h,h as S,t as k,v as E,O as H,n as M,z as q,j as R,k as J}from"./app-kLK7cTUr.js";import{_ as W}from"./AuthenticatedLayout-zZ_m7ZH6.js";import{s as D,t as X,e as ee,c as oe}from"./etnia-DIHgwtcg.js";import{_ as v}from"./InputError-DN-wUhQp.js";import{_ as m}from"./InputLabel-DIzyoBIM.js";import{_ as te}from"./PrimaryButton-Khx9Gnag.js";import{_ as se}from"./Modal-t2I7SYjV.js";import{_ as g}from"./TextInput--rMaKWJ2.js";import{s as ae}from"./index-rF11ey5J.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-XRpu1uux.js";const ie={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ne={class:"mt-4 justify-center"},le={class:"m-auto py-4 px-4"},re={key:0,class:"sm:grid sm:grid-cols-2 gap-6 h-full"},de={class:"mb-2"},ue=["value"],ce={class:"mb-2"},me={class:"col-span-2 flex justify-end"},pe=["disabled"],ve={key:1,class:"sm:grid sm:grid-cols-2 gap-6"},fe={class:"mb-2"},be={class:"mb-2"},ge={key:0,class:"text-red-500"},_e={class:"mb-2"},xe={class:"mt-2 block sm:flex"},ye={class:""},we={class:"sm:ms-6"},he={key:0,class:"sm:ms-6"},ke={key:1,class:"sm:ms-6"},Ve={class:"mb-2"},je=["value"],Se={class:"mb-2"},Ee=["value"],qe={class:"mb-2"},Ue={class:"mb-2"},Ne={class:"col-span-2 flex justify-between gap-2"},Ce={class:"flex pt-4 justify-end"},$e={class:"flex pt-4 justify-end h-full"},Me={class:"flex justify-center my-12"},Ae={__name:"Registro",setup(Re){const U=A("$swal"),F=[{url:"",text:"Registro votantes"}],e=P({nombre:"",identificacion:"",tipo_documento:"",nacimiento:"",comuna:u().props.user.jurado.comuna,id_jurado:u().props.user.jurado.id,id_evento:u().props.user.jurado.evento.id,genero:"",etnia:"",condicion:"",direccion:"",barrio:""}),_=p(!1),I=p([{label:"Validación previa"},{label:"Información"}]),z=p([{label:"paso 1"},{label:"paso 2"}]),c=p(0),f=p(""),x=p(""),d=p(!1),y=p(!1);p(!1),Q(y,n=>{n&&(e.genero="")});const L=n=>{c.value=n,d.value=!0},B=()=>{if(!e.nacimiento)return x.value="Debes ingresar la fecha de nacimiento.",!1;const n=new Date,o=e.nacimiento,[t,K,Y]=o.split("-").map(Number);let $=n.getFullYear()-t;const V=n.getMonth()-(K-1);return console.log(n.getMonth()),console.log(V),console.log(n.getDate()),(V<0||V===0&&n.getDate()<Y)&&$--,$<14?(x.value="No cumple con el requisito de edad mínima (14 años), por lo tanto, no puede ejercer el derecho al voto.",!1):(x.value="",!0)},G=async()=>{if(d.value=!1,_.value=!0,e.identificacion&&e.tipo_documento){f.value="",console.log(u().props);try{const n=await O(e.identificacion);if(console.log("Identificación data:",n),_.value=!1,n.existe){if(f.value="La identificación ya está registrada.",n.votante&&n.votante.votos.length>0)f.value+=" Y el votante ya ha emitido su voto en las elecciones.";else{window.location.href=route("votos.index",{id_votante:n.votante.id,evento:u().props.user.jurado.evento.id,tipo_evento:u().props.user.jurado.evento.tipos,tipo_user:n.votante.hash_votantes.length!=0?n.votante.hash_votantes[0].tipo:"",subtipo_user:n.votante.hash_votantes.length!=0?n.votante.hash_votantes[0].subtipo:""});return}d.value=!1}else f.value="",d.value=!0}catch{f.value="Error al validar la identificación. Intenta de nuevo.",d.value=!1}}d.value?c.value=1:(_.value=!1,(!e.identificacion||f.value!="")&&(e.errors.identificacion=f.value||"Este campo es requerido."),e.tipo_documento||(e.errors.tipo_documento="Este campo es requerido."))},O=async n=>{const o=await J.post("/validar-identificacion-presencial",{identificacion:n,registro_presencial:!0});return console.log(o.data),o.data},N=n=>{switch(d.value=!1,n){case 1:G();break;case 2:C();break}d.value&&(c.value=n)},C=()=>{if(d.value=!1,e.nombre&&e.nacimiento&&e.genero&&e.etnia&&e.condicion&&e.barrio&&e.direccion){if(d.value=!0,!B())return;T()}d.value||(e.nombre||(e.errors.nombre="Este campo es requerido."),e.nacimiento||(e.errors.nacimiento="Este campo es requerido."),e.genero||(e.errors.genero="Este campo es requerido."),e.etnia||(e.errors.etnia="Este campo es requerido."),e.condicion||(e.errors.condicion="Este campo es requerido."),e.barrio||(e.errors.barrio="Este campo es requerido."),e.direccion||(e.errors.direccion="Este campo es requerido."))},T=()=>{e.post(route("votantesPresencial.store"),{onSuccess:()=>{U({title:"Registro realizado",text:"Registro de votante realizado exitosamente.",icon:"success"}).then(n=>{console.log(n),window.location.href=route("votos.index",{id_votante:u().props.flash.success.id_votante,evento:u().props.user.jurado.evento.id,tipo_evento:u().props.user.jurado.evento.tipos,tipo_user:u().props.flash.success.hash_votante.tipo,subtipo_user:u().props.flash.success.hash_votante.subtipo})})},onError:n=>{U({title:"Error",text:"Ocurrió un error al registrar el votante.",icon:"error"}).then(o=>{c.value=0}),console.error(n)}})};return(n,o)=>(r(),l(h,null,[i(s(Z),{title:"Registro votantes"}),i(W,{breadCrumbLinks:F},{header:w(()=>o[17]||(o[17]=[R(" Registro de votante ")])),default:w(()=>[a("div",ie,[o[25]||(o[25]=a("div",{class:"p-6 border-b border-gray-200"},[a("h1",null,"Registro votante")],-1)),a("div",ne,[i(s(D),{class:"hidden sm:block",model:I.value,activeStep:c.value,"onUpdate:activeStep":o[0]||(o[0]=t=>c.value=t)},null,8,["model","activeStep"]),i(s(D),{class:"sm:hidden block",model:z.value,activeStep:c.value,"onUpdate:activeStep":o[1]||(o[1]=t=>c.value=t)},null,8,["model","activeStep"])]),a("form",le,[c.value==0?(r(),l("div",re,[a("div",de,[i(m,{for:"tipo_documento",value:"Tipo de Documento"}),b(a("select",{id:"tipo_documento","onUpdate:modelValue":o[2]||(o[2]=t=>s(e).tipo_documento=t),class:"mt-1 block w-full border-gray-300 rounded-lg"},[o[18]||(o[18]=a("option",{value:"",disabled:""},"Seleccione tipo de documento",-1)),(r(!0),l(h,null,S(s(X),t=>(r(),l("option",{key:t.id,value:t.nombre},k(t.nombre),9,ue))),128))],512),[[E,s(e).tipo_documento]]),i(v,{class:"mt-2",message:s(e).errors.tipo_documento},null,8,["message"])]),a("div",ce,[i(m,{for:"identificacion",value:"Identificación"}),i(g,{id:"identificacion",type:"text",class:"mt-1 block w-full",modelValue:s(e).identificacion,"onUpdate:modelValue":o[3]||(o[3]=t=>s(e).identificacion=t),onKeydown:o[4]||(o[4]=H(t=>N(1),["enter"])),required:""},null,8,["modelValue"]),i(v,{class:"mt-2",message:s(e).errors.identificacion},null,8,["message"])]),a("div",me,[a("button",{type:"button",class:M(["bg-secondary hover:bg-primary text-xs sm:text-sm text-white p-2 rounded-md shadow-xl",{"opacity-25":_.value}]),onClick:o[5]||(o[5]=t=>N(1)),disabled:_.value}," Siguiente ",10,pe)])])):j("",!0),c.value==1?(r(),l("div",ve,[a("div",fe,[i(m,{for:"nombre",value:"Nombre Completo"}),i(g,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:s(e).nombre,"onUpdate:modelValue":o[6]||(o[6]=t=>s(e).nombre=t),required:""},null,8,["modelValue"]),i(v,{class:"mt-2",message:s(e).errors.nombre},null,8,["message"])]),a("div",be,[i(m,{for:"nacimiento",value:"Fecha de Nacimiento"}),i(g,{id:"nacimiento",type:"date",class:"mt-1 block w-full",modelValue:s(e).nacimiento,"onUpdate:modelValue":o[7]||(o[7]=t=>s(e).nacimiento=t),required:""},null,8,["modelValue"]),i(v,{class:"mt-2",message:s(e).errors.nacimiento},null,8,["message"]),x.value?(r(),l("p",ge,k(x.value),1)):j("",!0)]),a("div",_e,[i(m,{for:"genero",value:"Género"}),a("div",xe,[a("div",ye,[b(a("input",{type:"radio",id:"masculino",value:"Masculino","onUpdate:modelValue":o[8]||(o[8]=t=>s(e).genero=t)},null,512),[[q,s(e).genero]]),o[19]||(o[19]=a("label",{class:"ps-2 text-sm sm:text-base",for:"masculino"},"Masculino",-1))]),a("div",we,[b(a("input",{type:"radio",id:"two",value:"Femenino","onUpdate:modelValue":o[9]||(o[9]=t=>s(e).genero=t)},null,512),[[q,s(e).genero]]),o[20]||(o[20]=a("label",{class:"ps-2 text-sm sm:text-base",for:"two"},"Femenino",-1))]),y.value?(r(),l("div",he,[i(m,{class:"sm:text-sm text-xs",for:"genero",value:"¿Cual?"}),i(g,{id:"genero",type:"text",class:"mt-1 block w-full p-0 sm:p-1",modelValue:s(e).genero,"onUpdate:modelValue":o[10]||(o[10]=t=>s(e).genero=t),autocomplete:"genero"},null,8,["modelValue"]),i(v,{class:"mt-1",message:s(e).errors.genero},null,8,["message"])])):(r(),l("div",ke,[b(a("input",{type:"radio",id:"tres",value:"true","onUpdate:modelValue":o[11]||(o[11]=t=>y.value=t)},null,512),[[q,y.value]]),o[21]||(o[21]=a("label",{class:"ps-2 text-sm sm:text-base",for:"tres"},"Otro",-1))]))])]),a("div",Ve,[i(m,{for:"etnia",value:"Grupo poblacional"}),b(a("select",{id:"etnia","onUpdate:modelValue":o[12]||(o[12]=t=>s(e).etnia=t),class:"mt-1 block w-full border-gray-300 rounded-lg"},[o[22]||(o[22]=a("option",{value:"",disabled:""}," Seleccione grupo poblacional perteneciente ",-1)),(r(!0),l(h,null,S(s(ee),t=>(r(),l("option",{key:t.id,value:t.nombre},k(t.nombre),9,je))),128))],512),[[E,s(e).etnia]]),i(v,{class:"mt-2",message:s(e).errors.etnia},null,8,["message"])]),a("div",Se,[i(m,{for:"condicion",value:"Condición poblacional"}),b(a("select",{id:"condicion","onUpdate:modelValue":o[13]||(o[13]=t=>s(e).condicion=t),class:"mt-1 block w-full border-gray-300 rounded-lg"},[o[23]||(o[23]=a("option",{value:"",disabled:""}," Seleccione condición poblacional ",-1)),(r(!0),l(h,null,S(s(oe),t=>(r(),l("option",{key:t.id,value:t.nombre},k(t.nombre),9,Ee))),128))],512),[[E,s(e).condicion]]),i(v,{class:"mt-2",message:s(e).errors.condicion},null,8,["message"])]),a("div",qe,[i(m,{for:"barrio",value:"Barrio/Vereda"}),i(g,{id:"barrio",type:"text",class:"mt-1 block w-full",modelValue:s(e).barrio,"onUpdate:modelValue":o[14]||(o[14]=t=>s(e).barrio=t)},null,8,["modelValue"]),i(v,{class:"mt-2",message:s(e).errors.barrio},null,8,["message"])]),a("div",Ue,[i(m,{for:"direccion",value:"Dirección"}),i(g,{id:"direccion",type:"text",class:"mt-1 block w-full",modelValue:s(e).direccion,"onUpdate:modelValue":o[15]||(o[15]=t=>s(e).direccion=t),required:""},null,8,["modelValue"]),i(v,{class:"mt-2",message:s(e).errors.direccion},null,8,["message"])]),a("div",Ne,[a("div",Ce,[a("button",{type:"button",onClick:o[16]||(o[16]=t=>L(0)),class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white px-4 rounded-md shadow-xl"}," Atrás ")]),a("div",$e,[i(te,{type:"button",class:M(["h-full",{"opacity-25":s(e).processing}]),onClick:C,disabled:s(e).processing},{default:w(()=>o[24]||(o[24]=[R(" Siguiente ")])),_:1},8,["class","disabled"])])])])):j("",!0)])])]),_:1}),i(se,{show:n.loadingModal,closeable:!1},{default:w(()=>[o[26]||(o[26]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Cargando datos... ",-1)),a("div",Me,[i(s(ae),{"aria-label":"Loading"})])]),_:1},8,["show"])],64))}};export{Ae as default};
