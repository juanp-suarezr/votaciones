import{x as B,r as p,T as E,c as d,o as u,b as o,u as s,Z as L,d as b,e as a,t as N,j as w,B as S,p as h,n as k,F as T}from"./app-DRDJ0fvn.js";import{_ as q}from"./AuthenticatedLayout-Bno_8cbi.js";import{_ as f}from"./InputError-BkC4GRKc.js";import{_ as v}from"./InputLabel-D6bcT5e-.js";import{_ as P}from"./PrimaryButton-DejJUf7g.js";import{_}from"./TextInput-C9xxIRay.js";import{_ as X}from"./SecondaryLink-CaUUSSmW.js";import"./index-Cyxs0I2m.js";import"./index-Bm3N-oOO.js";import"./index-BRMkFFer.js";import"./SecondaryButtonReturn-BgAuTStD.js";import"./XCircleIcon--IWhoGgl.js";const Y={class:"px-4 mx-auto bg-white border shadow-sm rounded-xl mt-8"},G={class:"bg-gray-100 border-b rounded-t-xl py-3 px-4 md:py-4 md:px-5 flex justify-between items-center"},I={class:"text-gray-500"},J={class:"p-4 md:p-5"},O={class:"mb-2"},W={class:"mb-2"},Z={class:"mb-2"},H={key:0},K={key:0,class:"mb-2"},Q=["src"],ee={key:1},ae={class:"flex gap-4 mb-2"},te={key:0},oe={key:0,class:"mt-2"},se=["src"],le={key:1},re={key:0,class:"mt-2"},ie=["src"],ne={class:"mt-4 flex flex-col items-end"},we={__name:"Edit",props:{delegado:Object},setup(C){const D=B("$swal"),c=p("imagen"),m=p(null);let x=!1;const g=p(!1),n=C,F=[{url:route("delegados.index"),text:"Gestion de delegados"},{url:"",text:"editar Delegado "+n.delegado.nombre}],t=E({id:n.delegado.id,nombre:n.delegado.nombre||"",identificacion:n.delegado.identificacion||"",cargo:n.delegado.cargo||"",firma:null}),i=p(n.delegado.firma_url?n.delegado.firma_url:null),$=l=>{const e=l.target.files[0];if(t.firma=e,e){const r=new FileReader;r.onload=A=>{i.value=A.target.result},r.readAsDataURL(e)}else i.value=n.delegado.firma_url||null},j=l=>{x=!0;const e=m.value.getContext("2d");e.beginPath(),e.moveTo(l.offsetX,l.offsetY)},R=l=>{if(!x)return;const e=m.value.getContext("2d");e.lineTo(l.offsetX,l.offsetY),e.strokeStyle="#222",e.lineWidth=2,e.stroke()},V=()=>{x=!1},y=()=>{m.value.getContext("2d").clearRect(0,0,m.value.width,m.value.height),i.value=null,t.firma=null},M=()=>{m.value.toBlob(l=>{t.firma=new File([l],"firma.webp",{type:"image/webp"});const e=new FileReader;e.onload=r=>{i.value=r.target.result},e.readAsDataURL(t.firma)},"image/webp")},U=()=>{g.value=!1,c.value="imagen",i.value=n.delegado.firma_url||null,t.firma=null,y()},z=()=>{t.post(route("delegados.updateDelegados"),{forceFormData:!0,onSuccess:()=>{t.reset(),i.value=null,y(),g.value=!1,D({title:"Registro Actualizado",text:"El delegado se ha actualizado exitosamente",icon:"success"}).then(l=>{window.location.reload()})}})};return(l,e)=>(u(),d(T,null,[o(s(L),{title:"Agregar delegado"}),o(q,{breadCrumbLinks:F},{header:b(()=>e[6]||(e[6]=[w(" editar delegado/jurado")])),default:b(()=>[a("div",Y,[a("div",G,[a("h3",I," Editar delegado/jurado "+N(C.delegado.nombre),1),o(X,{href:l.route("delegados.index")},{default:b(()=>e[7]||(e[7]=[w(" Regresar ")])),_:1},8,["href"])]),a("div",J,[a("form",{onSubmit:S(z,["prevent"]),enctype:"multipart/form-data",class:"sm:grid sm:grid-cols-2 gap-4"},[a("div",O,[o(v,{for:"nombre",value:"Nombre(*)"}),o(_,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:s(t).nombre,"onUpdate:modelValue":e[0]||(e[0]=r=>s(t).nombre=r),required:"",autofocus:"",autocomplete:"off"},null,8,["modelValue"]),o(f,{class:"mt-2",message:s(t).errors.nombre},null,8,["message"])]),a("div",W,[o(v,{for:"identificacion",value:"IdentificaciÃ³n(*)"}),o(_,{id:"identificacion",type:"text",class:"mt-1 block w-full",modelValue:s(t).identificacion,"onUpdate:modelValue":e[1]||(e[1]=r=>s(t).identificacion=r),required:"",autofocus:"",autocomplete:"off"},null,8,["modelValue"]),o(f,{class:"mt-2",message:s(t).errors.identificacion},null,8,["message"])]),a("div",Z,[o(v,{for:"cargo",value:"Cargo"}),o(_,{id:"cargo",type:"text",class:"mt-1 block w-full",modelValue:s(t).cargo,"onUpdate:modelValue":e[2]||(e[2]=r=>s(t).cargo=r),required:"",autocomplete:"off"},null,8,["modelValue"]),o(f,{class:"mt-2",message:s(t).errors.cargo},null,8,["message"])]),a("div",null,[o(v,{for:"firma",value:"Firma"}),g.value?(u(),d("div",ee,[a("div",ae,[a("button",{type:"button",class:k(["px-2 py-1 rounded",c.value==="imagen"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[4]||(e[4]=r=>c.value="imagen")}," Cargar imagen ",2),a("button",{type:"button",class:k(["px-2 py-1 rounded",c.value==="canvas"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[5]||(e[5]=r=>c.value="canvas")}," Dibujar firma ",2),a("button",{type:"button",class:"px-2 py-1 rounded bg-red-500 text-white",onClick:U}," Cancelar ")]),c.value==="imagen"?(u(),d("div",te,[o(_,{id:"firma",type:"file",class:"mt-1 block w-full",accept:"image/*",onChange:$}),o(f,{class:"mt-2",message:s(t).errors.firma},null,8,["message"]),i.value?(u(),d("div",oe,[a("img",{src:i.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,se)])):h("",!0)])):(u(),d("div",le,[a("canvas",{ref_key:"canvas",ref:m,width:"200",height:"100",class:"border border-gray-400 rounded-md bg-white cursor-crosshair",onMousedown:j,onMousemove:R,onMouseup:V,onMouseleave:V},null,544),a("div",{class:"flex gap-2 mt-1"},[a("button",{type:"button",onClick:y,class:"text-xl text-blue-600 underline"}," Limpiar "),a("button",{type:"button",onClick:M,class:"text-xl text-green-600 underline"}," Usar firma ")]),o(f,{class:"mt-2",message:s(t).errors.firma},null,8,["message"]),i.value?(u(),d("div",re,[a("img",{src:i.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,ie)])):h("",!0)]))])):(u(),d("div",H,[i.value?(u(),d("div",K,[a("img",{src:i.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,Q)])):h("",!0),a("button",{type:"button",class:"px-3 py-1 rounded bg-blue-600 text-white",onClick:e[3]||(e[3]=r=>g.value=!0)}," Actualizar firma ")]))]),a("div",ne,[o(P,{class:k({"opacity-25":s(t).processing}),disabled:s(t).processing},{default:b(()=>e[8]||(e[8]=[w(" Editar Delegado/Jurado ")])),_:1},8,["class","disabled"])])],32)])])]),_:1})],64))}};export{we as default};
