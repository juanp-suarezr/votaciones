import{K as ie,T as ae,r as x,c as J,a as r,b as a,d as c,u as m,Z as re,e as d,f as t,m as p,j as n,t as l,g as de,v as ue,i as E,F as Q,h as ce}from"./app-D_x77aqt.js";import{_ as ve}from"./AuthenticatedLayout-NQkh2zZj.js";import{_ as $}from"./SecondaryButton-BVExwPGN.js";import{_ as F}from"./PrimaryButton-1Sa1Wzyv.js";import{c as me}from"./comunas-CgAZlVl9.js";import{N as fe}from"./vue-easy-lightbox.esm.min-D2S3vnUN.js";import{_ as S}from"./Modal-Cg_5Tpar.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const be={class:"p-4"},ge={class:"bg-white shadow-md rounded-lg p-6 mb-6"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={key:0},we={class:"bg-white shadow-md rounded-lg p-6 flex flex-wrap gap-8 items-start"},he={class:"flex-shrink-0 flex flex-col items-center"},ye=["src"],ke={key:1,class:"text-gray-400 italic"},Ce={class:"flex-shrink-0 flex flex-col items-center"},$e=["src"],De={key:1,class:"text-gray-400 italic"},Ne={class:"flex-shrink-0 flex flex-col items-center"},Re=["src"],je={key:1,class:"text-gray-400 italic"},ze={class:"flex-shrink-0 flex flex-col items-center"},Ee=["src"],Fe={key:1,class:"text-gray-400 italic"},Se={class:"bg-white shadow-md rounded-lg p-6 mt-6 flex flex-col md:flex-row gap-8 items-start"},qe={class:"w-auto"},Ae={class:""},Pe={key:0,class:""},Ie={class:"flex flex-col gap-2 w-full md:w-1/3"},Ve={class:"flex flex-col md:flex-row gap-4 mt-8 justify-center items-center h-full"},Be={class:"flex justify-between items-center bg-azul text-white px-4 py-4"},Le={class:"px-6 py-4"},Te=["src"],Me={class:"text-gray-800 font-medium"},Ue={class:"text-gray-800 font-medium"},Ge={class:"text-gray-800 font-medium"},He={class:"text-gray-800 font-medium"},Oe={class:"text-gray-800 font-medium"},Ke={class:"flex justify-end items-center gap-2 mt-6"},Xe=["disabled"],Ye=["disabled"],Ze={class:"flex justify-center items-center h-full w-full"},Je={class:"text-center tex-base w-full"},Qe={class:"flex justify-center gap-4 my-4 h-full"},We={class:"flex justify-center items-center h-full w-full"},_e={class:"text-center tex-base w-full"},et={class:"flex justify-center gap-4 my-4 h-full"},q=5,dt={__name:"ShowHistorial",props:{votante:{type:Object,required:!0},duplicados:{type:Object}},setup(o){const f=ie("$swal"),w=o;console.log(w);const v=ae({id:w.votante.id,motivo:""}),A=x(""),D=x(!1),N=x(!1),R=x(!1),j=x(!1),b=x(1),P=J(()=>Math.ceil(w.duplicados.length/q)),W=J(()=>{const i=(b.value-1)*q;return w.duplicados.slice(i,i+q)}),h=i=>{A.value=i,D.value=!0},_=()=>{D.value=!1},ee=i=>{const e=new Date(i),g=e.getFullYear(),k=String(e.getMonth()+1).padStart(2,"0"),C=String(e.getDate()).padStart(2,"0");return`${g}-${k}-${C}`},te=[{url:route("gestion_registros.index"),text:"Gestion de registros"},{url:"",text:"Detalle registro"}],z=i=>`/storage/uploads/fotos/${i}`,y=i=>`/storage/uploads/documentos/${i}`,I=i=>`/storage/uploads/firmas/${i}`,oe=i=>{var e;return console.log(i),(e=me.find(g=>g.value==i))==null?void 0:e.label},se=()=>{v.post(route("aprobarRegistro"),{onSuccess:function(){f({title:"Registro Aprobado",text:"El registro ha sido aprobado exitosamente",icon:"success"}).then(()=>{window.location.href=route("gestion_registros.index")})},onError:function(){f({title:"Error al aprobar registro",text:"Error al intentar aprobar este registro, por favor vuelve a intentar",icon:"error"})}})},ne=()=>{v.post(route("rechazarRegistro"),{onSuccess:function(){f({title:"Registro Rechazado",text:"El registro ha sido rechazado exitosamente",icon:"success"}).then(()=>{window.location.href=route("gestion_registros.index")})},onError:function(){f({title:"Error al rechazar registro",text:"Error al intentar rechazar este registro, por favor vuelve a intentar",icon:"error"})}})},le=()=>{v.post(route("desbloquearRegistro"),{onSuccess:function(){f({title:"Registro Desbloqueado",text:"El registro ha sido desbloqueado exitosamente",icon:"success"}).then(()=>{window.location.href=route("gestion_registros.index")})},onError:function(){f({title:"Error al desbloquear registro",text:"Error al intentar desbloquear este registro, por favor vuelve a intentar",icon:"error"})}})};return(i,e)=>(a(),r(Q,null,[c(m(re),{title:"Revisión del votante"}),c(ve,{breadCrumbLinks:te},{header:d(()=>e[13]||(e[13]=[t("div",{class:"flex justify-between items-center"},[t("h1",{class:"text-2xl font-bold"},"Detalle del Registro")],-1)])),default:d(()=>{var g,k,C,V,B,L,T,M,U,G,H,O,K,X,Y,Z;return[t("div",be,[t("div",ge,[e[25]||(e[25]=t("h2",{class:"text-lg font-bold mb-4 text-blue-900"},"Datos del votante",-1)),t("div",xe,[t("div",null,[e[14]||(e[14]=t("b",null,"Nombre:",-1)),n(" "+l(((g=o.votante.votante)==null?void 0:g.nombre)||"Sin información"),1)]),t("div",null,[e[15]||(e[15]=t("b",null,"Tipo de documento:",-1)),n(" "+l(((k=o.votante.votante)==null?void 0:k.tipo_documento)||"N/A"),1)]),t("div",null,[e[16]||(e[16]=t("b",null,"Número de documento:",-1)),n(" "+l(((C=o.votante.votante)==null?void 0:C.identificacion)||"N/A"),1)]),t("div",null,[e[17]||(e[17]=t("b",null,"Fecha expedición documento:",-1)),n(" "+l(((V=o.votante.votante)==null?void 0:V.fecha_expedicion)||"N/A"),1)]),t("div",null,[e[18]||(e[18]=t("b",null,"Fecha de nacimiento:",-1)),n(" "+l(((B=o.votante.votante)==null?void 0:B.nacimiento)||"N/A"),1)]),t("div",null,[e[19]||(e[19]=t("b",null,"Genero:",-1)),n(" "+l(((L=o.votante.votante)==null?void 0:L.genero)||"N/A"),1)]),t("div",null,[e[20]||(e[20]=t("b",null,"Comuna:",-1)),n(" "+l(oe(o.votante.subtipo)||"N/A"),1)]),t("div",null,[e[21]||(e[21]=t("b",null,"Barrio:",-1)),n(" "+l(((T=o.votante.votante)==null?void 0:T.barrio)||"N/A"),1)]),t("div",null,[e[22]||(e[22]=t("b",null,"Dirección:",-1)),n(" "+l(((M=o.votante.votante)==null?void 0:M.direccion)||"N/A"),1)]),o.votante.intentos>0?(a(),r("div",pe,[e[23]||(e[23]=t("b",null,"motivo rechazo:",-1)),n(" "+l(o.votante.motivo||"N/A"),1)])):p("",!0),t("div",null,[e[24]||(e[24]=t("b",null,"Estado:",-1)),n(" "+l(o.votante.estado||"N/A"),1)])])]),t("div",we,[t("div",he,[e[26]||(e[26]=t("h2",null,"Fotografía",-1)),(U=o.votante.votante)!=null&&U.user.biometrico?(a(),r("img",{key:0,src:z((G=o.votante.votante)==null?void 0:G.user.biometrico.photo),alt:"Foto del votante",onClick:e[0]||(e[0]=s=>{var u;return h(z((u=o.votante.votante)==null?void 0:u.user.biometrico.photo))}),class:"w-64 h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,ye)):(a(),r("span",ke,"Sin foto"))]),t("div",Ce,[e[27]||(e[27]=t("h2",null,"frontal",-1)),(H=o.votante.votante)!=null&&H.user.biometrico?(a(),r("img",{key:0,src:y((O=o.votante.votante)==null?void 0:O.user.biometrico.cedula_front),alt:"Foto del votante",onClick:e[1]||(e[1]=s=>{var u;return h(y((u=o.votante.votante)==null?void 0:u.user.biometrico.cedula_front))}),class:"w-full h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,$e)):(a(),r("span",De,"Sin foto"))]),t("div",Ne,[e[28]||(e[28]=t("h2",null,"Posterior",-1)),(K=o.votante.votante)!=null&&K.user.biometrico?(a(),r("img",{key:0,src:y((X=o.votante.votante)==null?void 0:X.user.biometrico.cedula_back),alt:"Foto del votante",onClick:e[2]||(e[2]=s=>{var u;return h(y((u=o.votante.votante)==null?void 0:u.user.biometrico.cedula_back))}),class:"w-full h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,Re)):(a(),r("span",je,"Sin foto"))]),t("div",ze,[e[29]||(e[29]=t("h2",null,"Firma",-1)),(Y=o.votante.votante)!=null&&Y.user.biometrico?(a(),r("img",{key:0,src:I((Z=o.votante.votante)==null?void 0:Z.user.biometrico.firma),alt:"Foto del votante",onClick:e[3]||(e[3]=s=>{var u;return h(I((u=o.votante.votante)==null?void 0:u.user.biometrico.firma))}),class:"w-full h-64 cursor-pointer object-cover rounded-lg border shadow"},null,8,Ee)):(a(),r("span",Fe,"Sin foto"))])]),t("div",Se,[t("div",qe,[t("div",Ae,[e[30]||(e[30]=t("b",null,"Validación:",-1)),n(" "+l(o.votante.validaciones),1)]),o.duplicados.length>0?(a(),r("div",Pe,[t("button",{onClick:e[4]||(e[4]=s=>N.value=!0),class:"bg-secondary text-white hover:scale-105 hover:bg-primary p-2 cursor-pointer rounded-md mt-2"}," Ver duplicados ")])):p("",!0)]),t("div",Ie,[e[32]||(e[32]=t("b",null,"Motivo de rechazo:",-1)),de(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>m(v).motivo=s),class:"border rounded p-2"},e[31]||(e[31]=[t("option",{value:"",disabled:""},"Seleccione un motivo",-1),t("option",{value:"aprobado"},"No hay motivos (aprobado)",-1),t("option",{value:"Documentos incorrectos"}," Documentos incorrectos ",-1),t("option",{value:"Identidad no validada"},"Identidad no validada",-1),t("option",{value:"Parte frontal del documento poco visible"}," Parte frontal del documento poco visible ",-1),t("option",{value:"Parte Trasera del documento poco visible"}," Parte Trasera del documento poco visible ",-1),t("option",{value:"Firma poco visible"},"Firma poco visible",-1),t("option",{value:"Firma diferente a la presentada en el documento de identificación"}," Firma diferente a la presentada en el documento de identificación ",-1),t("option",{value:"Registro duplicado"},"Registro duplicado",-1),t("option",{value:"Información errónea, en comparación con la documentación"}," Información errónea, en comparación con la documentación ",-1),t("option",{value:"Dirección diferente a la comuna"}," Dirección diferente a la comuna ",-1)]),512),[[ue,m(v).motivo]])])]),t("div",Ve,[o.votante.estado==="Rechazado"?(a(),E(F,{key:0,onClick:se,class:"flex h-full items-center",disabled:m(v).processing},{default:d(()=>e[33]||(e[33]=[n(" Aprobar ")])),_:1},8,["disabled"])):p("",!0),o.votante.estado==="Activo"?(a(),E($,{key:1,onClick:e[6]||(e[6]=s=>R.value=!0),class:"!bg-red-500 text-white",disabled:m(v).processing},{default:d(()=>e[34]||(e[34]=[n(" Rechazar ")])),_:1},8,["disabled"])):p("",!0),o.votante.estado==="Bloqueado"?(a(),E($,{key:2,onClick:e[7]||(e[7]=s=>j.value=!0),class:"!bg-yellow-500 text-white",disabled:m(v).processing},{default:d(()=>e[35]||(e[35]=[n(" Desbloquear ")])),_:1},8,["disabled"])):p("",!0)]),c(m(fe),{visible:D.value,imgs:[A.value],onHide:_},null,8,["visible","imgs"])]),c(S,{show:N.value,closeable:!0},{default:d(()=>[t("div",Be,[e[36]||(e[36]=t("h2",{class:"text-2xl font-semibold text-center"}," Registros duplicados o similares ",-1)),t("button",{onClick:e[8]||(e[8]=s=>N.value=!1),class:"text-white text-xl hover:text-gray-300"}," X ")]),t("div",Le,[(a(!0),r(Q,null,ce(W.value,s=>(a(),r("div",{key:s.id,class:"flex gap-4 items-center mb-4 border-b pb-2"},[t("img",{src:z(s.photo),alt:"Foto",class:"w-36 h-full object-cover rounded"},null,8,Te),t("div",null,[t("p",Me," ID: "+l(s.user.votantes.hash_votantes[0].id),1),t("p",Ue," Nombre: "+l(s.user.votantes.nombre),1),t("p",Ge," Identificación: "+l(s.user.votantes.identificacion),1),t("p",He," Creación: "+l(ee(s.user.votantes.hash_votantes[0].created_at)),1),t("p",Oe,"Estado: "+l(s.estado),1)])]))),128)),t("div",Ke,[t("button",{class:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",disabled:b.value===1,onClick:e[9]||(e[9]=s=>b.value--)}," Anterior ",8,Xe),t("span",null,"Página "+l(b.value)+" de "+l(P.value),1),t("button",{class:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",disabled:b.value===P.value,onClick:e[10]||(e[10]=s=>b.value++)}," Siguiente ",8,Ye)])])]),_:1},8,["show"]),c(S,{show:R.value,closeable:!0},{default:d(()=>[t("div",Ze,[t("div",Je,[e[39]||(e[39]=t("div",{class:"bg-azul text-white p-2 shadow-lg w-full mb-4"},[t("h2",{class:"text-2xl font-semibold"},"Confirmar Rechazo")],-1)),e[40]||(e[40]=t("p",{class:"mb-4"}," ¿Estás seguro de que deseas rechazar este registro? ",-1)),t("div",Qe,[c(F,{onClick:ne,class:"!bg-red-500 text-white"},{default:d(()=>e[37]||(e[37]=[n(" Confirmar ")])),_:1}),c($,{onClick:e[11]||(e[11]=s=>R.value=!1),class:"!bg-gray-300 text-black"},{default:d(()=>e[38]||(e[38]=[n(" Cancelar ")])),_:1})])])])]),_:1},8,["show"]),c(S,{show:j.value,closeable:!0},{default:d(()=>[t("div",We,[t("div",_e,[e[43]||(e[43]=t("div",{class:"bg-azul text-white p-2 shadow-lg w-full mb-4"},[t("h2",{class:"text-2xl font-semibold"},"Confirmar desbloqueo")],-1)),e[44]||(e[44]=t("p",{class:"mb-4"}," ¿Estás seguro de que deseas desbloquear al usuario? una vez desbloqueado, podrá volver a corregir los datos. ",-1)),t("div",et,[c(F,{onClick:le,class:"!bg-red-500 text-white"},{default:d(()=>e[41]||(e[41]=[n(" Confirmar ")])),_:1}),c($,{onClick:e[12]||(e[12]=s=>j.value=!1),class:"!bg-gray-300 text-black"},{default:d(()=>e[42]||(e[42]=[n(" Cancelar ")])),_:1})])])])]),_:1},8,["show"])]}),_:1})],64))}};export{dt as default};
