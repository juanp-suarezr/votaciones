import{r as f,T as N,c as d,o as u,b as s,u as n,Z as U,d as p,e as a,t as A,j as x,B as E,p as y,n as h,F as S}from"./app-CZn9_tnf.js";import{_ as T}from"./AuthenticatedLayout-CKj5-3Cz.js";import{_ as b}from"./InputError-BAnndKr6.js";import{_ as w}from"./InputLabel-CVS2Zmiv.js";import{_ as z}from"./PrimaryButton-DlhZmUAS.js";import{_ as k}from"./TextInput-BeYUlZgz.js";import{_ as q}from"./SecondaryLink-D97Gr2w-.js";import"./index-6HpFMqxr.js";import"./index-Dc5DCL10.js";import"./index-PBMrBXVL.js";import"./SecondaryButtonReturn-Dry5sVkw.js";import"./XCircleIcon-BkJdZri6.js";const P={class:"px-4 mx-auto bg-white border shadow-sm rounded-xl mt-8"},X={class:"bg-gray-100 border-b rounded-t-xl py-3 px-4 md:py-4 md:px-5 flex justify-between items-center"},Y={class:"text-gray-500"},G={class:"p-4 md:p-5"},J={class:"mb-2"},O={class:"mb-2"},W={key:0},Z={key:0,class:"mb-2"},H=["src"],I={key:1},K={class:"flex gap-4 mb-2"},Q={key:0},ee={key:0,class:"mt-2"},ae=["src"],te={key:1},se={key:0,class:"mt-2"},oe=["src"],re={class:"mt-4 flex flex-col items-end"},_e={__name:"Edit",props:{delegado:Object},setup(C){const c=f("imagen"),m=f(null);let v=!1;const g=f(!1),i=C,D=[{url:route("delegados.index"),text:"Gestion de delegados"},{url:"",text:"editar Delegado "+i.delegado.nombre}],t=N({id:i.delegado.id,nombre:i.delegado.nombre||"",cargo:i.delegado.cargo||"",firma:null}),o=f(i.delegado.firma_url?i.delegado.firma_url:null),F=r=>{const e=r.target.files[0];if(t.firma=e,e){const l=new FileReader;l.onload=L=>{o.value=L.target.result},l.readAsDataURL(e)}else o.value=i.delegado.firma_url||null},$=r=>{v=!0;const e=m.value.getContext("2d");e.beginPath(),e.moveTo(r.offsetX,r.offsetY)},j=r=>{if(!v)return;const e=m.value.getContext("2d");e.lineTo(r.offsetX,r.offsetY),e.strokeStyle="#222",e.lineWidth=2,e.stroke()},V=()=>{v=!1},_=()=>{m.value.getContext("2d").clearRect(0,0,m.value.width,m.value.height),o.value=null,t.firma=null},M=()=>{m.value.toBlob(r=>{t.firma=new File([r],"firma.webp",{type:"image/webp"});const e=new FileReader;e.onload=l=>{o.value=l.target.result},e.readAsDataURL(t.firma)},"image/webp")},R=()=>{g.value=!1,c.value="imagen",o.value=i.delegado.firma_url||null,t.firma=null,_()},B=()=>{t.post(route("delegados.updateDelegados"),{forceFormData:!0,onSuccess:()=>{t.reset(),o.value=null,_(),g.value=!1}})};return(r,e)=>(u(),d(S,null,[s(n(U),{title:"Agregar delegado"}),s(T,{breadCrumbLinks:D},{header:p(()=>e[5]||(e[5]=[x(" editar delegado/jurado")])),default:p(()=>[a("div",P,[a("div",X,[a("h3",Y," Editar delegado/jurado "+A(C.delegado.nombre),1),s(q,{href:r.route("delegados.index")},{default:p(()=>e[6]||(e[6]=[x(" Regresar ")])),_:1},8,["href"])]),a("div",G,[a("form",{onSubmit:E(B,["prevent"]),enctype:"multipart/form-data",class:"sm:grid sm:grid-cols-2 gap-4"},[a("div",J,[s(w,{for:"nombre",value:"Nombre(*)"}),s(k,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:n(t).nombre,"onUpdate:modelValue":e[0]||(e[0]=l=>n(t).nombre=l),required:"",autofocus:"",autocomplete:"off"},null,8,["modelValue"]),s(b,{class:"mt-2",message:n(t).errors.nombre},null,8,["message"])]),a("div",O,[s(w,{for:"cargo",value:"Cargo"}),s(k,{id:"cargo",type:"text",class:"mt-1 block w-full",modelValue:n(t).cargo,"onUpdate:modelValue":e[1]||(e[1]=l=>n(t).cargo=l),required:"",autocomplete:"off"},null,8,["modelValue"]),s(b,{class:"mt-2",message:n(t).errors.cargo},null,8,["message"])]),a("div",null,[s(w,{for:"firma",value:"Firma"}),g.value?(u(),d("div",I,[a("div",K,[a("button",{type:"button",class:h(["px-2 py-1 rounded",c.value==="imagen"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[3]||(e[3]=l=>c.value="imagen")}," Cargar imagen ",2),a("button",{type:"button",class:h(["px-2 py-1 rounded",c.value==="canvas"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[4]||(e[4]=l=>c.value="canvas")}," Dibujar firma ",2),a("button",{type:"button",class:"px-2 py-1 rounded bg-red-500 text-white",onClick:R}," Cancelar ")]),c.value==="imagen"?(u(),d("div",Q,[s(k,{id:"firma",type:"file",class:"mt-1 block w-full",accept:"image/*",onChange:F}),s(b,{class:"mt-2",message:n(t).errors.firma},null,8,["message"]),o.value?(u(),d("div",ee,[a("img",{src:o.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,ae)])):y("",!0)])):(u(),d("div",te,[a("canvas",{ref_key:"canvas",ref:m,width:"200",height:"100",class:"border border-gray-400 rounded-md bg-white cursor-crosshair",onMousedown:$,onMousemove:j,onMouseup:V,onMouseleave:V},null,544),a("div",{class:"flex gap-2 mt-1"},[a("button",{type:"button",onClick:_,class:"text-xl text-blue-600 underline"}," Limpiar "),a("button",{type:"button",onClick:M,class:"text-xl text-green-600 underline"}," Usar firma ")]),s(b,{class:"mt-2",message:n(t).errors.firma},null,8,["message"]),o.value?(u(),d("div",se,[a("img",{src:o.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,oe)])):y("",!0)]))])):(u(),d("div",W,[o.value?(u(),d("div",Z,[a("img",{src:o.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,H)])):y("",!0),a("button",{type:"button",class:"px-3 py-1 rounded bg-blue-600 text-white",onClick:e[2]||(e[2]=l=>g.value=!0)}," Actualizar firma ")]))]),a("div",re,[s(z,{class:h({"opacity-25":n(t).processing}),disabled:n(t).processing},{default:p(()=>e[7]||(e[7]=[x(" Editar Delegado/Jurado ")])),_:1},8,["class","disabled"])])],32)])])]),_:1})],64))}};export{_e as default};
