import{k as Ge,T as We,r as l,w as J,o as He,a as d,b as c,d as r,u as i,Z as Xe,e as y,f as a,l as z,g as j,F as W,h as K,t as $,v as Q,B as ne,z as Ve,j as F,n as T,i as Ze,x as je,q as Ee}from"./app-DAhbyamU.js";import{_ as Je}from"./AuthenticatedLayout-YH14k7JQ.js";import{c as Se}from"./comunas-DN-PCrTT.js";import{b as Ke,s as De,t as Qe,e as et,c as tt}from"./etnia-B-bNWiML.js";import{_ as v}from"./InputError-gX5CUp-C.js";import{_ as x}from"./InputLabel-CSrztOtg.js";import{_ as ee}from"./PrimaryButton-CAN_zjMk.js";import{_ as ot}from"./SecondaryButton-S7MN0RcL.js";import{_ as te}from"./Modal-DkgEx5O8.js";import{_ as I}from"./TextInput-CRhTYVH-.js";import{s as Ue}from"./index-BtzDlBEs.js";import{s as at}from"./index-nVCrECM-.js";import{f as st}from"./cedulaFrontEjemplo-eqgE4YJW.js";import{n as ce,d as it,T as rt}from"./FaceMatcher-DQZ88WER.js";import{r as lt}from"./PhotoIcon-B2ljFVvv.js";import"./index-DVwqVDxq.js";import"./index-DHeH8QKb.js";import"./index-D0jyr8Dc.js";import"./SecondaryButtonReturn-JpluEbrQ.js";import"./XCircleIcon-BFu2w50f.js";import"./index-lsG1lBLU.js";import"./index-DaaVktr2.js";import"./index-BmRnHCCS.js";import"./index-BPn5rCNH.js";const nt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ct={class:"mt-4 justify-center"},dt={class:"m-auto py-4 px-4"},ut={key:0,class:"sm:grid sm:grid-cols-2 gap-6 h-full"},mt={class:"mb-2"},vt={class:"mb-2"},ft={class:"mb-2"},pt=["value"],gt={class:"mb-2"},bt={key:0,class:"text-red-500"},xt={class:"col-span-2 flex justify-end"},ht={key:1,class:"sm:grid sm:grid-cols-2 gap-6"},yt={class:"mb-2"},wt={class:"mt-2 block sm:flex"},_t={class:""},kt={class:"sm:ms-6"},Ct={key:0,class:"sm:ms-6"},Vt={key:1,class:"sm:ms-6"},jt={class:"mb-2"},Et=["value"],St={class:"mb-2"},Dt=["value"],Ut={class:"mb-2"},qt={class:"mb-2"},Bt={class:"mb-2"},Ft={class:"my-4 col-span-2 mb-2"},It={class:"mb-4 col-span-2 mb-2"},Mt={class:"col-span-2 flex justify-between gap-2"},zt={class:"flex pt-4 justify-end"},$t={class:"flex pt-4 justify-end h-full"},Tt={key:2,class:"gap-6"},Rt={class:"sm:grid sm:grid-cols-2 gap-2 h-full sm:px-16 px-4"},Lt={class:"w-full h-full mt-4"},Ot={class:"w-full"},Nt=["src"],Pt={class:"mb-2 h-full flex justify-center items-center mt-4"},At={class:"border-2 border-gray-300 rounded-md p-2 h-full"},Yt={class:"flex justify-center"},Gt=["src","alt"],Wt={key:0,class:"flex justify-center mt-2"},Ht={class:"w-full gap-2 h-full sm:px-16 px-4 mt-4"},Xt={class:"flex gap-4 mb-2"},Zt={key:0},Jt={key:0,class:"mt-2"},Kt=["src"],Qt={key:1},eo={key:0,class:"mt-2"},to=["src"],oo={class:"w-full"},ao={class:"col-span-2 flex justify-between gap-2 mt-4"},so={class:"flex pt-4 justify-end"},io={class:"flex pt-4 justify-end"},ro={class:"flex justify-center my-12"},lo={class:"flex justify-center gap-4 text-center h-full my-12"},no={class:"my-12 px-4"},co=["value"],uo=["disabled"],mo={class:"text-justify sm:text-2xl text-xl p-6 mt-6"},vo={class:"flex justify-center gap-4 text-center h-full my-6"},To={__name:"CorregirDatos",props:{votante:{type:Object,required:!0}},setup(de){const w=Ge("$swal"),qe=[{url:"",text:"Corregir datos"}],n=de;console.log("Votante data:",n.votante);const t=We({id_votante:n.votante.id||"",nombre:n.votante.nombre||"",identificacion:n.votante.identificacion||"",tipo_documento:n.votante.tipo_documento||"",nacimiento:n.votante.nacimiento||"",cedula_front:null,genero:n.votante.genero||"",etnia:n.votante.etnia||"",condicion:n.votante.condicion||"",direccion:n.votante.direccion||"",comuna:n.votante.hash_votantes[0].subtipo||"",barrio:n.votante.barrio||"",embedding:n.votante.user.biometrico.embedding||"",photo:null,validaciones:n.votante.hash_votantes[0].validaciones||"",checked:!0,declaracion:!0,firma:null,campoObligatorio:""}),oe=l(""),ae=l([]),k=l(null),N=l("imagen"),E=l(null);let se=!1;const C=l(!1),ie=l(!0),Be=l([{label:"Información Personal"},{label:"Datos Demográficos"},{label:"Registro datos"}]),Fe=l([{label:"paso 1"},{label:"paso 2"},{label:"paso 3"}]),b=l(0),R=l(""),P=l(""),f=l(!1),V=l(!1),H=l(!1),L=l(!1),S=l(null),X=l([]),A=l(""),h=l(null),_=l(""),ue=l(!1),D=l(!1),O=l(0),Ie=(s,e)=>t.cedula_front===null?`/storage/uploads/documentos/${s}`:s,Me=s=>t.firma===null?`/storage/uploads/firmas/${s}`:s;J(H,s=>{s&&(t.genero="")}),J(oe,s=>{s&&(t.comuna=s,ae.value=Ke.find(e=>e.id===parseInt(s.value)).barrios,console.log(ae.value))});const me=(s,e)=>{const o=e.target.files[0];if(!o)return;((p,Y)=>{const Z=new FileReader;Z.onload=le=>{const U=new Image;U.onload=()=>{const m=document.createElement("canvas"),M=m.getContext("2d"),q=1024,G=1024;let g=U.width,B=U.height;(g>q||B>G)&&(g>B?(B=Math.round(B*q/g),g=q):(g=Math.round(g*G/B),B=G)),m.width=g,m.height=B,M.drawImage(U,0,0,g,B),m.toBlob(ke=>{if(ke.size>2e6){Swal.fire({icon:"error",title:"Error",text:"Incluso comprimida, la imagen supera los 2MB."});return}const Ce=new File([ke],p.name,{type:"image/jpeg",lastModified:Date.now()});Y(Ce,URL.createObjectURL(Ce))},"image/jpeg",.8)},U.src=le.target.result},Z.readAsDataURL(p)})(o,(p,Y)=>{t[s]=p,s==="cedula_front"?S.value=Y:s==="firma"&&(k.value=Y)})},ze=s=>{t.cedula_front=null,S.value=null},ve=s=>{if(!s)return"";const e=new Date(s),o=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),p=String(e.getDate()).padStart(2,"0");return`${o}-${u}-${p}`},fe=s=>{se=!0;const e=E.value.getContext("2d"),o=ge(s);e.beginPath(),e.moveTo(o.x,o.y)},pe=s=>{if(!se)return;const e=E.value.getContext("2d"),o=ge(s);e.lineTo(o.x,o.y),e.strokeStyle="#222",e.lineWidth=2,e.stroke()},re=()=>{se=!1},$e=()=>{E.value.getContext("2d").clearRect(0,0,E.value.width,E.value.height),k.value=null,t.firma=null},Te=()=>{E.value.toBlob(s=>{t.firma=new File([s],"firma.webp",{type:"image/webp"});const e=new FileReader;e.onload=o=>{k.value=o.target.result},e.readAsDataURL(t.firma)},"image/webp")},ge=s=>{const e=E.value.getBoundingClientRect();return s.touches&&s.touches.length>0?{x:s.touches[0].clientX-e.left,y:s.touches[0].clientY-e.top}:{x:s.offsetX,y:s.offsetY}},be=s=>{b.value=s,f.value=!0},xe=async()=>{C.value=!0;try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(u=>u.stop()),await ce.tinyFaceDetector.loadFromUri("/models/tiny_face_detector"),await ce.faceRecognitionNet.loadFromUri("/models/face_recognition"),await ce.faceLandmark68Net.loadFromUri("/models/face_landmark_68");const e=await navigator.mediaDevices.enumerateDevices();X.value=e.filter(u=>u.kind==="videoinput");const o=X.value.find(u=>u.label.toLowerCase().includes("user"))||X.value[0];console.log(o),A.value=(o==null?void 0:o.deviceId)||"",C.value=!1,V.value=!0,await we(A.value)}catch(s){C.value=!1,O.value==3,console.error("Error al iniciar:",s),_.value="No se pudo acceder a la cámara."}},Re=async()=>{_.value="",D.value=!0;const s=o=>parseInt(sessionStorage.getItem(o)||"0"),e=(o,u)=>sessionStorage.setItem(o,u.toString());if(!ue.value){s("fallo_camara")+1,_.value="La cámara no está lista.",D.value=!1;return}try{const o=await it(h.value,new rt).withFaceLandmarks().withFaceDescriptor();if(console.log("entro -- validador"),!o){D.value=!1,_.value="No se detectó un rostro.",O.value+=1;const m=document.createElement("canvas");m.width=h.value.videoWidth,m.height=h.value.videoHeight,m.getContext("2d").drawImage(h.value,0,0,m.width,m.height);const q=await new Promise(g=>m.toBlob(g,"image/jpeg")),G=new File([q],"photo.jpg",{type:"image/jpeg"});t.photo=G,O.value==3&&w.fire({title:"Error en validación",text:"Error, no se detectó un rostro, vuelve a intentar o avanzar con la imagen poco visible y posiblemente sin registro biométrico (alta probabilidad de rechazo)",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(g=>{g.isConfirmed?(t.embedding="",t.validaciones="no_rostro",V.value=!1,L.value=!0):g.dismiss===Swal.DismissReason.cancel&&(console.log("Usuario decide volver a intentar"),_.value="",O.value=0)});return}const u=o.descriptor;t.embedding=u,console.log("emb",u);const p=document.createElement("canvas");p.width=h.value.videoWidth,p.height=h.value.videoHeight,p.getContext("2d").drawImage(h.value,0,0,p.width,p.height);const Z=await new Promise(m=>p.toBlob(m,"image/jpeg")),le=new File([Z],"photo.jpg",{type:"image/jpeg"});t.photo=le;const U=new FormData;U.append("embedding",u),D.value=!1,V.value=!1,C.value=!0,Ee.post(route("face-validate"),U,{headers:{"Content-Type":"multipart/form-data"}}).then(m=>{_.value=m.data.message,console.log(m),D.value=!1,C.value=!1,m.data.match?w.fire({title:"Error en validación",text:"Usted ya tiene un registro biométrico. Si está seguro que no se ha registrado, puede volver a intentarlo o continuar (probabilidad de rechazo).",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(M=>{M.isConfirmed?(t.validaciones="registro_duplicado",V.value=!1,L.value=!0):M.dismiss===w.DismissReason.cancel&&console.log("Usuario decide volver a intentar")}):w({title:"Validación exitosa",text:"Validación biométrica exitosa",icon:"success",didClose:()=>{V.value=!1,C.value=!0,ye()}})}).catch(m=>{D.value=!1,C.value=!1,console.log(m);const M=s("fallo_registro")+1;e("fallo_registro",M),w.fire({title:"Error en validación",text:"Error en la validación, vuelve a intentar o avanzar sin registro biometrico (posibilidad de rechazo)",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(q=>{q.isConfirmed?(t.embedding="",t.validaciones="fallo_registro_biometrico",V.value=!1,L.value=!0):q.dismiss===w.DismissReason.cancel&&console.log("Usuario decide volver a intentar")})})}catch(o){console.error(o),D.value=!1,C.value=!1,O.value==3&&w.fire({title:"Error en validación",text:"Error al procesar el rostro, vuelve a intentar o avanzar sin registro biometrico (posibilidad de rechazo)",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(u=>{u.isConfirmed?(t.embedding="",t.validaciones="fallo_registro",V.value=!1,L.value=!0):u.dismiss===w.DismissReason.cancel&&(console.log("Usuario decide volver a intentar"),_.value="",O.value=0)}),_.value="Error al procesar el rostro."}},Le=()=>{if(!t.nacimiento)return P.value="Debes ingresar la fecha de nacimiento.",!1;const s=new Date,e=new Date(t.nacimiento);let o=s.getFullYear()-e.getFullYear();const u=s.getMonth()-e.getMonth();return(u<0||u===0&&s.getDate()<e.getDate())&&o--,o<14?(P.value="No cumple con el requisito de edad mínima (14 años), por lo tanto, no puede ejercer el derecho al voto.",!1):(P.value="",!0)},Oe=async()=>{if(f.value=!1,t.nombre&&t.identificacion&&t.tipo_documento&&t.nacimiento){if(!Le())return;R.value="";try{const s=await Ne(t.identificacion);console.log("Identificación existe:",s),s?(R.value="El número de cédula ingresado ya se encuentra registrado en el sistema. /n Por favor, continúe con el proceso de votación ingresando a la plataforma con su número de documento y la contraseña que registró previamente.",f.value=!1):(R.value="",f.value=!0)}catch{R.value="Error al validar la identificación. Intenta de nuevo.",f.value=!1}}f.value?b.value=1:(t.nombre||(t.errors.nombre="Este campo es requerido."),(!t.identificacion||R.value!="")&&(t.errors.identificacion=R.value||"Este campo es requerido."),t.tipo_documento||(t.errors.tipo_documento="Este campo es requerido."),t.fecha_expedicion||(t.errors.fecha_expedicion="Este campo es requerido."),t.lugar_expedicion||(t.errors.lugar_expedicion="Este campo es requerido."),t.nacimiento||(t.errors.nacimiento="Este campo es requerido."))},Ne=async s=>(await Ee.post("/validar-identificacion",{identificacion:s})).data.existe,Pe=s=>{switch(f.value=!1,s){case 1:Oe();break;case 2:he();break}f.value&&(b.value=s)},he=()=>{f.value=!1,t.genero&&t.etnia&&t.condicion&&t.comuna&&t.barrio&&t.direccion&&t.checked&&t.declaracion&&(f.value=!0,b.value=2),f.value||(t.genero||(t.errors.genero="Este campo es requerido."),t.etnia||(t.errors.etnia="Este campo es requerido."),t.condicion||(t.errors.condicion="Este campo es requerido."),t.comuna||(t.errors.comuna="Este campo es requerido."),t.barrio||(t.errors.barrio="Este campo es requerido."),t.direccion||(t.errors.direccion="Este campo es requerido."),t.checked||(t.errors.checked="Este campo es requerido."),t.declaracion||(t.errors.declaracion="Este campo es requerido."))},Ae=()=>{f.value=!1,console.log("Validando datos del paso 3",S.value),(t.cedula_front||S)&&(t.firma||k)&&(console.log("Datos del paso 3 son válidos"),f.value=!0),f.value?t.embedding&&n.votante.hash_votantes[0].validaciones!="no_rostro"?L.value=!0:xe():(t.cedula_front||(t.errors.cedula_front="Este campo es requerido."),t.firma||(t.errors.firma='Debe hacer clic en "Usar firma" para continuar'))},ye=()=>{t.post(route("corregirDatos"),{onSuccess:()=>{w({title:"Registro actualizado",text:"Registro de usuario actualizado exitosamente. Se realizará la validación de su información, el estado sera notificado a su correo.",icon:"success"}).then(s=>{window.location.href=route("dashboard")}),sessionStorage.removeItem("fallo_camara"),sessionStorage.removeItem("fallo_registro"),sessionStorage.removeItem("registro_duplicado"),t.reset(),_e()},onError:s=>{w({title:"Error",text:"Ocurrió un error al registrar el usuario.",icon:"error"}).then(e=>{b.value=0}),console.error(s)}})},we=async s=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:s}}});h.value.srcObject=e,ue.value=!0}catch(e){console.error("Error al iniciar cámara:",e),_.value="Error al iniciar la cámara."}};J(A,async s=>{s&&await we(s)});const _e=()=>{var e;const s=(e=h.value)==null?void 0:e.srcObject;s&&s.getTracks().forEach(o=>o.stop()),h.value.srcObject=null};J(V,s=>{s==!1&&_e()});const Ye=s=>(console.log(s),Se.find(e=>e.value==s));return He(()=>{n.votante.user.biometrico.cedula_front&&(S.value=n.votante.user.biometrico.cedula_front),n.votante.user.biometrico.firma&&(k.value=n.votante.user.biometrico.firma),n.votante.hash_votantes[0].subtipo&&(t.comuna=Ye(n.votante.hash_votantes[0].subtipo)),t.fecha_expedicion=ve(n.votante.fecha_expedicion),t.nacimiento=ve(n.votante.nacimiento),ie.value=!0}),(s,e)=>(c(),d(W,null,[r(i(Xe),{title:"Corregir datos"}),r(Je,{breadCrumbLinks:qe},{header:y(()=>e[30]||(e[30]=[F(" Corregir datos ")])),default:y(()=>[a("div",nt,[e[43]||(e[43]=a("div",{class:"p-6 border-b border-gray-200"},[a("h1",null,"Corrección registro")],-1)),a("div",ct,[r(i(De),{class:"hidden sm:block",model:Be.value,activeStep:b.value,"onUpdate:activeStep":e[0]||(e[0]=o=>b.value=o)},null,8,["model","activeStep"]),r(i(De),{class:"sm:hidden block",model:Fe.value,activeStep:b.value,"onUpdate:activeStep":e[1]||(e[1]=o=>b.value=o)},null,8,["model","activeStep"])]),a("form",dt,[b.value==0?(c(),d("div",ut,[a("div",mt,[r(x,{for:"nombre",value:"Nombre Completo"}),r(I,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:i(t).nombre,"onUpdate:modelValue":e[2]||(e[2]=o=>i(t).nombre=o),required:""},null,8,["modelValue"]),r(v,{class:"mt-2",message:i(t).errors.nombre},null,8,["message"])]),a("div",vt,[r(x,{for:"identificacion",value:"Identificación"}),r(I,{id:"identificacion",type:"text",class:"mt-1 block w-full",modelValue:i(t).identificacion,"onUpdate:modelValue":e[3]||(e[3]=o=>i(t).identificacion=o),required:""},null,8,["modelValue"]),r(v,{class:"mt-2",message:i(t).errors.identificacion},null,8,["message"])]),a("div",ft,[r(x,{for:"tipo_documento",value:"Tipo de Documento"}),j(a("select",{id:"tipo_documento","onUpdate:modelValue":e[4]||(e[4]=o=>i(t).tipo_documento=o),class:"mt-1 block w-full border-gray-300 rounded-lg"},[e[31]||(e[31]=a("option",{value:"",disabled:""},"Seleccione tipo de documento",-1)),(c(!0),d(W,null,K(i(Qe),o=>(c(),d("option",{key:o.id,value:o.nombre},$(o.nombre),9,pt))),128))],512),[[Q,i(t).tipo_documento]]),r(v,{class:"mt-2",message:i(t).errors.tipo_documento},null,8,["message"])]),a("div",gt,[r(x,{for:"nacimiento",value:"Fecha de Nacimiento"}),r(I,{id:"nacimiento",type:"date",class:"mt-1 block w-full",modelValue:i(t).nacimiento,"onUpdate:modelValue":e[5]||(e[5]=o=>i(t).nacimiento=o),required:""},null,8,["modelValue"]),r(v,{class:"mt-2",message:i(t).errors.nacimiento},null,8,["message"]),P.value?(c(),d("p",bt,$(P.value),1)):z("",!0)]),a("div",xt,[a("button",{type:"button",class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white p-2 rounded-md shadow-xl",onClick:e[6]||(e[6]=o=>Pe(1))}," Siguiente ")])])):z("",!0),b.value==1?(c(),d("div",ht,[a("div",yt,[r(x,{for:"genero",value:"Identidad de Género"}),a("div",wt,[a("div",_t,[j(a("input",{type:"radio",id:"masculino",value:"Masculino","onUpdate:modelValue":e[7]||(e[7]=o=>i(t).genero=o)},null,512),[[ne,i(t).genero]]),e[32]||(e[32]=a("label",{class:"ps-2 text-sm sm:text-base",for:"masculino"},"Masculino",-1))]),a("div",kt,[j(a("input",{type:"radio",id:"two",value:"Femenino","onUpdate:modelValue":e[8]||(e[8]=o=>i(t).genero=o)},null,512),[[ne,i(t).genero]]),e[33]||(e[33]=a("label",{class:"ps-2 text-sm sm:text-base",for:"two"},"Femenino",-1))]),H.value?(c(),d("div",Ct,[r(x,{class:"sm:text-sm text-xs",for:"genero",value:"¿Cual?"}),r(I,{id:"genero",type:"text",class:"mt-1 block w-full p-0 sm:p-1",modelValue:i(t).genero,"onUpdate:modelValue":e[9]||(e[9]=o=>i(t).genero=o),autocomplete:"genero"},null,8,["modelValue"]),r(v,{class:"mt-1",message:i(t).errors.genero},null,8,["message"])])):(c(),d("div",Vt,[j(a("input",{type:"radio",id:"tres",value:"true","onUpdate:modelValue":e[10]||(e[10]=o=>H.value=o)},null,512),[[ne,H.value]]),e[34]||(e[34]=a("label",{class:"ps-2 text-sm sm:text-base",for:"tres"},"Otro",-1))]))])]),a("div",jt,[r(x,{for:"etnia",value:"Grupo poblacional"}),j(a("select",{id:"etnia","onUpdate:modelValue":e[11]||(e[11]=o=>i(t).etnia=o),class:"mt-1 block w-full border-gray-300 rounded-lg"},[e[35]||(e[35]=a("option",{value:"",disabled:""}," Seleccione grupo poblacional perteneciente ",-1)),(c(!0),d(W,null,K(i(et),o=>(c(),d("option",{key:o.id,value:o.nombre},$(o.nombre),9,Et))),128))],512),[[Q,i(t).etnia]]),r(v,{class:"mt-2",message:i(t).errors.etnia},null,8,["message"])]),a("div",St,[r(x,{for:"condicion",value:"Condición poblacional"}),j(a("select",{id:"condicion","onUpdate:modelValue":e[12]||(e[12]=o=>i(t).condicion=o),class:"mt-1 block w-full border-gray-300 rounded-lg"},[e[36]||(e[36]=a("option",{value:"",disabled:""}," Seleccione condición poblacional ",-1)),(c(!0),d(W,null,K(i(tt),o=>(c(),d("option",{key:o.id,value:o.nombre},$(o.nombre),9,Dt))),128))],512),[[Q,i(t).condicion]]),r(v,{class:"mt-2",message:i(t).errors.condicion},null,8,["message"])]),a("div",Ut,[r(x,{for:"comuna",value:"Comuna/Corregimiento"}),r(i(Ue),{id:"comuna",modelValue:oe.value,"onUpdate:modelValue":e[13]||(e[13]=o=>oe.value=o),options:i(Se),filter:"",optionLabel:"label",placeholder:"Seleccione comuna/corregimiento del proyecto",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),r(v,{class:"mt-2",message:i(t).errors.comuna},null,8,["message"])]),a("div",qt,[r(x,{for:"barrio",value:"Barrio/Vereda"}),r(i(Ue),{id:"barrio",modelValue:i(t).barrio,"onUpdate:modelValue":e[14]||(e[14]=o=>i(t).barrio=o),options:ae.value,filter:"",placeholder:"Seleccione barrio/vereda de dirección",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),r(v,{class:"mt-2",message:i(t).errors.barrio},null,8,["message"])]),a("div",Bt,[r(x,{for:"direccion",value:"Dirección"}),r(I,{id:"direccion",type:"text",class:"mt-1 block w-full",modelValue:i(t).direccion,"onUpdate:modelValue":e[15]||(e[15]=o=>i(t).direccion=o),required:""},null,8,["modelValue"]),r(v,{class:"mt-2",message:i(t).errors.direccion},null,8,["message"])]),a("div",Ft,[j(a("input",{type:"checkbox",id:"consentimiento1",name:"consentimiento1",required:"","onUpdate:modelValue":e[16]||(e[16]=o=>i(t).checked=o)},null,512),[[Ve,i(t).checked]]),e[37]||(e[37]=a("label",{for:"consentimiento1",class:"ps-4 pe-12 sm:text-base text-sm text-gray-500"},[F("Conozco y Acepto la Política de Privacidad de Datos "),a("a",{href:"https://www.pereira.gov.co/publicaciones/38/politicas-de-privacidad-y-condiciones-de-uso/",target:"_blank",class:"underline !text-azul cursor-pointer"},"politica")],-1)),r(v,{class:"mt-1",message:i(t).errors.checked},null,8,["message"])]),a("div",It,[j(a("input",{type:"checkbox",id:"consentimiento2",name:"consentimiento2",required:"","onUpdate:modelValue":e[17]||(e[17]=o=>i(t).declaracion=o)},null,512),[[Ve,i(t).declaracion]]),e[38]||(e[38]=a("label",{for:"consentimiento2",class:"ps-4 pe-12 sm:text-base text-sm text-gray-500"},"Declaro bajo la gravedad de juramento que toda la información suministrada en este formulario es verídica, completa y corresponde a la realidad. Entiendo que proporcionar información falsa puede acarrear sanciones legales conforme a la normativa vigente.",-1)),r(v,{class:"mt-1",message:i(t).errors.declaracion},null,8,["message"])]),a("div",Mt,[a("div",zt,[a("button",{type:"button",onClick:e[18]||(e[18]=o=>be(0)),class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white px-4 rounded-md shadow-xl"}," Atrás ")]),a("div",$t,[r(ee,{type:"button",class:T(["h-full",{"opacity-25":i(t).processing}]),onClick:he,disabled:i(t).processing},{default:y(()=>e[39]||(e[39]=[F(" Siguiente ")])),_:1},8,["class","disabled"])])])])):z("",!0),b.value==2?(c(),d("div",Tt,[a("div",Rt,[e[41]||(e[41]=a("div",{class:"col-span-2 text-sm sm:text-base text-gray-800 pt-6"},[a("h3",{class:"text-lg font-semibold"}," Cargue documento de identificación parte frontal "),a("p",null," Para cargar el documento frontal, asegúrese de que la imagen sea clara y legible. El documento debe estar bien iluminado y sin reflejos. ")],-1)),a("div",Lt,[a("div",Ot,[e[40]||(e[40]=a("h4",{class:"text-2xl underline"},"Ejemplo parte frontal",-1)),a("img",{src:i(st),alt:"Documento Frontal ejemplo",class:"w-full h-full object-contain mt-2"},null,8,Nt)])]),a("div",Pt,[a("div",At,[r(I,{id:"cedula_front",type:"file",class:"mt-1 !border-0",accept:"image/jpeg,image/jpg,image/png,image/gif,image/svg+xml,image/webp",onInput:e[19]||(e[19]=o=>me("cedula_front",o)),maxFileSize:2e6}),r(v,{class:"mt-2",message:i(t).errors.cedula_front},null,8,["message"]),a("div",Yt,[S.value?(c(),d("img",{key:0,src:Ie(S.value,1),alt:i(t).cedula_front,class:"w-4/6 h-full object-contain"},null,8,Gt)):(c(),Ze(i(lt),{key:1,class:"w-2/6 text-gray-300 flex justify-center items-center"}))]),S.value?(c(),d("div",Wt,[a("button",{onClick:e[20]||(e[20]=o=>ze(1)),type:"button",class:"bg-red-500 text-white px-4 py-2 rounded"}," Eliminar Imagen ")])):z("",!0)])])]),a("div",Ht,[r(x,{for:"firma",value:"Firma"}),a("div",Xt,[a("button",{type:"button",class:T(["px-2 py-1 rounded",N.value==="imagen"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[21]||(e[21]=o=>N.value="imagen")}," Cargar imagen ",2),a("button",{type:"button",class:T(["px-2 py-1 rounded",N.value==="canvas"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[22]||(e[22]=o=>N.value="canvas")}," Dibujar firma ",2)]),N.value==="imagen"?(c(),d("div",Zt,[r(I,{id:"firma",type:"file",class:"mt-1 block w-full",accept:"image/*",onChange:e[23]||(e[23]=o=>me("firma",o)),maxFileSize:2e6}),r(v,{class:"mt-2",message:i(t).errors.firma},null,8,["message"]),k.value?(c(),d("div",Jt,[a("img",{src:Me(k.value),alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,Kt)])):z("",!0)])):(c(),d("div",Qt,[a("canvas",{ref_key:"canvas",ref:E,height:"150",class:"border border-gray-400 rounded-md bg-white cursor-crosshair sm:w-[300px] w-[250px]",onMousedown:fe,onMousemove:pe,onMouseup:re,onMouseleave:re,onTouchstart:je(fe,["prevent"]),onTouchmove:je(pe,["prevent"]),onTouchend:re},null,544),a("div",{class:"flex gap-2 mt-1"},[a("button",{type:"button",onClick:$e,class:"text-xl sm:text-2xl text-blue-600 underline"}," Limpiar canvas "),a("button",{type:"button",onClick:Te,class:"text-xl sm:text-2xl text-green-600 underline"}," Guardar firma ")]),r(v,{class:"mt-2",message:i(t).errors.firma},null,8,["message"]),k.value?(c(),d("div",eo,[a("img",{src:k.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,to)])):z("",!0)]))]),a("div",oo,[r(I,{id:"campo_obligatorio",type:"text",class:"mt-1 !border-0 hidden",modelValue:i(t).campoObligatorio,"onUpdate:modelValue":e[24]||(e[24]=o=>i(t).campoObligatorio=o)},null,8,["modelValue"])]),a("div",ao,[a("div",so,[a("button",{type:"button",onClick:e[25]||(e[25]=o=>be(1)),class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white px-4 rounded-md shadow-xl"}," Atrás ")]),a("div",io,[r(ee,{type:"button",onClick:Ae,class:T({"opacity-25":i(t).processing}),disabled:i(t).processing},{default:y(()=>e[42]||(e[42]=[F(" Siguiente ")])),_:1},8,["class","disabled"])])])])):z("",!0)])])]),_:1}),r(te,{show:C.value,closeable:!1},{default:y(()=>[e[44]||(e[44]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Cargando datos... ",-1)),a("div",ro,[r(i(at),{"aria-label":"Loading"})])]),_:1},8,["show"]),r(te,{show:L.value,closeable:!1},{default:y(()=>[e[47]||(e[47]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Desea volver a realizar el registro biométrico ",-1)),a("div",lo,[r(ee,{type:"button",class:T(["h-full",{"opacity-25":i(t).processing}]),onClick:e[26]||(e[26]=o=>xe()),disabled:i(t).processing},{default:y(()=>e[45]||(e[45]=[F(" Volver a realizar el registro biométrico ")])),_:1},8,["class","disabled"]),r(ot,{onClick:ye,class:T({"opacity-25":i(t).processing}),disabled:i(t).processing},{default:y(()=>e[46]||(e[46]=[F(" Continuar y guardar los datos ")])),_:1},8,["class","disabled"])])]),_:1},8,["show"]),r(te,{show:V.value,closeable:!0},{default:y(()=>[e[49]||(e[49]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex flex-wrap tex-center justify-center bg-azul text-white"}," Validación Biométrica ",-1)),e[50]||(e[50]=a("div",{class:"mt-4 px-4"},[a("p",{class:"text-sm sm:text-base text-gray-800"}," Por favor, asegúrese de que su rostro esté bien iluminado y visible en la cámara (sin gorras, tapabocas, gafas). Si no se detecta un rostro, puede intentar nuevamente o continuar sin registro biométrico. ")],-1)),a("div",no,[e[48]||(e[48]=a("label",{for:"camera"},"Seleccionar cámara:",-1)),j(a("select",{id:"camera","onUpdate:modelValue":e[27]||(e[27]=o=>A.value=o),class:"rounded-lg w-auto ms-4"},[(c(!0),d(W,null,K(X.value,o=>(c(),d("option",{key:o.deviceId,value:o.deviceId},$(o.label||"Cámara desconocida"),9,co))),128))],512),[[Q,A.value]]),a("video",{ref_key:"video",ref:h,autoplay:"",muted:"",width:"400",height:"340",class:"rounded-xl shadow-lg flex mx-auto mt-6"},null,512),a("button",{type:"button",disabled:D.value,class:"bg-secondary hover:bg-primary text-sm sm:text-base text-white p-2 rounded-md shadow-xl flex mx-auto mt-4 disabled:bg-gray-500",onClick:e[28]||(e[28]=o=>Re())}," Validar ",8,uo),F(" "+$(_.value),1)])]),_:1},8,["show"]),r(te,{show:ie.value,closeable:!0},{default:y(()=>[e[52]||(e[52]=a("h2",{class:"py-4 sm:text-4xl text-2x font-bold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Aviso importante ",-1)),a("div",mo,[a("p",null," Por favor llenar todos los datos correctamente, para no ser rechazado, ¡recuerda! solo tiene "+$(3-de.votante.hash_votantes[0].intentos)+" oportunidades para registrarse ",1)]),a("div",vo,[r(ee,{type:"button",class:T(["h-full text-xl sm:text-2xl",{"opacity-25":i(t).processing}]),onClick:e[29]||(e[29]=o=>ie.value=!1),disabled:i(t).processing},{default:y(()=>e[51]||(e[51]=[F(" Continuar ")])),_:1},8,["class","disabled"])])]),_:1},8,["show"])],64))}};export{To as default};
