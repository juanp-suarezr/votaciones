import{x as C,T as E,r as y,c as N,w as S,a as _,b as c,d as t,u as s,Z as T,e as b,f as l,p as $,m as w,i as F,n as h,j as g,t as L,F as x,h as B}from"./app-8Z0il1I3.js";import{_ as R}from"./AuthenticatedLayout-BHUw5IAU.js";import{_ as r}from"./InputError-D702h7H7.js";import{_ as i}from"./InputLabel-vNW-oqhJ.js";import{_ as z}from"./PrimaryButton-hpdjS4O4.js";import{_ as n}from"./TextInput-BvbAqO4C.js";import{s as O}from"./index-H9eUCDEO.js";import{r as A}from"./PhotoIcon-BXOT7zhP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Be1fzYNM.js";import"./index-PXv9VMZy.js";import"./index-BAiAadNQ.js";import"./index-boix5M39.js";const M={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},P={class:"bg-white p-4 rounded-lg shadow h-auto"},H={class:"flex justify-center items-center mt-4"},D={class:"border-2 border-gray-300 rounded-md h-full"},Z={class:"flex justify-center"},G=["src","alt"],J={key:0,class:"flex justify-center mt-2"},K={class:"bg-white p-4 rounded-lg shadow h-full"},Q={class:"mt-4 flex flex-wrap gap-4"},W={class:"mb-2 w-full md:pe-8"},X={class:"mb-2 sm:w-[calc(50%-.8rem)]"},Y={class:"mb-2 sm:w-[calc(50%-0.8rem)]"},ee={class:"mb-2"},oe={class:"mb-2"},se={class:"mb-2"},te={class:"mb-2"},ae={class:"mb-2 w-full"},le={key:0},re={class:"mb-2 w-1/4"},ie={class:"mb-2 w-1/4"},ne={class:"mb-2 w-1/4"},de={class:"mb-2 w-1/4"},ce={class:"flex justify-center items-center w-full col-span-2 mt-4"},ke={__name:"SubirActa",props:{proyectos:Array,evento:Object,comuna:Number,puesto_votacion:Number,id_jurado:Number},setup(k){const v=C("$swal"),u=k;console.log(u);const e=E({id_evento:u.evento.id,id_jurado:u.id_jurado,comuna:u.comuna,puesto_votacion:u.puesto_votacion,nombre_testigo:"",Identification_testigo:"",contacto_testigo:"",fecha_inicio:"",fecha_fin:"",hora_inicio:"",hora_cierre:"",votos_nulos:0,votos_blancos:0,votos_no_marcados:0,total_ciudadanos:0,observaciones:"",evidencia:null,votos_proyectos:{}}),d=y(null),f=y(!1),V=N(()=>{const o=e.observaciones.trim().length;return o>=250?f.value=!0:f.value=!1,o});S(V,()=>{e.observaciones=e.observaciones.trim()});const U=m=>{const o=m.target.files[0];if(o){if(o.size>2e6){v.fire({icon:"error",title:"Error",text:"El archivo debe ser menor a 2MB."});return}d.value=URL.createObjectURL(o),e.evidencia=o}else d.value=null},j=()=>{e.evidencia=null,d.value=null},I=()=>{const m=parseInt(e.votos_blancos)+parseInt(e.votos_nulos)+parseInt(e.votos_no_marcados),o=Object.values(e.votos_proyectos).reduce((a,p)=>a+(p||0),0);if(console.log("Total votos:",m),console.log("Total proyectos:",o),console.log("Total ciudadanos:",e.total_ciudadanos),parseInt(e.total_ciudadanos)!=m+parseInt(o)){v.fire({icon:"error",title:"Error",text:"El total de ciudadanos debe ser igual a la suma de votos nulos, blancos, no marcados y votos por proyecto."});return}console.log(e),e.post(route("actaPresencial.store"),{onSuccess:()=>{v.fire({icon:"success",title:"Éxito",text:"Acta de escrutinio cargada correctamente."}),e.reset(),d.value=null,window.location.href=route("dashboard")},onError:a=>{console.error(a)}})},q=[{url:"",text:"Carga acta de escrutinio"}];return(m,o)=>(c(),_(x,null,[t(s(T),{title:"Carga de acta"}),t(R,{breadCrumbLinks:q},{header:b(()=>o[14]||(o[14]=[g(" Carga acta de escrutinio y registros ")])),default:b(()=>[l("div",M,[o[20]||(o[20]=l("div",{class:"p-6 border-b border-gray-200"},[l("h1",null,"Proceso de votación presencial física")],-1)),l("form",{onSubmit:$(I,["prevent"]),class:"md:grid md:grid-cols-2 gap-4 p-6"},[l("div",P,[o[15]||(o[15]=l("h2",{class:"text-lg font-semibold mb-4"},"Subir acta de escrutinio",-1)),o[16]||(o[16]=l("p",null,"Sube el acta de escrutinio en formato imagen.",-1)),l("div",H,[l("div",D,[t(n,{id:"evidencia",type:"file",class:"!border-0",accept:"image/*",required:"",onInput:o[0]||(o[0]=a=>U(a)),maxFileSize:2e6}),t(r,{class:"mt-2",message:s(e).errors.evidencia},null,8,["message"]),l("div",Z,[d.value?(c(),_("img",{key:0,src:d.value,alt:s(e).evidencia,class:"w-4/6 h-full object-contain"},null,8,G)):(c(),F(s(A),{key:1,class:"w-2/6 text-gray-300 flex justify-center items-center"}))]),d.value?(c(),_("div",J,[l("button",{onClick:o[1]||(o[1]=a=>j()),type:"button",class:"bg-red-500 text-white px-4 py-2 rounded"}," Eliminar Imagen ")])):w("",!0)])])]),l("div",K,[o[17]||(o[17]=l("h2",{class:"text-lg font-semibold mb-4"},"Registro de información",-1)),o[18]||(o[18]=l("p",null,"Registra la información y numero de votos por proyecto",-1)),l("div",Q,[l("div",W,[t(i,{for:"nombre_testigo",value:"Nombre del testigo"}),t(n,{id:"nombre_testigo",modelValue:s(e).nombre_testigo,"onUpdate:modelValue":o[2]||(o[2]=a=>s(e).nombre_testigo=a),class:"mt-1 block w-full",type:"text",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.nombre_testigo,class:"mt-2"},null,8,["message"])]),l("div",X,[t(i,{for:"Identification_testigo",value:"Identificación del testigo"}),t(n,{id:"Identification_testigo",modelValue:s(e).Identification_testigo,"onUpdate:modelValue":o[3]||(o[3]=a=>s(e).Identification_testigo=a),class:"mt-1 block w-full",type:"number",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.Identification_testigo,class:"mt-2"},null,8,["message"])]),l("div",Y,[t(i,{for:"contacto_testigo",value:"Contacto del testigo"}),t(n,{id:"contacto_testigo",modelValue:s(e).contacto_testigo,"onUpdate:modelValue":o[4]||(o[4]=a=>s(e).contacto_testigo=a),class:"mt-1 block w-full",type:"number",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.contacto_testigo,class:"mt-2"},null,8,["message"])]),l("div",ee,[t(i,{for:"fecha_inicio",value:"Fecha de inicio"}),t(n,{id:"fecha_inicio",modelValue:s(e).fecha_inicio,"onUpdate:modelValue":o[5]||(o[5]=a=>s(e).fecha_inicio=a),class:"mt-1 block w-full",type:"date",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.fecha_inicio,class:"mt-2"},null,8,["message"])]),l("div",oe,[t(i,{for:"fecha_fin",value:"Fecha de fin"}),t(n,{id:"fecha_fin",modelValue:s(e).fecha_fin,"onUpdate:modelValue":o[6]||(o[6]=a=>s(e).fecha_fin=a),class:"mt-1 block w-full",type:"date",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.fecha_fin,class:"mt-2"},null,8,["message"])]),l("div",se,[t(i,{for:"hora_inicio",value:"Hora de inicio"}),t(n,{id:"hora_inicio",modelValue:s(e).hora_inicio,"onUpdate:modelValue":o[7]||(o[7]=a=>s(e).hora_inicio=a),class:"mt-1 block w-full",type:"time",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.hora_inicio,class:"mt-2"},null,8,["message"])]),l("div",te,[t(i,{for:"hora_cierre",value:"Hora de cierre"}),t(n,{id:"hora_cierre",modelValue:s(e).hora_cierre,"onUpdate:modelValue":o[8]||(o[8]=a=>s(e).hora_cierre=a),class:"mt-1 block w-full",type:"time",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.hora_cierre,class:"mt-2"},null,8,["message"])]),l("div",ae,[t(i,{for:"observaciones",value:"Observaciones (max 250 caracteres)"}),t(s(O),{modelValue:s(e).observaciones,"onUpdate:modelValue":o[9]||(o[9]=a=>s(e).observaciones=a),variant:"filled",autoResize:"",rows:"5",class:"mt-1 block w-full",required:"",autocomplete:"observaciones"},null,8,["modelValue"]),l("p",{class:h(["text-gray-500 text-sm mt-2",{"text-red-500":f.value}])},[g(L(V.value)+" caracteres ",1),f.value?(c(),_("span",le,"Limite de caracteres superado")):w("",!0)],2),t(r,{message:s(e).errors.observaciones,class:"mt-2"},null,8,["message"])]),l("div",re,[t(i,{for:"votos_nulos",value:"Votos nulos"}),t(n,{id:"votos_nulos",modelValue:s(e).votos_nulos,"onUpdate:modelValue":o[10]||(o[10]=a=>s(e).votos_nulos=a),class:"mt-1 block w-full",type:"number",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.votos_nulos,class:"mt-2"},null,8,["message"])]),l("div",ie,[t(i,{for:"votos_blancos",value:"Votos blancos"}),t(n,{id:"votos_blancos",modelValue:s(e).votos_blancos,"onUpdate:modelValue":o[11]||(o[11]=a=>s(e).votos_blancos=a),class:"mt-1 block w-full",type:"number",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.votos_blancos,class:"mt-2"},null,8,["message"])]),l("div",ne,[t(i,{for:"votos_no_marcados",value:"Votos no marcados"}),t(n,{id:"votos_no_marcados",modelValue:s(e).votos_no_marcados,"onUpdate:modelValue":o[12]||(o[12]=a=>s(e).votos_no_marcados=a),class:"mt-1 block w-full",type:"number",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.votos_no_marcados,class:"mt-2"},null,8,["message"])]),(c(!0),_(x,null,B(u.proyectos,a=>(c(),_("div",{key:a.id,class:"mb-2 w-full"},[t(i,{for:"votos_proyecto_"+a.id,value:"Votos proyecto --"+a.proyecto.numero_tarjeton+" "+a.proyecto.detalle},null,8,["for","value"]),t(n,{id:"votos_proyecto_"+a.id,modelValue:s(e).votos_proyectos[a.proyecto.id],"onUpdate:modelValue":p=>s(e).votos_proyectos[a.proyecto.id]=p,class:"mt-1 block w-full",type:"number",required:""},null,8,["id","modelValue","onUpdate:modelValue"]),t(r,{message:s(e).errors["votos_proyectos."+a.proyecto.id],class:"mt-2"},null,8,["message"])]))),128)),l("div",de,[t(i,{for:"total_ciudadanos",value:"Total ciudadanos"}),t(n,{id:"total_ciudadanos",modelValue:s(e).total_ciudadanos,"onUpdate:modelValue":o[13]||(o[13]=a=>s(e).total_ciudadanos=a),class:"mt-1 block w-full",type:"number",required:""},null,8,["modelValue"]),t(r,{message:s(e).errors.total_ciudadanos,class:"mt-2"},null,8,["message"])])])]),l("div",ce,[t(z,{class:h(["w-auto",{"opacity-25":s(e).processing}]),disabled:s(e).processing},{default:b(()=>o[19]||(o[19]=[g(" Enviar ")])),_:1},8,["class","disabled"])])],32)])]),_:1})],64))}};export{ke as default};
