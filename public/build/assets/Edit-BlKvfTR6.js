import{x as L,r as x,T as q,q as j,w as S,c as u,o as d,b as a,u as s,Z as P,d as v,e as t,j as c,B as O,n as $,p as w,t as _,f as R,v as z,l as F,F as T}from"./app-D2mz-er7.js";import{_ as M}from"./AuthenticatedLayout-CEcMhY0B.js";import{_ as n}from"./InputError-0YIzqJ8q.js";import{_ as m}from"./InputLabel-TkYyWvOR.js";import{_ as Z}from"./PrimaryButton-C-Dl4Vtw.js";import{_ as h}from"./TextInput-BC12ibZA.js";import{_ as G}from"./SecondaryButton-CHDFkHXd.js";import{s as H}from"./index-CVjUr5hk.js";import{s as J}from"./index-B0hjQNZv.js";import{_ as K}from"./SecondaryLink-BGuh-2A6.js";import{s as Q}from"./index-DGIMm7E-.js";import{s as W}from"./index-c17iJGoN.js";import{r as X}from"./PhotoIcon-BdfSJY7Z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BreadCrumb-BfwaBsoK.js";import"./SecondaryButtonReturn-F26GtBxU.js";import"./XCircleIcon-C6NVRsm6.js";import"./index-B4QUNhiH.js";import"./index-Ca3z-wol.js";import"./index-CUZRfJyQ.js";import"./index-DxMncZPA.js";import"./index-DE1mxT5M.js";import"./index-C8q1LZwq.js";import"./index-Dld_vrQC.js";const Y={class:"flex flex-col bg-white border shadow-sm rounded-xl w-full"},ee={class:"bg-gray-100 border-b rounded-t-xl py-3 px-4 md:py-4 md:px-5 grid grid-cols-2 gap-4"},oe={class:"text-right"},te={class:"p-4 md:p-5"},se={class:"mb-2"},ae={class:"mb-2"},re={class:"col-span-2 mb-2"},le={key:0},ie={class:"col-span-2 flex md:grid grid-cols-2 flex-wrap gap-4"},ne={class:"w-auto"},de={class:"w-auto"},me={class:"card flex inline-flex justify-content-center border border-gray-400 rounded-md shadow-md py-1 px-2 mt-2 !text-gray-500"},ue={class:"w-auto mt-4"},ce={key:0,class:"card flex justify-content-center"},pe={key:1,class:"text-xs text-gray-600"},fe=["href"],ge={class:"w-auto"},ve={class:"w-full h-full mt-2"},be={class:"flex flex-wrap items-center w-auto gap-4"},ye={key:0,class:"px-2 py-4 w-full border border-gray-400 rounded-md shadow-md mt-4"},xe={class:"mt-4"},_e={class:"mb-2"},we={class:"col-span-2"},he={class:"border-2 border-gray-300 rounded-md p-2"},Ve={class:"flex justify-center"},ke=["src","alt"],je={class:"mt-4"},Se={key:0,class:"flex justify-center mt-2"},$e={class:"mt-4 flex flex-col items-end"},Xe={__name:"Edit",props:{proyecto:{type:Object,default:()=>({})},tipos:{type:Object,default:()=>({})},eventos:{type:Object,default:()=>({})},parametros:{type:Array,default:()=>[]},subtipos:{type:Array,default:()=>[]}},setup(p){const V=L("$swal"),f=x(null),b=x(!1),r=p;console.log(r);const E=r.proyecto.eventos!=="NA"?r.proyecto.eventos.split("|").map(l=>parseInt(l)):[],e=q({detalle:r.proyecto.detalle||"",descripcion:r.proyecto.descripcion||"",numero_tarjeton:r.proyecto.numero_tarjeton||"",tipo:r.proyecto.tipo||"",eventos:E||[],subtipo:r.proyecto.subtipo||"",tipo:r.proyecto.tipo,estado:r.proyecto.estado||"",imagen:r.proyecto.imagen}),y=x(null),g=x(!1),U=[{url:"/proyectos",text:"Listado de proyectos"},{url:"",text:"Editar proyecto"}],A=()=>{var l;return e.subtipo==0?"por default":typeof e.subtipo=="object"?e.subtipo.detalle:(l=r.subtipos.find(o=>o.id===parseInt(e.subtipo)))==null?void 0:l.detalle},I=j(()=>y.value?r.subtipos.filter(l=>l.codParametro===y.value):[]);S(g,l=>{l||(e.subtipo=0)});const k=j(()=>{const o=e.descripcion.trim().length;return o>=500?b.value=!0:b.value=!1,o});S(k,()=>{e.descripcion=e.descripcion.trim()});const N=l=>`/storage/uploads/proyectos/${l}`,C=l=>{if(e.imagen=l,console.log(e.imagen),!e.imagen)return;const o=new FileReader;o.onload=()=>{f.value=o.result},o.readAsDataURL(e.imagen)},D=()=>{e.imagen=null,f.value=null},B=()=>{console.log(e),e.imagen&&typeof e.imagen=="string"&&(console.log("Imagen no modificada, enviando nombre del archivo"),e.imagen=""),e.post(route("proyectoUpdate",{id:r.proyecto.id}),{forceFormData:!0,onError:()=>V({title:"Error en el registro",text:"Por favor verifique los datos ingresados",icon:"error"}),onSuccess:()=>V({title:"Registro Actualizado",text:"El proyecto se ha actualizado exitosamente",icon:"success"}).then(l=>{window.location.reload()})})};return(l,o)=>(d(),u(T,null,[a(s(P),{title:"Editar proyecto"}),a(M,{breadCrumbLinks:U},{header:v(()=>[c(" Editar Proyecto "+_(p.proyecto.id),1)]),default:v(()=>[t("div",Y,[t("div",ee,[o[10]||(o[10]=t("h3",{class:"mt-1 text-gray-500"},"Nuevo proyecto",-1)),t("div",oe,[a(K,{href:l.route("proyectos.index")},{default:v(()=>o[9]||(o[9]=[c(" Regresar ")])),_:1},8,["href"])])]),t("div",te,[t("form",{onSubmit:O(B,["prevent"]),class:"grid sm:grid-cols-2 gap-4"},[t("div",se,[a(m,{for:"nombre",value:"Nombre del proyecto"}),a(h,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:s(e).detalle,"onUpdate:modelValue":o[0]||(o[0]=i=>s(e).detalle=i),required:"",autofocus:"",autocomplete:"nombre"},null,8,["modelValue"]),a(n,{class:"mt-2",message:s(e).errors.detalle},null,8,["message"])]),t("div",ae,[a(m,{for:"numero_tarjeton",value:"Numero tarjeton"}),a(h,{id:"numero_tarjeton",type:"number",class:"mt-1 block w-full",modelValue:s(e).numero_tarjeton,"onUpdate:modelValue":o[1]||(o[1]=i=>s(e).numero_tarjeton=i),autocomplete:"numero_tarjeton"},null,8,["modelValue"]),a(n,{class:"mt-2",message:s(e).errors.numero_tarjeton},null,8,["message"])]),t("div",re,[o[11]||(o[11]=t("p",{class:"text-gray-600 text-sm"}," Información adicional sobre el evento (max 500 caracteres) ",-1)),a(s(J),{modelValue:s(e).descripcion,"onUpdate:modelValue":o[2]||(o[2]=i=>s(e).descripcion=i),variant:"filled",autoResize:"",rows:"5",class:"mt-1 block w-full",required:"",autocomplete:"descripcion"},null,8,["modelValue"]),t("p",{class:$(["text-gray-500 text-sm mt-2",{"text-red-500":b.value}])},[c(_(k.value)+" caracteres ",1),b.value?(d(),u("span",le,"Limite de caracteres superado")):w("",!0)],2),a(n,{class:"mt-2",message:s(e).errors.descripcion},null,8,["message"])]),t("div",ie,[t("div",ne,[t("div",de,[a(m,{for:"tipos",value:"Tipos de usuarios"}),t("div",me,_(s(e).tipo),1),a(n,{class:"mt-2",message:s(e).errors.tipos},null,8,["message"])]),t("div",ue,[a(m,{for:"evento",value:"Asignar evento"}),p.eventos.length?(d(),u("div",ce,[a(s(H),{id:"eventos",modelValue:s(e).eventos,"onUpdate:modelValue":o[3]||(o[3]=i=>s(e).eventos=i),display:"chip",options:p.eventos,"option-label":"nombre","option-value":"id",placeholder:"Seleccione los eventos",maxSelectedLabels:6,class:"w-full md:w-20rem"},null,8,["modelValue","options"])])):(d(),u("p",pe,[o[12]||(o[12]=c(" No hay eventos registrados, registrar uno nuevo ")),t("a",{href:l.route("eventos.create")},"Aquí",8,fe)])),a(n,{class:"mt-2",message:s(e).errors.eventos},null,8,["message"])])]),t("div",ge,[t("div",ve,[t("div",be,[a(m,{for:"tipo_user",value:"Subtipos - "+A()},null,8,["value"]),a(G,{onClick:o[4]||(o[4]=i=>g.value=!g.value),class:"items-center"},{default:v(()=>[c(_(g.value?"Cancelar":"Agregar subtipo"),1)]),_:1})]),g.value?(d(),u("div",ye,[t("div",null,[a(m,{for:"parametro",value:"Parámetro"}),a(s(W),{id:"parametro",modelValue:y.value,"onUpdate:modelValue":o[5]||(o[5]=i=>y.value=i),options:p.parametros,"option-label":"detalle","option-value":"cod",placeholder:"Seleccione un parámetro",class:"w-full"},null,8,["modelValue","options"]),a(n,{class:"mt-2",message:s(e).errors.parametro},null,8,["message"])]),t("div",xe,[a(m,{for:"parametroDetalle",value:"Subtipo"}),a(s(Q),{id:"parametroDetalle",modelValue:s(e).subtipo,"onUpdate:modelValue":o[6]||(o[6]=i=>s(e).subtipo=i),options:I.value,filter:"",optionLabel:"detalle",placeholder:"Seleccione un subtipo",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),a(n,{class:"mt-2",message:s(e).errors.subtipo},null,8,["message"])])])):w("",!0)])])]),t("div",_e,[a(m,{for:"estado",value:"Estado"}),R(t("select",{id:"estado","onUpdate:modelValue":o[7]||(o[7]=i=>s(e).estado=i),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-auto p-2. px-4"},o[13]||(o[13]=[t("option",{value:"1"},"Activo",-1),t("option",{value:"0"},"Bloqueado",-1)]),512),[[z,s(e).estado]]),a(n,{class:"mt-2",message:s(e).errors.estado},null,8,["message"])]),t("div",we,[o[15]||(o[15]=t("p",{class:"text-gray-600 text-sm"}," Imagen de proyecto (resolución recomendada: 1080x1080px) ",-1)),t("div",he,[t("div",Ve,[f.value||r.proyecto.imagen?(d(),u("img",{key:0,src:f.value||N(r.proyecto.imagen),alt:s(e).detalle,class:"w-2/6 h-auto"},null,8,ke)):(d(),F(s(X),{key:1,class:"w-1/6 text-gray-300"}))]),t("div",je,[o[14]||(o[14]=t("label",{for:"imagen",class:"bg-blue-500 text-white px-4 py-2 rounded cursor-pointer"}," Cambiar Imagen ",-1)),a(h,{id:"imagen",type:"file",class:"hidden",accept:"image/*",onInput:o[8]||(o[8]=i=>C(i.target.files[0]))}),a(n,{class:"mt-2",message:s(e).errors.imagen},null,8,["message"])]),f.value||r.proyecto.imagen?(d(),u("div",Se,[t("button",{onClick:D,type:"button",class:"bg-red-500 text-white px-4 py-2 rounded"}," Eliminar Imagen ")])):w("",!0)])]),t("div",null,[t("div",$e,[a(Z,{class:$({"opacity-25":s(e).processing}),disabled:s(e).processing},{default:v(()=>o[16]||(o[16]=[c(" Editar proyecto ")])),_:1},8,["class","disabled"])])])],32)])])]),_:1})],64))}};export{Xe as default};
