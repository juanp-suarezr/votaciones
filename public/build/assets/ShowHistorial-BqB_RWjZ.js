import{x as lt,T as nt,r as p,q as Y,c,o as r,b as d,u as b,Z as it,d as a,e,p as y,j as l,t as s,f as rt,v as at,l as E,F as Z,k as dt}from"./app-DFIxs4Pp.js";import{_ as ut}from"./AuthenticatedLayout-wbhK7LEv.js";import{_ as k}from"./SecondaryButton-DWy1I718.js";import{_ as j}from"./PrimaryButton-C--T503s.js";import{c as ct}from"./comunas_completas-Gg-gMHNz.js";import{b as vt}from"./barrios-CntC0Qm4.js";import{N as mt}from"./vue-easy-lightbox.esm.min-C9MOMU5d.js";import{_ as z}from"./Modal-InDlrQzL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BreadCrumb-EbBkB2in.js";import"./SecondaryButtonReturn-DRntF_0b.js";import"./XCircleIcon-CJl5U9b7.js";import"./index-BXvKheqf.js";import"./index-CSxfSp7w.js";import"./index-DiDnaf6m.js";const ft={class:"p-4"},bt={class:"bg-white shadow-md rounded-lg p-6 mb-6"},gt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},xt={key:0},pt={class:"bg-white shadow-md rounded-lg p-6 flex flex-wrap gap-8 items-start"},wt={class:"sm:flex-shrink-0 flex flex-col items-center"},yt=["src"],ht={key:1,class:"text-gray-400 italic"},kt={class:"sm:flex-shrink-0 flex flex-col items-center"},Ct=["src"],Nt={key:1,class:"text-gray-400 italic"},$t={class:"bg-white shadow-md rounded-lg p-6 mt-6 flex flex-col md:flex-row gap-8 items-start"},Dt={class:"w-auto"},Rt={class:""},Et={key:0,class:""},jt={class:"flex flex-col gap-2 w-full md:w-1/3"},zt={class:"flex flex-col md:flex-row gap-4 mt-8 justify-center items-center h-full"},qt={class:"flex justify-between items-center bg-azul text-white px-4 py-4"},St={class:"px-6 py-4"},At=["src"],Bt={class:"text-gray-800 font-medium"},Ft={class:"text-gray-800 font-medium"},It={class:"text-gray-800 font-medium"},Lt={class:"text-gray-800 font-medium"},Pt={class:"text-gray-800 font-medium"},Vt={class:"flex justify-end items-center gap-2 mt-6"},Mt=["disabled"],Ht=["disabled"],Tt={class:"flex justify-center items-center h-full w-full"},Ut={class:"text-center tex-base w-full"},Ot={class:"flex justify-center gap-4 my-4 h-full"},Gt={class:"flex justify-center items-center h-full w-full"},Xt={class:"text-center tex-base w-full"},Yt={class:"flex justify-center gap-4 my-4 h-full"},q=5,de={__name:"ShowHistorial",props:{votante:{type:Object,required:!0},duplicados:{type:Object}},setup(o){const g=lt("$swal"),h=o;console.log(h);const v=nt({id:h.votante.id,motivo:""}),S=p(""),C=p(!1),N=p(!1),$=p(!1),D=p(!1),x=p(1),A=Y(()=>Math.ceil(h.duplicados.length/q)),J=Y(()=>{const i=(x.value-1)*q;return h.duplicados.slice(i,i+q)}),B=i=>{S.value=i,C.value=!0},K=()=>{C.value=!1},Q=i=>{const t=new Date(i),u=t.getFullYear(),f=String(t.getMonth()+1).padStart(2,"0"),m=String(t.getDate()).padStart(2,"0");return`${u}-${f}-${m}`},W=[{url:route("historial_registros"),text:"Histórico de registros"},{url:"",text:"Detalle registro"}],R=i=>`/storage/uploads/fotos/${i}`,F=i=>`/storage/uploads/documentos/${i}`,_=i=>{var t;return console.log(i),(t=ct.find(u=>u.value==i))==null?void 0:t.label},tt=(i,t)=>{const u=vt.find(m=>m.id===t);console.log(u),console.log(i);const f=u.barrios.some(m=>m.toLowerCase().trim()===i.toLowerCase().trim());return console.log(f),!f},et=()=>{v.post(route("aprobarRegistro"),{onSuccess:function(){g({title:"Registro Aprobado",text:"El registro ha sido aprobado exitosamente",icon:"success"}).then(()=>{window.location.href=route("historial_registros")})},onError:function(){g({title:"Error al aprobar registro",text:"Error al intentar aprobar este registro, por favor vuelve a intentar",icon:"error"})}})},ot=()=>{v.post(route("rechazarRegistro"),{onSuccess:function(){g({title:"Registro Rechazado",text:"El registro ha sido rechazado exitosamente",icon:"success"}).then(()=>{window.location.href=route("historial_registros")})},onError:function(){g({title:"Error al rechazar registro",text:"Error al intentar rechazar este registro, por favor vuelve a intentar",icon:"error"})}})},st=()=>{v.post(route("desbloquearRegistro"),{onSuccess:function(){g({title:"Registro Desbloqueado",text:"El registro ha sido desbloqueado exitosamente",icon:"success"}).then(()=>{window.location.href=route("historial_registros")})},onError:function(){g({title:"Error al desbloquear registro",text:"Error al intentar desbloquear este registro, por favor vuelve a intentar",icon:"error"})}})};return(i,t)=>(r(),c(Z,null,[d(b(it),{title:"Revisión del votante"}),d(ut,{breadCrumbLinks:W},{header:a(()=>t[11]||(t[11]=[e("div",{class:"flex justify-between items-center"},[e("h1",{class:"text-2xl font-bold"},"Detalle del Registro")],-1)])),default:a(()=>{var u,f,m,I,L,P,V,M,H,T,U,O,G,X;return[e("div",ft,[e("div",bt,[t[26]||(t[26]=e("h2",{class:"text-lg font-bold mb-4 text-blue-900"},"Datos del votante",-1)),e("div",gt,[e("div",null,[t[12]||(t[12]=e("b",null,"Nombre:",-1)),l(" "+s(((u=o.votante.votante)==null?void 0:u.nombre)||"Sin información"),1)]),e("div",null,[t[13]||(t[13]=e("b",null,"Tipo de documento:",-1)),l(" "+s(((f=o.votante.votante)==null?void 0:f.tipo_documento)||"N/A"),1)]),e("div",null,[t[14]||(t[14]=e("b",null,"Número de documento:",-1)),l(" "+s(((m=o.votante.votante)==null?void 0:m.identificacion)||"N/A"),1)]),e("div",null,[t[15]||(t[15]=e("b",null,"Fecha de nacimiento:",-1)),l(" "+s(((I=o.votante.votante)==null?void 0:I.nacimiento)||"N/A"),1)]),e("div",null,[t[16]||(t[16]=e("b",null,"Genero:",-1)),l(" "+s(((L=o.votante.votante)==null?void 0:L.genero)||"N/A"),1)]),e("div",null,[t[17]||(t[17]=e("b",null,"Comuna/Corregimiento:",-1)),l(" "+s(_(o.votante.subtipo)||"N/A"),1)]),e("div",null,[t[18]||(t[18]=e("b",null,"Barrio:",-1)),l(" "+s(((P=o.votante.votante)==null?void 0:P.barrio)||"N/A")+" ",1),t[19]||(t[19]=e("br",null,null,-1)),e("i",null,s(tt((V=o.votante.votante)==null?void 0:V.barrio,o.votante.subtipo)?"Barrio ingresado por el usuario":""),1)]),e("div",null,[t[20]||(t[20]=e("b",null,"Dirección:",-1)),l(" "+s(((M=o.votante.votante)==null?void 0:M.direccion)||"N/A"),1)]),e("div",null,[t[21]||(t[21]=e("b",null,"Contacto:",-1)),t[22]||(t[22]=e("br",null,null,-1)),l(" Email: "+s(((H=o.votante.votante)==null?void 0:H.email)||"N/A")+" ",1),t[23]||(t[23]=e("br",null,null,-1)),l(" Celular: "+s(((T=o.votante.votante)==null?void 0:T.celular)||"N/A"),1)]),o.votante.intentos>0?(r(),c("div",xt,[t[24]||(t[24]=e("b",null,"Motivo rechazo:",-1)),l(" "+s(o.votante.motivo||"N/A"),1)])):y("",!0),e("div",null,[t[25]||(t[25]=e("b",null,"Estado:",-1)),l(" "+s(o.votante.estado||"N/A"),1)])])]),e("div",pt,[e("div",wt,[t[27]||(t[27]=e("h2",null,"Fotografía",-1)),(U=o.votante.votante)!=null&&U.user.biometrico?(r(),c("img",{key:0,src:R((O=o.votante.votante)==null?void 0:O.user.biometrico.photo),alt:"Foto del votante",onClick:t[0]||(t[0]=n=>{var w;return B(R((w=o.votante.votante)==null?void 0:w.user.biometrico.photo))}),class:"sm:w-64 sm:h-64 w-full cursor-pointer sm:object-cover object-contain rounded-lg border shadow"},null,8,yt)):(r(),c("span",ht,"Sin foto"))]),e("div",kt,[t[28]||(t[28]=e("h2",null,"Frontal",-1)),(G=o.votante.votante)!=null&&G.user.biometrico?(r(),c("img",{key:0,src:F((X=o.votante.votante)==null?void 0:X.user.biometrico.cedula_front),alt:"Foto del votante",onClick:t[1]||(t[1]=n=>{var w;return B(F((w=o.votante.votante)==null?void 0:w.user.biometrico.cedula_front))}),class:"w-full sm:h-64 cursor-pointer sm:object-cover object-contain rounded-lg border shadow"},null,8,Ct)):(r(),c("span",Nt,"Sin foto"))])]),e("div",$t,[e("div",Dt,[e("div",Rt,[t[29]||(t[29]=e("b",null,"Validación:",-1)),l(" "+s(o.votante.validaciones),1)]),o.duplicados.length>0?(r(),c("div",Et,[e("button",{onClick:t[2]||(t[2]=n=>N.value=!0),class:"bg-secondary text-white hover:scale-105 hover:bg-primary p-2 cursor-pointer rounded-md mt-2"}," Ver duplicados ")])):y("",!0)]),e("div",jt,[t[31]||(t[31]=e("b",null,"Motivo de rechazo:",-1)),rt(e("select",{"onUpdate:modelValue":t[3]||(t[3]=n=>b(v).motivo=n),class:"border rounded p-2"},t[30]||(t[30]=[e("option",{value:"",disabled:""},"Seleccione un motivo",-1),e("option",{value:"aprobado"},"No hay motivos (aprobado)",-1),e("option",{value:"Documentos incorrectos"},"Documento incorrecto",-1),e("option",{value:"Identidad no validada"},"Identidad no validada",-1),e("option",{value:"Parte frontal del documento poco visible"}," Parte frontal del documento poco visible ",-1),e("option",{value:"Registro duplicado"},"Registro duplicado",-1),e("option",{value:"Información errónea, en comparación con la documentación"}," Información errónea, en comparación con la documentación ",-1),e("option",{value:"Dirección diferente a la comuna/corregimiento"}," Dirección diferente a la comuna/corregimiento ",-1)]),512),[[at,b(v).motivo]])])]),e("div",zt,[o.votante.estado==="Rechazado"?(r(),E(j,{key:0,onClick:et,class:"flex h-full items-center",disabled:b(v).processing},{default:a(()=>t[32]||(t[32]=[l(" Aprobar ")])),_:1},8,["disabled"])):y("",!0),o.votante.estado==="Activo"?(r(),E(k,{key:1,onClick:t[4]||(t[4]=n=>$.value=!0),class:"!bg-red-500 text-white",disabled:b(v).processing},{default:a(()=>t[33]||(t[33]=[l(" Rechazar ")])),_:1},8,["disabled"])):y("",!0),o.votante.estado==="Bloqueado"?(r(),E(k,{key:2,onClick:t[5]||(t[5]=n=>D.value=!0),class:"!bg-yellow-500 text-white",disabled:b(v).processing},{default:a(()=>t[34]||(t[34]=[l(" Desbloquear ")])),_:1},8,["disabled"])):y("",!0)]),d(b(mt),{visible:C.value,imgs:[S.value],onHide:K},null,8,["visible","imgs"])]),d(z,{show:N.value,closeable:!0},{default:a(()=>[e("div",qt,[t[35]||(t[35]=e("h2",{class:"text-2xl font-semibold text-center"}," Registros duplicados o similares ",-1)),e("button",{onClick:t[6]||(t[6]=n=>N.value=!1),class:"text-white text-xl hover:text-gray-300"}," X ")]),e("div",St,[(r(!0),c(Z,null,dt(J.value,n=>(r(),c("div",{key:n.id,class:"flex gap-4 items-center mb-4 border-b pb-2"},[e("img",{src:R(n.photo),alt:"Foto",class:"w-36 h-full object-cover rounded"},null,8,At),e("div",null,[e("p",Bt," ID: "+s(n.user.votantes.hash_votantes[0].id),1),e("p",Ft," Nombre: "+s(n.user.votantes.nombre),1),e("p",It," Identificación: "+s(n.user.votantes.identificacion),1),e("p",Lt," Creación: "+s(Q(n.user.votantes.hash_votantes[0].created_at)),1),e("p",Pt,"Estado: "+s(n.estado),1)])]))),128)),e("div",Vt,[e("button",{class:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",disabled:x.value===1,onClick:t[7]||(t[7]=n=>x.value--)}," Anterior ",8,Mt),e("span",null,"Página "+s(x.value)+" de "+s(A.value),1),e("button",{class:"px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",disabled:x.value===A.value,onClick:t[8]||(t[8]=n=>x.value++)}," Siguiente ",8,Ht)])])]),_:1},8,["show"]),d(z,{show:$.value,closeable:!0},{default:a(()=>[e("div",Tt,[e("div",Ut,[t[38]||(t[38]=e("div",{class:"bg-azul text-white p-2 shadow-lg w-full mb-4"},[e("h2",{class:"text-2xl font-semibold"},"Confirmar Rechazo")],-1)),t[39]||(t[39]=e("p",{class:"mb-4"}," ¿Estás seguro de que deseas rechazar este registro? ",-1)),e("div",Ot,[d(j,{onClick:ot,class:"!bg-red-500 text-white"},{default:a(()=>t[36]||(t[36]=[l(" Confirmar ")])),_:1}),d(k,{onClick:t[9]||(t[9]=n=>$.value=!1),class:"!bg-gray-300 text-black"},{default:a(()=>t[37]||(t[37]=[l(" Cancelar ")])),_:1})])])])]),_:1},8,["show"]),d(z,{show:D.value,closeable:!0},{default:a(()=>[e("div",Gt,[e("div",Xt,[t[42]||(t[42]=e("div",{class:"bg-azul text-white p-2 shadow-lg w-full mb-4"},[e("h2",{class:"text-2xl font-semibold"},"Confirmar desbloqueo")],-1)),t[43]||(t[43]=e("p",{class:"mb-4"}," ¿Estás seguro de que deseas desbloquear al usuario? una vez desbloqueado, podrá volver a corregir los datos. ",-1)),e("div",Yt,[d(j,{onClick:st,class:"!bg-red-500 text-white"},{default:a(()=>t[40]||(t[40]=[l(" Confirmar ")])),_:1}),d(k,{onClick:t[10]||(t[10]=n=>D.value=!1),class:"!bg-gray-300 text-black"},{default:a(()=>t[41]||(t[41]=[l(" Cancelar ")])),_:1})])])])]),_:1},8,["show"])]}),_:1})],64))}};export{de as default};
