import{k as Oe,T as Pe,r as n,w as G,o as Ae,a as u,b as c,d as r,u as i,Z as Ye,e as h,f as a,l as q,g as V,F as N,h as W,t as F,v as X,A as oe,y as xe,j as S,n as B,i as Ge,s as ye,p as he}from"./app-Bh23YaWz.js";import{_ as We}from"./AuthenticatedLayout-Dg-cBKLv.js";import{c as we}from"./comunas-DN-PCrTT.js";import{b as Xe,s as _e,t as He,e as Ze,c as Je}from"./etnia-t2X9Uzc7.js";import{_ as m}from"./InputError-C1ceiP3H.js";import{_ as b}from"./InputLabel-DxF5tysP.js";import{_ as H}from"./PrimaryButton-oH080ldl.js";import{_ as Ke}from"./SecondaryButton-BxpIGSMt.js";import{_ as Z}from"./Modal-BZu6B-ej.js";import{_ as D}from"./TextInput-BpxYLZPw.js";import{s as ke}from"./index-Co0OhhW6.js";import{s as Qe}from"./index-CO9VGzE0.js";import{f as et}from"./cedulaFrontEjemplo-eqgE4YJW.js";import{n as ae,d as tt,T as ot}from"./FaceMatcher-DQZ88WER.js";import{r as at}from"./PhotoIcon-Dv1NmBMn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButtonReturn-BQX0woyI.js";import"./index-DuNiV28B.js";import"./index-DCHyopsa.js";import"./index-CuRsppKZ.js";import"./index-Be1fzYNM.js";import"./index-DhTjBUn-.js";import"./index-BCg24EAx.js";import"./index-DsuMdi1p.js";import"./index-D3ihmh-D.js";const st={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},it={class:"mt-4 justify-center"},rt={class:"m-auto py-4 px-4"},lt={key:0,class:"sm:grid sm:grid-cols-2 gap-6 h-full"},nt={class:"mb-2"},dt={class:"mb-2"},ct={class:"mb-2"},ut=["value"],mt={class:"mb-2"},vt={key:0,class:"text-red-500"},ft={class:"col-span-2 flex justify-end"},pt={key:1,class:"sm:grid sm:grid-cols-2 gap-6"},gt={class:"mb-2"},bt={class:"mt-2 block sm:flex"},xt={class:""},yt={class:"sm:ms-6"},ht={key:0,class:"sm:ms-6"},wt={key:1,class:"sm:ms-6"},_t={class:"mb-2"},kt=["value"],Ct={class:"mb-2"},Vt=["value"],jt={class:"mb-2"},Et={class:"mb-2"},St={class:"mb-2"},Dt={class:"my-4 col-span-2 mb-2"},Ut={class:"mb-4 col-span-2 mb-2"},qt={class:"col-span-2 flex justify-between gap-2"},Ft={class:"flex pt-4 justify-end"},Bt={class:"flex pt-4 justify-end h-full"},Mt={key:2,class:"gap-6"},It={class:"sm:grid sm:grid-cols-2 gap-2 h-full sm:px-16 px-4"},$t={class:"w-full h-full mt-4"},zt={class:"w-full"},Tt=["src"],Rt={class:"mb-2 h-full flex justify-center items-center mt-4"},Lt={class:"border-2 border-gray-300 rounded-md p-2 h-full"},Nt={class:"flex justify-center"},Ot=["src","alt"],Pt={key:0,class:"flex justify-center mt-2"},At={class:"w-full gap-2 h-full sm:px-16 px-4 mt-4"},Yt={class:"flex gap-4 mb-2"},Gt={key:0},Wt={key:0,class:"mt-2"},Xt=["src"],Ht={key:1},Zt={key:0,class:"mt-2"},Jt=["src"],Kt={class:"w-full"},Qt={class:"col-span-2 flex justify-between gap-2 mt-4"},eo={class:"flex pt-4 justify-end"},to={class:"flex pt-4 justify-end"},oo={class:"flex justify-center my-12"},ao={class:"flex justify-center gap-4 text-center h-full my-12"},so={class:"my-12 px-4"},io=["value"],ro=["disabled"],lo={class:"text-justify sm:text-2xl text-xl p-6 mt-6"},no={class:"flex justify-center gap-4 text-center h-full my-6"},$o={__name:"CorregirDatos",props:{votante:{type:Object,required:!0}},setup(se){const x=Oe("$swal"),Ce=[{url:"",text:"Corregir datos"}],d=se;console.log("Votante data:",d.votante);const t=Pe({id_votante:d.votante.id||"",nombre:d.votante.nombre||"",identificacion:d.votante.identificacion||"",tipo_documento:d.votante.tipo_documento||"",nacimiento:d.votante.nacimiento||"",cedula_front:null,genero:d.votante.genero||"",etnia:d.votante.etnia||"",condicion:d.votante.condicion||"",direccion:d.votante.direccion||"",comuna:d.votante.hash_votantes[0].subtipo||"",barrio:d.votante.barrio||"",embedding:d.votante.user.biometrico.embedding||"",photo:null,validaciones:d.votante.hash_votantes[0].validaciones||"",checked:!0,declaracion:!0,firma:null,campoObligatorio:""}),J=n(""),K=n([]),_=n(null),z=n("imagen"),j=n(null);let Q=!1;const k=n(!1),ee=n(!0),Ve=n([{label:"Información Personal"},{label:"Datos Demográficos"},{label:"Registro datos"}]),je=n([{label:"paso 1"},{label:"paso 2"},{label:"paso 3"}]),p=n(0),M=n(""),T=n(""),v=n(!1),C=n(!1),O=n(!1),I=n(!1),U=n(null);n(null);const P=n([]),R=n(""),y=n(null),w=n(""),ie=n(!1),E=n(!1),$=n(0),Ee=(s,e)=>t.cedula_front===null?`/storage/uploads/documentos/${s}`:s,Se=s=>t.firma===null?`/storage/uploads/firmas/${s}`:s;G(O,s=>{s&&(t.genero="")}),G(J,s=>{s&&(t.comuna=s,K.value=Xe.find(e=>e.id===parseInt(s.value)).barrios,console.log(K.value))});const re=(s,e)=>{const o=e.target.files[0];if(o&&o.size>2e6){x.fire({icon:"error",title:"Error",text:"El archivo debe ser menor a 2MB."});return}if(t[s]=e.target.files[0],s==="cedula_front"){const l=new FileReader;l.onload=g=>{U.value=g.target.result},l.readAsDataURL(t[s])}else if(s=="firma"){const l=new FileReader;l.onload=g=>{_.value=g.target.result},l.readAsDataURL(o)}},De=s=>{t.cedula_front=null,U.value=null},le=s=>{if(!s)return"";const e=new Date(s),o=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),g=String(e.getDate()).padStart(2,"0");return`${o}-${l}-${g}`},ne=s=>{Q=!0;const e=j.value.getContext("2d"),o=ce(s);e.beginPath(),e.moveTo(o.x,o.y)},de=s=>{if(!Q)return;const e=j.value.getContext("2d"),o=ce(s);e.lineTo(o.x,o.y),e.strokeStyle="#222",e.lineWidth=2,e.stroke()},te=()=>{Q=!1},Ue=()=>{j.value.getContext("2d").clearRect(0,0,j.value.width,j.value.height),_.value=null,t.firma=null},qe=()=>{j.value.toBlob(s=>{t.firma=new File([s],"firma.webp",{type:"image/webp"});const e=new FileReader;e.onload=o=>{_.value=o.target.result},e.readAsDataURL(t.firma)},"image/webp")},ce=s=>{const e=j.value.getBoundingClientRect();return s.touches&&s.touches.length>0?{x:s.touches[0].clientX-e.left,y:s.touches[0].clientY-e.top}:{x:s.offsetX,y:s.offsetY}},ue=s=>{p.value=s,v.value=!0},me=async()=>{k.value=!0;try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(l=>l.stop()),await ae.tinyFaceDetector.loadFromUri("/models/tiny_face_detector"),await ae.faceRecognitionNet.loadFromUri("/models/face_recognition"),await ae.faceLandmark68Net.loadFromUri("/models/face_landmark_68");const e=await navigator.mediaDevices.enumerateDevices();P.value=e.filter(l=>l.kind==="videoinput");const o=P.value.find(l=>l.label.toLowerCase().includes("user"))||P.value[0];console.log(o),R.value=(o==null?void 0:o.deviceId)||"",k.value=!1,C.value=!0,await pe(R.value)}catch(s){k.value=!1,$.value==3,console.error("Error al iniciar:",s),w.value="No se pudo acceder a la cámara."}},Fe=async()=>{w.value="",E.value=!0;const s=o=>parseInt(sessionStorage.getItem(o)||"0"),e=(o,l)=>sessionStorage.setItem(o,l.toString());if(!ie.value){s("fallo_camara")+1,w.value="La cámara no está lista.",E.value=!1;return}try{const o=await tt(y.value,new ot).withFaceLandmarks().withFaceDescriptor();if(console.log("entro -- validador"),!o){E.value=!1,w.value="No se detectó un rostro.",$.value+=1;const f=document.createElement("canvas");f.width=y.value.videoWidth,f.height=y.value.videoHeight,f.getContext("2d").drawImage(y.value,0,0,f.width,f.height);const A=await new Promise(Y=>f.toBlob(Y,"image/jpeg")),Ne=new File([A],"photo.jpg",{type:"image/jpeg"});t.photo=Ne,$.value==3&&x.fire({title:"Error en validación",text:"Error, no se detectó un rostro, vuelve a intentar o avanzar con la imagen poco visible y posiblemente sin registro biométrico (alta probabilidad de rechazo)",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(Y=>{Y.isConfirmed?(t.embedding="",t.validaciones="no_rostro",C.value=!1,I.value=!0):Y.dismiss===Swal.DismissReason.cancel&&(console.log("Usuario decide volver a intentar"),w.value="",$.value=0)});return}const l=o.descriptor;t.embedding=l,console.log("emb",l);const g=document.createElement("canvas");g.width=y.value.videoWidth,g.height=y.value.videoHeight,g.getContext("2d").drawImage(y.value,0,0,g.width,g.height);const Re=await new Promise(f=>g.toBlob(f,"image/jpeg")),Le=new File([Re],"photo.jpg",{type:"image/jpeg"});t.photo=Le;const be=new FormData;be.append("embedding",l),E.value=!1,C.value=!1,k.value=!0,he.post(route("face-validate"),be,{headers:{"Content-Type":"multipart/form-data"}}).then(f=>{w.value=f.data.message,console.log(f),E.value=!1,k.value=!1,f.data.match?x.fire({title:"Error en validación",text:"Usted ya tiene un registro biométrico. Si está seguro que no se ha registrado, puede volver a intentarlo o continuar (probabilidad de rechazo).",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(L=>{L.isConfirmed?(t.validaciones="registro_duplicado",C.value=!1,I.value=!0):L.dismiss===x.DismissReason.cancel&&console.log("Usuario decide volver a intentar")}):x({title:"Validación exitosa",text:"Validación biométrica exitosa",icon:"success",didClose:()=>{C.value=!1,k.value=!0,fe()}})}).catch(f=>{E.value=!1,k.value=!1,console.log(f);const L=s("fallo_registro")+1;e("fallo_registro",L),x.fire({title:"Error en validación",text:"Error en la validación, vuelve a intentar o avanzar sin registro biometrico (posibilidad de rechazo)",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(A=>{A.isConfirmed?(t.embedding="",t.validaciones="fallo_registro_biometrico",C.value=!1,I.value=!0):A.dismiss===x.DismissReason.cancel&&console.log("Usuario decide volver a intentar")})})}catch(o){console.error(o),E.value=!1,k.value=!1,$.value==3&&x.fire({title:"Error en validación",text:"Error al procesar el rostro, vuelve a intentar o avanzar sin registro biometrico (posibilidad de rechazo)",icon:"error",showCancelButton:!0,cancelButtonText:"Volver a intentar",confirmButtonText:"Continuar"}).then(l=>{l.isConfirmed?(t.embedding="",t.validaciones="fallo_registro",C.value=!1,I.value=!0):l.dismiss===x.DismissReason.cancel&&(console.log("Usuario decide volver a intentar"),w.value="",$.value=0)}),w.value="Error al procesar el rostro."}},Be=()=>{if(!t.nacimiento)return T.value="Debes ingresar la fecha de nacimiento.",!1;const s=new Date,e=new Date(t.nacimiento);let o=s.getFullYear()-e.getFullYear();const l=s.getMonth()-e.getMonth();return(l<0||l===0&&s.getDate()<e.getDate())&&o--,o<14?(T.value="No cumple con el requisito de edad mínima (14 años), por lo tanto, no puede ejercer el derecho al voto.",!1):(T.value="",!0)},Me=async()=>{if(v.value=!1,t.nombre&&t.identificacion&&t.tipo_documento&&t.fecha_expedicion&&(t.lugar_expedicion||t.tipo_documento!="Cédula Ciudadanía")&&t.nacimiento){if(!Be())return;M.value="";try{const s=await Ie(t.identificacion);console.log("Identificación existe:",s),s?(M.value="El número de cédula ingresado ya se encuentra registrado en el sistema. /n Por favor, continúe con el proceso de votación ingresando a la plataforma con su número de documento y la contraseña que registró previamente.",v.value=!1):(M.value="",v.value=!0)}catch{M.value="Error al validar la identificación. Intenta de nuevo.",v.value=!1}}v.value?p.value=1:(t.nombre||(t.errors.nombre="Este campo es requerido."),(!t.identificacion||M.value!="")&&(t.errors.identificacion=M.value||"Este campo es requerido."),t.tipo_documento||(t.errors.tipo_documento="Este campo es requerido."),t.fecha_expedicion||(t.errors.fecha_expedicion="Este campo es requerido."),t.lugar_expedicion||(t.errors.lugar_expedicion="Este campo es requerido."),t.nacimiento||(t.errors.nacimiento="Este campo es requerido."))},Ie=async s=>(await he.post("/validar-identificacion",{identificacion:s})).data.existe,$e=s=>{switch(v.value=!1,s){case 1:Me();break;case 2:ve();break}v.value&&(p.value=s)},ve=()=>{v.value=!1,t.genero&&t.etnia&&t.condicion&&t.comuna&&t.barrio&&t.direccion&&t.checked&&t.declaracion&&(v.value=!0,p.value=2),v.value||(t.genero||(t.errors.genero="Este campo es requerido."),t.etnia||(t.errors.etnia="Este campo es requerido."),t.condicion||(t.errors.condicion="Este campo es requerido."),t.comuna||(t.errors.comuna="Este campo es requerido."),t.barrio||(t.errors.barrio="Este campo es requerido."),t.direccion||(t.errors.direccion="Este campo es requerido."),t.checked||(t.errors.checked="Este campo es requerido."),t.declaracion||(t.errors.declaracion="Este campo es requerido."))},ze=()=>{v.value=!1,(t.cedula_front||U)&&(t.firma||_)&&(v.value=!0),v.value?t.embedding&&d.votante.hash_votantes[0].validaciones!="no_rostro"?I.value=!0:me():(t.cedula_front||(t.errors.cedula_front="Este campo es requerido."),t.firma||(t.errors.firma='Debe hacer clic en "Usar firma" para continuar'))},fe=()=>{t.post(route("corregirDatos"),{onSuccess:()=>{x({title:"Registro actualizado",text:"Registro de usuario actualizado exitosamente. Se realizará la validación de su información, el estado sera notificado a su correo.",icon:"success"}).then(s=>{window.location.href=route("dashboard")}),sessionStorage.removeItem("fallo_camara"),sessionStorage.removeItem("fallo_registro"),sessionStorage.removeItem("registro_duplicado"),t.reset(),ge()},onError:s=>{x({title:"Error",text:"Ocurrió un error al registrar el usuario.",icon:"error"}).then(e=>{p.value=0}),console.error(s)}})},pe=async s=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:s}}});y.value.srcObject=e,ie.value=!0}catch(e){console.error("Error al iniciar cámara:",e),w.value="Error al iniciar la cámara."}};G(R,async s=>{s&&await pe(s)});const ge=()=>{var e;const s=(e=y.value)==null?void 0:e.srcObject;s&&s.getTracks().forEach(o=>o.stop()),y.value.srcObject=null};G(C,s=>{s==!1&&ge()});const Te=s=>(console.log(s),we.find(e=>e.value==s));return Ae(()=>{d.votante.user.biometrico.cedula_front&&(U.value=d.votante.user.biometrico.cedula_front),d.votante.user.biometrico.firma&&(_.value=d.votante.user.biometrico.firma),d.votante.hash_votantes[0].subtipo&&(t.comuna=Te(d.votante.hash_votantes[0].subtipo)),t.fecha_expedicion=le(d.votante.fecha_expedicion),t.nacimiento=le(d.votante.nacimiento),ee.value=!0}),(s,e)=>(c(),u(N,null,[r(i(Ye),{title:"Corregir datos"}),r(We,{breadCrumbLinks:Ce},{header:h(()=>e[30]||(e[30]=[S(" Corregir datos ")])),default:h(()=>[a("div",st,[e[43]||(e[43]=a("div",{class:"p-6 border-b border-gray-200"},[a("h1",null,"Corrección registro")],-1)),a("div",it,[r(i(_e),{class:"hidden sm:block",model:Ve.value,activeStep:p.value,"onUpdate:activeStep":e[0]||(e[0]=o=>p.value=o)},null,8,["model","activeStep"]),r(i(_e),{class:"sm:hidden block",model:je.value,activeStep:p.value,"onUpdate:activeStep":e[1]||(e[1]=o=>p.value=o)},null,8,["model","activeStep"])]),a("form",rt,[p.value==0?(c(),u("div",lt,[a("div",nt,[r(b,{for:"nombre",value:"Nombre Completo"}),r(D,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:i(t).nombre,"onUpdate:modelValue":e[2]||(e[2]=o=>i(t).nombre=o),required:""},null,8,["modelValue"]),r(m,{class:"mt-2",message:i(t).errors.nombre},null,8,["message"])]),a("div",dt,[r(b,{for:"identificacion",value:"Identificación"}),r(D,{id:"identificacion",type:"text",class:"mt-1 block w-full",modelValue:i(t).identificacion,"onUpdate:modelValue":e[3]||(e[3]=o=>i(t).identificacion=o),required:""},null,8,["modelValue"]),r(m,{class:"mt-2",message:i(t).errors.identificacion},null,8,["message"])]),a("div",ct,[r(b,{for:"tipo_documento",value:"Tipo de Documento"}),V(a("select",{id:"tipo_documento","onUpdate:modelValue":e[4]||(e[4]=o=>i(t).tipo_documento=o),class:"mt-1 block w-full border-gray-300 rounded-lg"},[e[31]||(e[31]=a("option",{value:"",disabled:""},"Seleccione tipo de documento",-1)),(c(!0),u(N,null,W(i(He),o=>(c(),u("option",{key:o.id,value:o.nombre},F(o.nombre),9,ut))),128))],512),[[X,i(t).tipo_documento]]),r(m,{class:"mt-2",message:i(t).errors.tipo_documento},null,8,["message"])]),a("div",mt,[r(b,{for:"nacimiento",value:"Fecha de Nacimiento"}),r(D,{id:"nacimiento",type:"date",class:"mt-1 block w-full",modelValue:i(t).nacimiento,"onUpdate:modelValue":e[5]||(e[5]=o=>i(t).nacimiento=o),required:""},null,8,["modelValue"]),r(m,{class:"mt-2",message:i(t).errors.nacimiento},null,8,["message"]),T.value?(c(),u("p",vt,F(T.value),1)):q("",!0)]),a("div",ft,[a("button",{type:"button",class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white p-2 rounded-md shadow-xl",onClick:e[6]||(e[6]=o=>$e(1))}," Siguiente ")])])):q("",!0),p.value==1?(c(),u("div",pt,[a("div",gt,[r(b,{for:"genero",value:"Identidad de Género"}),a("div",bt,[a("div",xt,[V(a("input",{type:"radio",id:"masculino",value:"Masculino","onUpdate:modelValue":e[7]||(e[7]=o=>i(t).genero=o)},null,512),[[oe,i(t).genero]]),e[32]||(e[32]=a("label",{class:"ps-2 text-sm sm:text-base",for:"masculino"},"Masculino",-1))]),a("div",yt,[V(a("input",{type:"radio",id:"two",value:"Femenino","onUpdate:modelValue":e[8]||(e[8]=o=>i(t).genero=o)},null,512),[[oe,i(t).genero]]),e[33]||(e[33]=a("label",{class:"ps-2 text-sm sm:text-base",for:"two"},"Femenino",-1))]),O.value?(c(),u("div",ht,[r(b,{class:"sm:text-sm text-xs",for:"genero",value:"¿Cual?"}),r(D,{id:"genero",type:"text",class:"mt-1 block w-full p-0 sm:p-1",modelValue:i(t).genero,"onUpdate:modelValue":e[9]||(e[9]=o=>i(t).genero=o),autocomplete:"genero"},null,8,["modelValue"]),r(m,{class:"mt-1",message:i(t).errors.genero},null,8,["message"])])):(c(),u("div",wt,[V(a("input",{type:"radio",id:"tres",value:"true","onUpdate:modelValue":e[10]||(e[10]=o=>O.value=o)},null,512),[[oe,O.value]]),e[34]||(e[34]=a("label",{class:"ps-2 text-sm sm:text-base",for:"tres"},"Otro",-1))]))])]),a("div",_t,[r(b,{for:"etnia",value:"Grupo poblacional"}),V(a("select",{id:"etnia","onUpdate:modelValue":e[11]||(e[11]=o=>i(t).etnia=o),class:"mt-1 block w-full border-gray-300 rounded-lg"},[e[35]||(e[35]=a("option",{value:"",disabled:""}," Seleccione grupo poblacional perteneciente ",-1)),(c(!0),u(N,null,W(i(Ze),o=>(c(),u("option",{key:o.id,value:o.nombre},F(o.nombre),9,kt))),128))],512),[[X,i(t).etnia]]),r(m,{class:"mt-2",message:i(t).errors.etnia},null,8,["message"])]),a("div",Ct,[r(b,{for:"condicion",value:"Condición poblacional"}),V(a("select",{id:"condicion","onUpdate:modelValue":e[12]||(e[12]=o=>i(t).condicion=o),class:"mt-1 block w-full border-gray-300 rounded-lg"},[e[36]||(e[36]=a("option",{value:"",disabled:""}," Seleccione condición poblacional ",-1)),(c(!0),u(N,null,W(i(Je),o=>(c(),u("option",{key:o.id,value:o.nombre},F(o.nombre),9,Vt))),128))],512),[[X,i(t).condicion]]),r(m,{class:"mt-2",message:i(t).errors.condicion},null,8,["message"])]),a("div",jt,[r(b,{for:"comuna",value:"Comuna/Corregimiento"}),r(i(ke),{id:"comuna",modelValue:J.value,"onUpdate:modelValue":e[13]||(e[13]=o=>J.value=o),options:i(we),filter:"",optionLabel:"label",placeholder:"Seleccione comuna/corregimiento del proyecto",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),r(m,{class:"mt-2",message:i(t).errors.comuna},null,8,["message"])]),a("div",Et,[r(b,{for:"barrio",value:"Barrio/Vereda"}),r(i(ke),{id:"barrio",modelValue:i(t).barrio,"onUpdate:modelValue":e[14]||(e[14]=o=>i(t).barrio=o),options:K.value,filter:"",placeholder:"Seleccione barrio/vereda de dirección",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),r(m,{class:"mt-2",message:i(t).errors.barrio},null,8,["message"])]),a("div",St,[r(b,{for:"direccion",value:"Dirección"}),r(D,{id:"direccion",type:"text",class:"mt-1 block w-full",modelValue:i(t).direccion,"onUpdate:modelValue":e[15]||(e[15]=o=>i(t).direccion=o),required:""},null,8,["modelValue"]),r(m,{class:"mt-2",message:i(t).errors.direccion},null,8,["message"])]),a("div",Dt,[V(a("input",{type:"checkbox",id:"consentimiento1",name:"consentimiento1",required:"","onUpdate:modelValue":e[16]||(e[16]=o=>i(t).checked=o)},null,512),[[xe,i(t).checked]]),e[37]||(e[37]=a("label",{for:"consentimiento1",class:"ps-4 pe-12 sm:text-base text-sm text-gray-500"},[S("Conozco y Acepto la Política de Privacidad de Datos "),a("a",{href:"https://www.pereira.gov.co/publicaciones/38/politicas-de-privacidad-y-condiciones-de-uso/",target:"_blank",class:"underline !text-azul cursor-pointer"},"politica")],-1)),r(m,{class:"mt-1",message:i(t).errors.checked},null,8,["message"])]),a("div",Ut,[V(a("input",{type:"checkbox",id:"consentimiento2",name:"consentimiento2",required:"","onUpdate:modelValue":e[17]||(e[17]=o=>i(t).declaracion=o)},null,512),[[xe,i(t).declaracion]]),e[38]||(e[38]=a("label",{for:"consentimiento2",class:"ps-4 pe-12 sm:text-base text-sm text-gray-500"},"Declaro bajo la gravedad de juramento que toda la información suministrada en este formulario es verídica, completa y corresponde a la realidad. Entiendo que proporcionar información falsa puede acarrear sanciones legales conforme a la normativa vigente.",-1)),r(m,{class:"mt-1",message:i(t).errors.declaracion},null,8,["message"])]),a("div",qt,[a("div",Ft,[a("button",{type:"button",onClick:e[18]||(e[18]=o=>ue(0)),class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white px-4 rounded-md shadow-xl"}," Atrás ")]),a("div",Bt,[r(H,{type:"button",class:B(["h-full",{"opacity-25":i(t).processing}]),onClick:ve,disabled:i(t).processing},{default:h(()=>e[39]||(e[39]=[S(" Siguiente ")])),_:1},8,["class","disabled"])])])])):q("",!0),p.value==2?(c(),u("div",Mt,[a("div",It,[e[41]||(e[41]=a("div",{class:"col-span-2 text-sm sm:text-base text-gray-800 pt-6"},[a("h3",{class:"text-lg font-semibold"}," Cargue documento de identificación parte frontal "),a("p",null," Para cargar el documento frontal, asegúrese de que la imagen sea clara y legible. El documento debe estar bien iluminado y sin reflejos. ")],-1)),a("div",$t,[a("div",zt,[e[40]||(e[40]=a("h4",{class:"text-2xl underline"},"Ejemplo parte frontal",-1)),a("img",{src:i(et),alt:"Documento Frontal ejemplo",class:"w-full h-full object-contain mt-2"},null,8,Tt)])]),a("div",Rt,[a("div",Lt,[r(D,{id:"cedula_front",type:"file",class:"mt-1 !border-0",accept:"image/jpeg,image/jpg,image/png,image/gif,image/svg+xml,image/webp",onInput:e[19]||(e[19]=o=>re("cedula_front",o)),maxFileSize:2e6}),r(m,{class:"mt-2",message:i(t).errors.cedula_front},null,8,["message"]),a("div",Nt,[U.value?(c(),u("img",{key:0,src:Ee(U.value,1),alt:i(t).cedula_front,class:"w-4/6 h-full object-contain"},null,8,Ot)):(c(),Ge(i(at),{key:1,class:"w-2/6 text-gray-300 flex justify-center items-center"}))]),U.value?(c(),u("div",Pt,[a("button",{onClick:e[20]||(e[20]=o=>De(1)),type:"button",class:"bg-red-500 text-white px-4 py-2 rounded"}," Eliminar Imagen ")])):q("",!0)])])]),a("div",At,[r(b,{for:"firma",value:"Firma"}),a("div",Yt,[a("button",{type:"button",class:B(["px-2 py-1 rounded",z.value==="imagen"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[21]||(e[21]=o=>z.value="imagen")}," Cargar imagen ",2),a("button",{type:"button",class:B(["px-2 py-1 rounded",z.value==="canvas"?"bg-blue-600 text-white":"bg-gray-200"]),onClick:e[22]||(e[22]=o=>z.value="canvas")}," Dibujar firma ",2)]),z.value==="imagen"?(c(),u("div",Gt,[r(D,{id:"firma",type:"file",class:"mt-1 block w-full",accept:"image/*",onChange:e[23]||(e[23]=o=>re("firma",o)),maxFileSize:2e6}),r(m,{class:"mt-2",message:i(t).errors.firma},null,8,["message"]),_.value?(c(),u("div",Wt,[a("img",{src:Se(_.value),alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,Xt)])):q("",!0)])):(c(),u("div",Ht,[a("canvas",{ref_key:"canvas",ref:j,height:"150",class:"border border-gray-400 rounded-md bg-white cursor-crosshair sm:w-[300px] w-[250px]",onMousedown:ne,onMousemove:de,onMouseup:te,onMouseleave:te,onTouchstart:ye(ne,["prevent"]),onTouchmove:ye(de,["prevent"]),onTouchend:te},null,544),a("div",{class:"flex gap-2 mt-1"},[a("button",{type:"button",onClick:Ue,class:"text-xl sm:text-2xl text-blue-600 underline"}," Limpiar canvas "),a("button",{type:"button",onClick:qe,class:"text-xl sm:text-2xl text-green-600 underline"}," Guardar firma ")]),r(m,{class:"mt-2",message:i(t).errors.firma},null,8,["message"]),_.value?(c(),u("div",Zt,[a("img",{src:_.value,alt:"Vista previa de la firma",class:"h-24 border rounded"},null,8,Jt)])):q("",!0)]))]),a("div",Kt,[r(D,{id:"campo_obligatorio",type:"text",class:"mt-1 !border-0 hidden",modelValue:i(t).campoObligatorio,"onUpdate:modelValue":e[24]||(e[24]=o=>i(t).campoObligatorio=o)},null,8,["modelValue"])]),a("div",Qt,[a("div",eo,[a("button",{type:"button",onClick:e[25]||(e[25]=o=>ue(1)),class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white px-4 rounded-md shadow-xl"}," Atrás ")]),a("div",to,[r(H,{type:"button",onClick:ze,class:B({"opacity-25":i(t).processing}),disabled:i(t).processing},{default:h(()=>e[42]||(e[42]=[S(" Siguiente ")])),_:1},8,["class","disabled"])])])])):q("",!0)])])]),_:1}),r(Z,{show:k.value,closeable:!1},{default:h(()=>[e[44]||(e[44]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Cargando datos... ",-1)),a("div",oo,[r(i(Qe),{"aria-label":"Loading"})])]),_:1},8,["show"]),r(Z,{show:I.value,closeable:!1},{default:h(()=>[e[47]||(e[47]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Desea volver a realizar el registro biométrico ",-1)),a("div",ao,[r(H,{type:"button",class:B(["h-full",{"opacity-25":i(t).processing}]),onClick:e[26]||(e[26]=o=>me()),disabled:i(t).processing},{default:h(()=>e[45]||(e[45]=[S(" Volver a realizar el registro biométrico ")])),_:1},8,["class","disabled"]),r(Ke,{onClick:fe,class:B({"opacity-25":i(t).processing}),disabled:i(t).processing},{default:h(()=>e[46]||(e[46]=[S(" Continuar y guardar los datos ")])),_:1},8,["class","disabled"])])]),_:1},8,["show"]),r(Z,{show:C.value,closeable:!0},{default:h(()=>[e[49]||(e[49]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex flex-wrap tex-center justify-center bg-azul text-white"}," Validación Biométrica ",-1)),e[50]||(e[50]=a("div",{class:"mt-4 px-4"},[a("p",{class:"text-sm sm:text-base text-gray-800"}," Por favor, asegúrese de que su rostro esté bien iluminado y visible en la cámara (sin gorras, tapabocas, gafas). Si no se detecta un rostro, puede intentar nuevamente o continuar sin registro biométrico. ")],-1)),a("div",so,[e[48]||(e[48]=a("label",{for:"camera"},"Seleccionar cámara:",-1)),V(a("select",{id:"camera","onUpdate:modelValue":e[27]||(e[27]=o=>R.value=o),class:"rounded-lg w-auto ms-4"},[(c(!0),u(N,null,W(P.value,o=>(c(),u("option",{key:o.deviceId,value:o.deviceId},F(o.label||"Cámara desconocida"),9,io))),128))],512),[[X,R.value]]),a("video",{ref_key:"video",ref:y,autoplay:"",muted:"",width:"400",height:"340",class:"rounded-xl shadow-lg flex mx-auto mt-6"},null,512),a("button",{type:"button",disabled:E.value,class:"bg-secondary hover:bg-primary text-sm sm:text-base text-white p-2 rounded-md shadow-xl flex mx-auto mt-4 disabled:bg-gray-500",onClick:e[28]||(e[28]=o=>Fe())}," Validar ",8,ro),S(" "+F(w.value),1)])]),_:1},8,["show"]),r(Z,{show:ee.value,closeable:!0},{default:h(()=>[e[52]||(e[52]=a("h2",{class:"py-4 sm:text-4xl text-2x font-bold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Aviso importante ",-1)),a("div",lo,[a("p",null," Por favor llenar todos los datos correctamente, para no ser rechazado, ¡recuerda! solo tiene "+F(3-se.votante.hash_votantes[0].intentos)+" oportunidades para registrarse ",1)]),a("div",no,[r(H,{type:"button",class:B(["h-full text-xl sm:text-2xl",{"opacity-25":i(t).processing}]),onClick:e[29]||(e[29]=o=>ee.value=!1),disabled:i(t).processing},{default:h(()=>e[51]||(e[51]=[S(" Continuar ")])),_:1},8,["class","disabled"])])]),_:1},8,["show"])],64))}};export{$o as default};
