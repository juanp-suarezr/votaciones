import{k as P,T as Q,Q as l,r as c,w as X,a as r,b as d,d as n,u as t,Z,e as w,f as a,l as j,g as b,F as h,h as E,t as k,v as U,U as H,n as I,A as q,j as R,p as J}from"./app-B2J9m9Wh.js";import{_ as W}from"./AuthenticatedLayout-Cs8z9g5Q.js";import{b as ee,s as D,t as oe,e as se,c as te}from"./etnia-vwOhpR49.js";import{_ as v}from"./InputError-qwH_tzLU.js";import{_ as p}from"./InputLabel-gNNsEWtv.js";import{_ as ae}from"./PrimaryButton-B3TjZFoJ.js";import{_ as ie}from"./Modal-DpjQYAnu.js";import{_ as x}from"./TextInput-WKxkZyVP.js";import{s as ne}from"./index-CtChTeka.js";import{s as le}from"./index-BSLviwVg.js";import"./index-4sUT_UJT.js";import"./index-mT_KvVaD.js";import"./index-Wly1IM7_.js";import"./SecondaryButtonReturn-BcNxyv_1.js";import"./index-BoCIbEiA.js";import"./index-0w00aVLV.js";import"./index-jXBlPla1.js";import"./index-GouyAJPp.js";const re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},de={class:"mt-4 justify-center"},ue={class:"m-auto py-4 px-4"},ce={key:0,class:"sm:grid sm:grid-cols-2 gap-6 h-full"},me={class:"mb-2"},pe=["value"],ve={class:"mb-2"},fe={class:"col-span-2 flex justify-end"},be=["disabled"],ge={key:1,class:"sm:grid sm:grid-cols-2 gap-6"},_e={class:"mb-2"},xe={class:"mb-2"},ye={key:0,class:"text-red-500"},we={class:"mb-2"},he={class:"mt-2 block sm:flex"},ke={class:""},Ve={class:"sm:ms-6"},Se={key:0,class:"sm:ms-6"},je={key:1,class:"sm:ms-6"},Ee={class:"mb-2"},Ue=["value"],qe={class:"mb-2"},Ce=["value"],Ne={class:"mb-2"},$e={class:"mb-2"},Me={class:"col-span-2 flex justify-between gap-2"},Ie={class:"flex pt-4 justify-end"},Re={class:"flex pt-4 justify-end h-full"},De={class:"flex justify-center my-12"},so={__name:"Registro",setup(Fe){const C=P("$swal"),F=[{url:"",text:"Registro votantes"}],e=Q({nombre:"",identificacion:"",tipo_documento:"",nacimiento:"",comuna:l().props.user.jurado.comuna,id_jurado:l().props.user.jurado.id,id_evento:l().props.user.jurado.evento.id,genero:"",etnia:"",condicion:"",direccion:"",barrio:""}),g=c(!1),L=c([{label:"Validación previa"},{label:"Información"}]),z=c([{label:"paso 1"},{label:"paso 2"}]),m=c(0),f=c(""),_=c(""),u=c(!1),y=c(!1);c(!1),c("");const V=c([]);V.value=ee.find(i=>i.id===parseInt(l().props.user.jurado.comuna)).barrios,console.log(V.value),X(y,i=>{i&&(e.genero="")});const B=i=>{m.value=i,u.value=!0},G=()=>{if(!e.nacimiento)return _.value="Debes ingresar la fecha de nacimiento.",!1;const i=new Date,o=e.nacimiento,[s,K,Y]=o.split("-").map(Number);let M=i.getFullYear()-s;const S=i.getMonth()-(K-1);return console.log(i.getMonth()),console.log(S),console.log(i.getDate()),(S<0||S===0&&i.getDate()<Y)&&M--,M<14?(_.value="No cumple con el requisito de edad mínima (14 años), por lo tanto, no puede ejercer el derecho al voto.",!1):(_.value="",!0)},O=async()=>{if(u.value=!1,g.value=!0,e.identificacion&&e.tipo_documento){f.value="",console.log(l().props);try{const i=await T(e.identificacion);if(console.log("Identificación data:",i),g.value=!1,i.existe){if(f.value="La identificación ya está registrada.",i.votante&&i.votante.votos.length>0)f.value+=" Y el votante ya ha emitido su voto en las elecciones.";else{window.location.href=route("votos.index",{id_votante:i.votante.id,evento:l().props.user.jurado.evento.id,tipo_evento:l().props.user.jurado.evento.tipos,tipo_user:i.votante.hash_votantes.length!=0?i.votante.hash_votantes[0].tipo:"",subtipo_user:i.votante.hash_votantes.length!=0?i.votante.hash_votantes[0].subtipo:""});return}u.value=!1}else f.value="",u.value=!0}catch{f.value="Error al validar la identificación. Intenta de nuevo.",u.value=!1}}u.value?m.value=1:(g.value=!1,(!e.identificacion||f.value!="")&&(e.errors.identificacion=f.value||"Este campo es requerido."),e.tipo_documento||(e.errors.tipo_documento="Este campo es requerido."))},T=async i=>{const o=await J.post("/validar-identificacion-presencial",{identificacion:i,registro_presencial:!0});return console.log(o.data),o.data},N=i=>{switch(u.value=!1,i){case 1:O();break;case 2:$();break}u.value&&(m.value=i)},$=()=>{if(u.value=!1,e.nombre&&e.nacimiento&&e.genero&&e.etnia&&e.condicion&&e.barrio&&e.direccion){if(u.value=!0,!G())return;A()}u.value||(e.nombre||(e.errors.nombre="Este campo es requerido."),e.nacimiento||(e.errors.nacimiento="Este campo es requerido."),e.genero||(e.errors.genero="Este campo es requerido."),e.etnia||(e.errors.etnia="Este campo es requerido."),e.condicion||(e.errors.condicion="Este campo es requerido."),e.barrio||(e.errors.barrio="Este campo es requerido."),e.direccion||(e.errors.direccion="Este campo es requerido."))},A=()=>{e.post(route("votantesPresencial.store"),{onSuccess:()=>{C({title:"Registro realizado",text:"Registro de votante realizado exitosamente.",icon:"success"}).then(i=>{console.log(i),window.location.href=route("votos.index",{id_votante:l().props.flash.success.id_votante,evento:l().props.user.jurado.evento.id,tipo_evento:l().props.user.jurado.evento.tipos,tipo_user:l().props.flash.success.hash_votante.tipo,subtipo_user:l().props.flash.success.hash_votante.subtipo})})},onError:i=>{C({title:"Error",text:"Ocurrió un error al registrar el votante.",icon:"error"}).then(o=>{m.value=0}),console.error(i)}})};return(i,o)=>(d(),r(h,null,[n(t(Z),{title:"Registro votantes"}),n(W,{breadCrumbLinks:F},{header:w(()=>o[17]||(o[17]=[R(" Registro de votante ")])),default:w(()=>[a("div",re,[o[25]||(o[25]=a("div",{class:"p-6 border-b border-gray-200"},[a("h1",null,"Registro votante")],-1)),a("div",de,[n(t(D),{class:"hidden sm:block",model:L.value,activeStep:m.value,"onUpdate:activeStep":o[0]||(o[0]=s=>m.value=s)},null,8,["model","activeStep"]),n(t(D),{class:"sm:hidden block",model:z.value,activeStep:m.value,"onUpdate:activeStep":o[1]||(o[1]=s=>m.value=s)},null,8,["model","activeStep"])]),a("form",ue,[m.value==0?(d(),r("div",ce,[a("div",me,[n(p,{for:"tipo_documento",value:"Tipo de Documento"}),b(a("select",{id:"tipo_documento","onUpdate:modelValue":o[2]||(o[2]=s=>t(e).tipo_documento=s),class:"mt-1 block w-full border-gray-300 rounded-lg"},[o[18]||(o[18]=a("option",{value:"",disabled:""},"Seleccione tipo de documento",-1)),(d(!0),r(h,null,E(t(oe),s=>(d(),r("option",{key:s.id,value:s.nombre},k(s.nombre),9,pe))),128))],512),[[U,t(e).tipo_documento]]),n(v,{class:"mt-2",message:t(e).errors.tipo_documento},null,8,["message"])]),a("div",ve,[n(p,{for:"identificacion",value:"Identificación"}),n(x,{id:"identificacion",type:"text",class:"mt-1 block w-full",modelValue:t(e).identificacion,"onUpdate:modelValue":o[3]||(o[3]=s=>t(e).identificacion=s),onKeydown:o[4]||(o[4]=H(s=>N(1),["enter"])),required:""},null,8,["modelValue"]),n(v,{class:"mt-2",message:t(e).errors.identificacion},null,8,["message"])]),a("div",fe,[a("button",{type:"button",class:I(["bg-secondary hover:bg-primary text-xs sm:text-sm text-white p-2 rounded-md shadow-xl",{"opacity-25":g.value}]),onClick:o[5]||(o[5]=s=>N(1)),disabled:g.value}," Siguiente ",10,be)])])):j("",!0),m.value==1?(d(),r("div",ge,[a("div",_e,[n(p,{for:"nombre",value:"Nombre Completo"}),n(x,{id:"nombre",type:"text",class:"mt-1 block w-full",modelValue:t(e).nombre,"onUpdate:modelValue":o[6]||(o[6]=s=>t(e).nombre=s),required:""},null,8,["modelValue"]),n(v,{class:"mt-2",message:t(e).errors.nombre},null,8,["message"])]),a("div",xe,[n(p,{for:"nacimiento",value:"Fecha de Nacimiento"}),n(x,{id:"nacimiento",type:"date",class:"mt-1 block w-full",modelValue:t(e).nacimiento,"onUpdate:modelValue":o[7]||(o[7]=s=>t(e).nacimiento=s),required:""},null,8,["modelValue"]),n(v,{class:"mt-2",message:t(e).errors.nacimiento},null,8,["message"]),_.value?(d(),r("p",ye,k(_.value),1)):j("",!0)]),a("div",we,[n(p,{for:"genero",value:"Identidad de Género"}),a("div",he,[a("div",ke,[b(a("input",{type:"radio",id:"masculino",value:"Masculino","onUpdate:modelValue":o[8]||(o[8]=s=>t(e).genero=s)},null,512),[[q,t(e).genero]]),o[19]||(o[19]=a("label",{class:"ps-2 text-sm sm:text-base",for:"masculino"},"Masculino",-1))]),a("div",Ve,[b(a("input",{type:"radio",id:"two",value:"Femenino","onUpdate:modelValue":o[9]||(o[9]=s=>t(e).genero=s)},null,512),[[q,t(e).genero]]),o[20]||(o[20]=a("label",{class:"ps-2 text-sm sm:text-base",for:"two"},"Femenino",-1))]),y.value?(d(),r("div",Se,[n(p,{class:"sm:text-sm text-xs",for:"genero",value:"¿Cual?"}),n(x,{id:"genero",type:"text",class:"mt-1 block w-full p-0 sm:p-1",modelValue:t(e).genero,"onUpdate:modelValue":o[10]||(o[10]=s=>t(e).genero=s),autocomplete:"genero"},null,8,["modelValue"]),n(v,{class:"mt-1",message:t(e).errors.genero},null,8,["message"])])):(d(),r("div",je,[b(a("input",{type:"radio",id:"tres",value:"true","onUpdate:modelValue":o[11]||(o[11]=s=>y.value=s)},null,512),[[q,y.value]]),o[21]||(o[21]=a("label",{class:"ps-2 text-sm sm:text-base",for:"tres"},"Otro",-1))]))])]),a("div",Ee,[n(p,{for:"etnia",value:"Grupo poblacional"}),b(a("select",{id:"etnia","onUpdate:modelValue":o[12]||(o[12]=s=>t(e).etnia=s),class:"mt-1 block w-full border-gray-300 rounded-lg"},[o[22]||(o[22]=a("option",{value:"",disabled:""}," Seleccione grupo poblacional perteneciente ",-1)),(d(!0),r(h,null,E(t(se),s=>(d(),r("option",{key:s.id,value:s.nombre},k(s.nombre),9,Ue))),128))],512),[[U,t(e).etnia]]),n(v,{class:"mt-2",message:t(e).errors.etnia},null,8,["message"])]),a("div",qe,[n(p,{for:"condicion",value:"Condición poblacional"}),b(a("select",{id:"condicion","onUpdate:modelValue":o[13]||(o[13]=s=>t(e).condicion=s),class:"mt-1 block w-full border-gray-300 rounded-lg"},[o[23]||(o[23]=a("option",{value:"",disabled:""}," Seleccione condición poblacional ",-1)),(d(!0),r(h,null,E(t(te),s=>(d(),r("option",{key:s.id,value:s.nombre},k(s.nombre),9,Ce))),128))],512),[[U,t(e).condicion]]),n(v,{class:"mt-2",message:t(e).errors.condicion},null,8,["message"])]),a("div",Ne,[n(p,{for:"barrio",value:"Barrio/Vereda"}),n(t(ne),{id:"barrio",modelValue:t(e).barrio,"onUpdate:modelValue":o[14]||(o[14]=s=>t(e).barrio=s),options:V.value,filter:"",placeholder:"Seleccione barrio/vereda de dirección",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"]),n(v,{class:"mt-2",message:t(e).errors.barrio},null,8,["message"])]),a("div",$e,[n(p,{for:"direccion",value:"Dirección"}),n(x,{id:"direccion",type:"text",class:"mt-1 block w-full",modelValue:t(e).direccion,"onUpdate:modelValue":o[15]||(o[15]=s=>t(e).direccion=s),required:""},null,8,["modelValue"]),n(v,{class:"mt-2",message:t(e).errors.direccion},null,8,["message"])]),a("div",Me,[a("div",Ie,[a("button",{type:"button",onClick:o[16]||(o[16]=s=>B(0)),class:"bg-secondary hover:bg-primary text-xs sm:text-sm text-white px-4 rounded-md shadow-xl"}," Atrás ")]),a("div",Re,[n(ae,{type:"button",class:I(["h-full",{"opacity-25":t(e).processing}]),onClick:$,disabled:t(e).processing},{default:w(()=>o[24]||(o[24]=[R(" Siguiente ")])),_:1},8,["class","disabled"])])])])):j("",!0)])])]),_:1}),n(ie,{show:i.loadingModal,closeable:!1},{default:w(()=>[o[26]||(o[26]=a("h2",{class:"py-4 text-2xl font-semibold text-gray-800 flex tex-center justify-center bg-azul text-white"}," Cargando datos... ",-1)),a("div",De,[n(t(le),{"aria-label":"Loading"})])]),_:1},8,["show"])],64))}};export{so as default};
